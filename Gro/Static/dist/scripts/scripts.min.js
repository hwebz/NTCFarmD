function setDropdown(e,t){e.find(".showcase > a").unbind("click").click(function(){var e=$(this).next();return $(".dropdown").not(e).hide(),"none"==e.css("display")?e.show():e.hide(),!1}),e.find(".showcase .dropdown li a").click(function(){var e=$(this).parent().attr("data-value"),a=$(this).text();return $(".dropdown li").removeClass("selected"),$(this).parent().addClass("selected"),$(this).parents(".showcase").find(">a").html("type-2"===t?e:a),$(this).parents(".showcase").find(">a").html(a),$(this).parents(".showcase").attr("data-value",e),$(this).parents(".showcase").find(">input[type=hidden]").val(e),$(this).parents(".dropdown").hide(),"Annan"===$(this).parent().data("value")&&($(this).parents(".model-block").find('input[type="text"]').show(),$(this).parents("ul.lm__form-dropdown.model-dropdown").hide()),!1})}function isValidate(e){var t="True"!==$(e).val();return t||$(e).val("False"),t}function submitForm(e,t){var a=e,n=t;$("input[name= 'SearchText']").val(a),$("#search-transport-type > ul > li").each(function(){$(this).attr("data-value")===n&&$("input[name= 'Category']").val(n)}),$("#form-search-transport").submit()}function getAnnoncements(e){var t=$(e).parents(".lm__collapse-row").prev().find("td > a").html(),a=$(".tblAnnoncements tbody"),n=$(".lm__information-modal__wrapper");$.ajax({type:"POST",url:"/api/search-transport/get-annoncements",contentType:"application/json; charset=utf-8",data:"{'orderRowId':'"+t+"'}",success:function(e){a.html(""),a.html(e),n.removeClass("hidden")},error:function(){a.html(""),n.removeClass("hidden")}})}!function(e){"use strict";e.fn.filer=function(t){return this.each(function(a,n){var r=e(n),i=".jFiler",o=e(),l=e(),s=e(),d=[],c=e.isFunction(t)?t(r,e.fn.filer.defaults):t,u=c&&e.isPlainObject(c)?e.extend(!0,{},e.fn.filer.defaults,c):e.fn.filer.defaults,p={init:function(){r.wrap('<div class="jFiler"></div>'),p._set("props"),r.prop("jFiler").boxEl=o=r.closest(i),p._changeInput()},_bindInput:function(){u.changeInput&&l.length>0&&l.on("click",p._clickHandler),r.on({focus:function(){l.addClass("focused")},blur:function(){l.removeClass("focused")},change:p._onChange}),u.dragDrop&&(u.dragDrop.dragContainer.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}),u.dragDrop.dragContainer.on("drop",p._dragDrop.drop),u.dragDrop.dragContainer.on("dragover",p._dragDrop.dragEnter),u.dragDrop.dragContainer.on("dragleave",p._dragDrop.dragLeave)),u.uploadFile&&u.clipBoardPaste&&e(window).on("paste",p._clipboardPaste)},_unbindInput:function(t){u.changeInput&&l.length>0&&l.off("click",p._clickHandler),t&&(r.off("change",p._onChange),u.dragDrop&&(u.dragDrop.dragContainer.off("drop",p._dragDrop.drop),u.dragDrop.dragContainer.off("dragover",p._dragDrop.dragEnter),u.dragDrop.dragContainer.off("dragleave",p._dragDrop.dragLeave)),u.uploadFile&&u.clipBoardPaste&&e(window).off("paste",p._clipboardPaste))},_clickHandler:function(){if(!u.uploadFile&&u.addMore&&0!=r.val().length){p._unbindInput(!0);var t=e('<input type="file" />'),a=r.prop("attributes");e.each(a,function(){"required"!=this.name&&t.attr(this.name,this.value)}),r.after(t),d.push(t),r=t,p._bindInput(),p._set("props")}r.click()},_applyAttrSettings:function(){var e=["name","limit","maxSize","fileMaxSize","extensions","changeInput","showThumbs","appendTo","theme","addMore","excludeName","files","uploadUrl","uploadData","options"];for(var t in e){var a="data-jfiler-"+e[t];if(p._assets.hasAttr(a)){switch(e[t]){case"changeInput":case"showThumbs":case"addMore":u[e[t]]=["true","false"].indexOf(r.attr(a))>-1?"true"==r.attr(a):r.attr(a);break;case"extensions":u[e[t]]=r.attr(a).replace(/ /g,"").split(",");break;case"uploadUrl":u.uploadFile&&(u.uploadFile.url=r.attr(a));break;case"uploadData":u.uploadFile&&(u.uploadFile.data=JSON.parse(r.attr(a)));break;case"files":case"options":u[e[t]]=JSON.parse(r.attr(a));break;default:u[e[t]]=r.attr(a)}r.removeAttr(a)}}},_changeInput:function(){if(p._applyAttrSettings(),null!=u.beforeRender&&"function"==typeof u.beforeRender?u.beforeRender(o,r):null,u.theme&&o.addClass("jFiler-theme-"+u.theme),"input"!=r.get(0).tagName.toLowerCase()&&"file"!=r.get(0).type)l=r,r=e('<input type="file" name="'+u.name+'" />'),r.css({position:"absolute",left:"-9999px",top:"-9999px","z-index":"-9999"}),o.prepend(r),p._isGn=r;else if(u.changeInput){switch(typeof u.changeInput){case"boolean":l=e('<div class="jFiler-input"><div class="jFiler-input-caption"><span>'+u.captions.feedback+'</span></div><div class="jFiler-input-button">'+u.captions.button+'</div></div>"');break;case"string":case"object":l=e(u.changeInput);break;case"function":l=e(u.changeInput(o,r,u))}r.after(l),r.css({position:"absolute",left:"-9999px",top:"-9999px","z-index":"-9999"})}r.prop("jFiler").newInputEl=l,u.dragDrop&&(u.dragDrop.dragContainer=u.dragDrop.dragContainer?e(u.dragDrop.dragContainer):l),(!u.limit||u.limit&&u.limit>=2)&&(r.attr("multiple","multiple"),"[]"!=r.attr("name").slice(-2)?r.attr("name",r.attr("name")+"[]"):null),r.attr("disabled")||u.disabled?(u.disabled=!0,p._unbindInput(!0),o.addClass("jFiler-disabled")):(u.disabled=!1,p._bindInput(),o.removeClass("jFiler-disabled")),u.files&&p._append(!1,{files:u.files}),null!=u.afterRender&&"function"==typeof u.afterRender?u.afterRender(s,o,l,r):null},_clear:function(){p.files=null,r.prop("jFiler").files=null,u.uploadFile||u.addMore||p._reset(),p._set("feedback",p._itFl&&p._itFl.length>0?p._itFl.length+" "+u.captions.feedback2:u.captions.feedback),null!=u.onEmpty&&"function"==typeof u.onEmpty?u.onEmpty(o,l,r):null},_reset:function(t){if(!t){if(!u.uploadFile&&u.addMore){for(var a=0;a<d.length;a++)d[a].remove();d=[],p._unbindInput(!0),r=p._isGn?p._isGn:e(n),p._bindInput()}p._set("input","")}p._itFl=[],p._itFc=null,p._ajFc=0,p._set("props"),r.prop("jFiler").files_list=p._itFl,r.prop("jFiler").current_file=p._itFc,p._itFr=[],o.find("input[name^='jfiler-items-exclude-']:hidden").remove(),s.fadeOut("fast",function(){e(this).remove()}),r.prop("jFiler").listEl=s=e()},_set:function(e,t){switch(e){case"input":r.val(t);break;case"feedback":l.length>0&&l.find(".jFiler-input-caption span").html(t);break;case"props":r.prop("jFiler")||r.prop("jFiler",{options:u,listEl:s,boxEl:o,newInputEl:l,inputEl:r,files:p.files,files_list:p._itFl,current_file:p._itFc,append:function(e){return p._append(!1,{files:[e]})},enable:function(){u.disabled&&(u.disabled=!1,r.removeAttr("disabled"),o.removeClass("jFiler-disabled"),p._bindInput())},disable:function(){u.disabled||(u.disabled=!0,o.addClass("jFiler-disabled"),p._unbindInput(!0))},remove:function(e){return p._remove(null,{binded:!0,data:{id:e}}),!0},reset:function(){return p._reset(),p._clear(),!0},retry:function(e){return p._retryUpload(e)}})}},_filesCheck:function(){var t=0;if(u.limit&&p.files.length+p._itFl.length>u.limit)return u.dialogs.alert(p._assets.textParse(u.captions.errors.filesLimit)),!1;for(var a=0;a<p.files.length;a++){var n=p.files[a],r=n.name.split(".").pop().toLowerCase(),i={name:n.name,size:n.size,size2:p._assets.bytesToSize(n.size),type:n.type,ext:r};if(null!=u.extensions&&e.inArray(r,u.extensions)==-1&&e.inArray(i.type,u.extensions)==-1)return u.dialogs.alert(p._assets.textParse(u.captions.errors.filesType,i)),!1;if(null!=u.maxSize&&p.files[a].size>1048576*u.maxSize||null!=u.fileMaxSize&&p.files[a].size>1048576*u.fileMaxSize)return u.dialogs.alert(p._assets.textParse(u.captions.errors.filesSize,i)),!1;if(4096==n.size&&0==n.type.length)return u.dialogs.alert(p._assets.textParse(u.captions.errors.folderUpload,i)),!1;if(null!=u.onFileCheck&&"function"==typeof u.onFileCheck?u.onFileCheck(i,u,p._assets.textParse)===!1:null)return!1;if((u.uploadFile||u.addMore)&&!u.allowDuplicates){var i=p._itFl.filter(function(e,t){if(e.file.name==n.name&&e.file.size==n.size&&e.file.type==n.type&&(!n.lastModified||e.file.lastModified==n.lastModified))return!0});if(i.length>0){if(1==p.files.length)return!1;n._pendRemove=!0}}t+=p.files[a].size}return!(null!=u.maxSize&&t>=Math.round(1048576*u.maxSize)&&(u.dialogs.alert(p._assets.textParse(u.captions.errors.filesSizeAll)),1))},_thumbCreator:{create:function(t){var a=p.files[t],n=p._itFc?p._itFc.id:t,r=a.name,i=a.size,o=a.file,l=a.type?a.type.split("/",1):"".toString().toLowerCase(),d=r.indexOf(".")!=-1?r.split(".").pop().toLowerCase():"",c=u.uploadFile?'<div class="jFiler-jProgressBar">'+u.templates.progressBar+"</div>":"",m={id:n,name:r,size:i,size2:p._assets.bytesToSize(i),url:o,type:l,extension:d,icon:p._assets.getIcon(d,l),icon2:p._thumbCreator.generateIcon({type:l,extension:d}),image:'<div class="jFiler-item-thumb-image fi-loading"></div>',progressBar:c,_appended:a._appended},h="";return a.opts&&(m=e.extend({},a.opts,m)),h=e(p._thumbCreator.renderContent(m)).attr("data-jfiler-index",n),h.get(0).jfiler_id=n,p._thumbCreator.renderFile(a,h,m),a.forList?h:(p._itFc.html=h,h.hide()[u.templates.itemAppendToEnd?"appendTo":"prependTo"](s.find(u.templates._selectors.list)).show(),void(a._appended||p._onSelect(t)))},renderContent:function(e){return p._assets.textParse(e._appended?u.templates.itemAppend:u.templates.item,e)},renderFile:function(t,a,n){if(0==a.find(".jFiler-item-thumb-image").length)return!1;if(t.file&&"image"==n.type){var r='<img src="'+t.file+'" draggable="false" />',i=a.find(".jFiler-item-thumb-image.fi-loading");return e(r).error(function(){r=p._thumbCreator.generateIcon(n),a.addClass("jFiler-no-thumbnail"),i.removeClass("fi-loading").html(r)}).load(function(){i.removeClass("fi-loading").html(r)}),!0}if(window.File&&window.FileList&&window.FileReader&&"image"==n.type&&n.size<1e7){var o=new FileReader;o.onload=function(e){var t=a.find(".jFiler-item-thumb-image.fi-loading");if(u.templates.canvasImage){var r=document.createElement("canvas"),i=r.getContext("2d"),o=new Image;o.onload=function(){var e=t.height(),a=t.width(),n=o.height/e,l=o.width/a,s=n<l?n:l,d=o.height/s,c=o.width/s,u=Math.ceil(Math.log(o.width/c)/Math.log(2));if(r.height=e,r.width=a,o.width<r.width||o.height<r.height||u<=1){var p=o.width<r.width?r.width/2-o.width/2:o.width>r.width?-(o.width-r.width)/2:0,m=o.height<r.height?r.height/2-o.height/2:0;i.drawImage(o,p,m,o.width,o.height)}else{var h=document.createElement("canvas"),f=h.getContext("2d");h.width=.5*o.width,h.height=.5*o.height,f.fillStyle="#fff",f.fillRect(0,0,h.width,h.height),f.drawImage(o,0,0,h.width,h.height),f.drawImage(h,0,0,.5*h.width,.5*h.height),i.drawImage(h,c>r.width?c-r.width:0,0,.5*h.width,.5*h.height,0,0,c,d)}t.removeClass("fi-loading").html('<img src="'+r.toDataURL("image/png")+'" draggable="false" />')},o.onerror=function(){a.addClass("jFiler-no-thumbnail"),t.removeClass("fi-loading").html(p._thumbCreator.generateIcon(n))},o.src=e.target.result}else t.removeClass("fi-loading").html('<img src="'+e.target.result+'" draggable="false" />')},o.readAsDataURL(t)}else{var r=p._thumbCreator.generateIcon(n),i=a.find(".jFiler-item-thumb-image.fi-loading");a.addClass("jFiler-no-thumbnail"),i.removeClass("fi-loading").html(r)}},generateIcon:function(t){var a=new Array(3);if(t&&t.type&&t.type[0]&&t.extension)switch(t.type[0]){case"image":a[0]="f-image",a[1]='<i class="icon-jfi-file-image"></i>';break;case"video":a[0]="f-video",a[1]='<i class="icon-jfi-file-video"></i>';break;case"audio":a[0]="f-audio",a[1]='<i class="icon-jfi-file-audio"></i>';break;default:a[0]="f-file f-file-ext-"+t.extension,a[1]=t.extension.length>0?"."+t.extension:"",a[2]=1}else a[0]="f-file",a[1]=t.extension&&t.extension.length>0?"."+t.extension:"",a[2]=1;var n='<span class="jFiler-icon-file '+a[0]+'">'+a[1]+"</span>";if(1==a[2]){var r=p._assets.text2Color(t.extension);if(r){var i=e(n).appendTo("body");i.css("background-color",p._assets.text2Color(t.extension)),n=i.prop("outerHTML"),i.remove()}}return n},_box:function(t){if(null!=u.beforeShow&&"function"==typeof u.beforeShow&&!u.beforeShow(p.files,s,o,l,r))return!1;if(s.length<1){if(u.appendTo)var a=e(u.appendTo);else var a=o;a.find(".jFiler-items").remove(),s=e('<div class="jFiler-items jFiler-row"></div>'),r.prop("jFiler").listEl=s,s.append(p._assets.textParse(u.templates.box)).appendTo(a),s.on("click",u.templates._selectors.remove,function(a){a.preventDefault();var n=[t?t.remove.event:a,t?t.remove.el:e(this).closest(u.templates._selectors.item)],r=function(e){p._remove(n[0],n[1])};u.templates.removeConfirmation?u.dialogs.confirm(u.captions.removeConfirmation,r):r()})}for(var n=0;n<p.files.length;n++)p.files[n]._appended||(p.files[n]._choosed=!0),p._addToMemory(n),p._thumbCreator.create(n)}},_upload:function(t){var a=p._itFl[t],n=a.html,i=new FormData;if(i.append(r.attr("name"),a.file,!!a.file.name&&a.file.name),null!=u.uploadFile.data&&e.isPlainObject("function"==typeof u.uploadFile.data?u.uploadFile.data(a.file):u.uploadFile.data))for(var o in u.uploadFile.data)i.append(o,u.uploadFile.data[o]);p._ajax.send(n,i,a)},_ajax:{send:function(t,a,n){return n.ajax=e.ajax({url:u.uploadFile.url,data:a,type:u.uploadFile.type,enctype:u.uploadFile.enctype,xhr:function(){var a=e.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",function(e){p._ajax.progressHandling(e,t)},!1),a},complete:function(e,t){n.ajax=!1,p._ajFc++,u.uploadFile.synchron&&n.id+1<p._itFl.length&&p._upload(n.id+1),p._ajFc>=p.files.length&&(p._ajFc=0,r.get(0).value="",null!=u.uploadFile.onComplete&&"function"==typeof u.uploadFile.onComplete?u.uploadFile.onComplete(s,o,l,r,e,t):null)},beforeSend:function(e,a){return null==u.uploadFile.beforeSend||"function"!=typeof u.uploadFile.beforeSend||u.uploadFile.beforeSend(t,s,o,l,r,n.id,e,a)},success:function(e,a,i){n.uploaded=!0,null!=u.uploadFile.success&&"function"==typeof u.uploadFile.success?u.uploadFile.success(e,t,s,o,l,r,n.id,a,i):null},error:function(e,a,i){n.uploaded=!1,null!=u.uploadFile.error&&"function"==typeof u.uploadFile.error?u.uploadFile.error(t,s,o,l,r,n.id,e,a,i):null},statusCode:u.uploadFile.statusCode,cache:!1,contentType:!1,processData:!1}),n.ajax},progressHandling:function(e,t){if(e.lengthComputable){var a=Math.round(100*e.loaded/e.total).toString();null!=u.uploadFile.onProgress&&"function"==typeof u.uploadFile.onProgress?u.uploadFile.onProgress(a,t,s,o,l,r):null,t.find(".jFiler-jProgressBar").find(u.templates._selectors.progressBar).css("width",a+"%")}}},_dragDrop:{dragEnter:function(e){clearTimeout(p._dragDrop._drt),u.dragDrop.dragContainer.addClass("dragged"),p._set("feedback",u.captions.drop),null!=u.dragDrop.dragEnter&&"function"==typeof u.dragDrop.dragEnter?u.dragDrop.dragEnter(e,l,r,o):null},dragLeave:function(e){clearTimeout(p._dragDrop._drt),p._dragDrop._drt=setTimeout(function(e){return p._dragDrop._dragLeaveCheck(e)?(u.dragDrop.dragContainer.removeClass("dragged"),p._set("feedback",u.captions.feedback),void(null!=u.dragDrop.dragLeave&&"function"==typeof u.dragDrop.dragLeave?u.dragDrop.dragLeave(e,l,r,o):null)):(p._dragDrop.dragLeave(e),!1)},100,e)},drop:function(e){clearTimeout(p._dragDrop._drt),u.dragDrop.dragContainer.removeClass("dragged"),p._set("feedback",u.captions.feedback),e&&e.originalEvent&&e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files&&e.originalEvent.dataTransfer.files.length>0&&p._onChange(e,e.originalEvent.dataTransfer.files),null!=u.dragDrop.drop&&"function"==typeof u.dragDrop.drop?u.dragDrop.drop(e.originalEvent.dataTransfer.files,e,l,r,o):null},_dragLeaveCheck:function(t){var a=e(t.currentTarget),n=0;return!(!a.is(l)&&(n=l.find(a).length,n>0))}},_clipboardPaste:function(e,t){if((t||e.originalEvent.clipboardData||e.originalEvent.clipboardData.items)&&(!t||e.originalEvent.dataTransfer||e.originalEvent.dataTransfer.items)&&!p._clPsePre){var a=t?e.originalEvent.dataTransfer.items:e.originalEvent.clipboardData.items,n=function(e,t,a){t=t||"",a=a||512;for(var n=atob(e),r=[],i=0;i<n.length;i+=a){for(var o=n.slice(i,i+a),l=new Array(o.length),s=0;s<o.length;s++)l[s]=o.charCodeAt(s);var d=new Uint8Array(l);r.push(d)}var c=new Blob(r,{type:t});return c};if(a)for(var r=0;r<a.length;r++)if(a[r].type.indexOf("image")!==-1||a[r].type.indexOf("text/uri-list")!==-1){if(t)try{window.atob(e.originalEvent.dataTransfer.getData("text/uri-list").toString().split(",")[1])}catch(e){return}var i=t?n(e.originalEvent.dataTransfer.getData("text/uri-list").toString().split(",")[1],"image/png"):a[r].getAsFile();i.name=Math.random().toString(36).substring(5),i.name+=i.type.indexOf("/")!=-1?"."+i.type.split("/")[1].toString().toLowerCase():".png",p._onChange(e,[i]),p._clPsePre=setTimeout(function(){delete p._clPsePre},1e3)}}},_onSelect:function(t){u.uploadFile&&!e.isEmptyObject(u.uploadFile)&&(!u.uploadFile.synchron||u.uploadFile.synchron&&0==e.grep(p._itFl,function(e){return e.ajax}).length)&&p._upload(p._itFc.id),p.files[t]._pendRemove&&(p._itFc.html.hide(),p._remove(null,{binded:!0,data:{id:p._itFc.id}})),null!=u.onSelect&&"function"==typeof u.onSelect?u.onSelect(p.files[t],p._itFc.html,s,o,l,r):null,t+1>=p.files.length&&(null!=u.afterShow&&"function"==typeof u.afterShow?u.afterShow(s,o,l,r):null)},_onChange:function(t,a){if(a){if(!a||0==a.length)return p._set("input",""),p._clear(),!1;p.files=a}else{if(!r.get(0).files||"undefined"==typeof r.get(0).files||0==r.get(0).files.length)return u.uploadFile||u.addMore||(p._set("input",""),p._clear()),!1;p.files=r.get(0).files}if(u.uploadFile||u.addMore||p._reset(!0),r.prop("jFiler").files=p.files,!p._filesCheck()||null!=u.beforeSelect&&"function"==typeof u.beforeSelect&&!u.beforeSelect(p.files,s,o,l,r))return p._set("input",""),p._clear(),u.addMore&&d.length>0&&(p._unbindInput(!0),d[d.length-1].remove(),d.splice(d.length-1,1),r=d.length>0?d[d.length-1]:e(n),p._bindInput()),!1;if(p._set("feedback",p.files.length+p._itFl.length+" "+u.captions.feedback2),u.showThumbs)p._thumbCreator._box();else for(var i=0;i<p.files.length;i++)p.files[i]._choosed=!0,p._addToMemory(i),p._onSelect(i)},_append:function(e,t){var a=!!t&&t.files;if(a&&!(a.length<=0)&&(p.files=a,r.prop("jFiler").files=p.files,u.showThumbs)){for(var n=0;n<p.files.length;n++)p.files[n]._appended=!0;p._thumbCreator._box()}},_getList:function(e,t){var a=!!t&&t.files;if(a&&!(a.length<=0)&&(p.files=a,r.prop("jFiler").files=p.files,u.showThumbs)){for(var n=[],i=0;i<p.files.length;i++)p.files[i].forList=!0,n.push(p._thumbCreator.create(i));t.callback&&t.callback(n,s,o,l,r)}},_retryUpload:function(t,a){var n=parseInt("object"==typeof a?a.attr("data-jfiler-index"):a),i=p._itFl.filter(function(e,t){return e.id==n});return i.length>0&&(!u.uploadFile||e.isEmptyObject(u.uploadFile)||i[0].uploaded?void 0:(p._itFc=i[0],r.prop("jFiler").current_file=p._itFc,p._upload(n),!0))},_remove:function(t,n){if(n.binded){if("undefined"!=typeof n.data.id&&(n=s.find(u.templates._selectors.item+"[data-jfiler-index='"+n.data.id+"']"),0==n.length))return!1;n.data.el&&(n=n.data.el)}var i=function(t){var n=o.find("input[name^='jfiler-items-exclude-']:hidden").first();0==n.length&&(n=e('<input type="hidden" name="jfiler-items-exclude-'+(u.excludeName?u.excludeName:("[]"!=r.attr("name").slice(-2)?r.attr("name"):r.attr("name").substring(0,r.attr("name").length-2))+"-"+a)+'">'),n.appendTo(o)),t&&e.isArray(t)&&(t=JSON.stringify(t),n.val(t))},d=function(t,a){var n=p._itFl[a],r=[];if(n.file._choosed||n.file._appended||n.uploaded){p._itFr.push(n);for(var o=p._itFl.filter(function(e){return e.file.name==n.file.name}),l=0;l<p._itFr.length;l++)u.addMore&&p._itFr[l]==n&&o.length>0&&(p._itFr[l].remove_name=o.indexOf(n)+"://"+p._itFr[l].file.name),r.push(p._itFr[l].remove_name?p._itFr[l].remove_name:p._itFr[l].file.name)}i(r),p._itFl.splice(a,1),p._itFl.length<1?(p._reset(),p._clear()):p._set("feedback",p._itFl.length+" "+u.captions.feedback2),t.fadeOut("fast",function(){e(this).remove()})},c=n.get(0).jfiler_id||n.attr("data-jfiler-index"),m=null;for(var h in p._itFl)"length"!==h&&p._itFl.hasOwnProperty(h)&&p._itFl[h].id==c&&(m=h);return!!p._itFl.hasOwnProperty(m)&&(p._itFl[m].ajax?(p._itFl[m].ajax.abort(),void d(n,m)):void(null!=u.onRemove&&"function"==typeof u.onRemove&&u.onRemove(n,p._itFl[m].file,m,s,o,l,r)===!1||d(n,m)))},_addToMemory:function(t){p._itFl.push({id:p._itFl.length,file:p.files[t],html:e(),ajax:!1,uploaded:!1}),(u.addMore||p.files[t]._appended)&&(p._itFl[p._itFl.length-1].input=r),p._itFc=p._itFl[p._itFl.length-1],r.prop("jFiler").files_list=p._itFl,r.prop("jFiler").current_file=p._itFc},_assets:{bytesToSize:function(e){if(0==e)return"0 Byte";var t=1e3,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(e)/Math.log(t));return(e/Math.pow(t,n)).toPrecision(3)+" "+a[n]},hasAttr:function(e,t){var t=t?t:r,a=t.attr(e);return!(!a||"undefined"==typeof a)},getIcon:function(t,a){var n=["audio","image","text","video"];return e.inArray(a,n)>-1?'<i class="icon-jfi-file-'+a+" jfi-file-ext-"+t+'"></i>':'<i class="icon-jfi-file-o jfi-file-type-'+a+" jfi-file-ext-"+t+'"></i>'},textParse:function(t,a){switch(a=e.extend({},{limit:u.limit,maxSize:u.maxSize,fileMaxSize:u.fileMaxSize,extensions:u.extensions?u.extensions.join(","):null},a&&e.isPlainObject(a)?a:{},u.options),typeof t){case"string":return t.replace(/\{\{fi-(.*?)\}\}/g,function(e,t){return t=t.replace(/ /g,""),t.match(/(.*?)\|limitTo\:(\d+)/)?t.replace(/(.*?)\|limitTo\:(\d+)/,function(e,t,n){var t=a[t]?a[t]:"",r=t.substring(0,n);return r=t.length>r.length?r.substring(0,r.length-3)+"...":r}):a[t]?a[t]:""});case"function":return t(a);default:return t}},text2Color:function(e){if(!e||0==e.length)return!1;for(var t=0,a=0;t<e.length;a=e.charCodeAt(t++)+((a<<5)-a));for(var t=0,n="#";t<3;n+=("00"+(a>>2*t++&255).toString(16)).slice(-2));return n}},files:null,_itFl:[],_itFc:null,_itFr:[],_itPl:[],_ajFc:0};return r.on("filer.append",function(e,t){p._append(e,t)}).on("filer.remove",function(e,t){t.binded=!0,p._remove(e,t)}).on("filer.reset",function(e){return p._reset(),p._clear(),!0}).on("filer.generateList",function(e,t){return p._getList(e,t)}).on("filer.retry",function(e,t){return p._retryUpload(e,t)}),p.init(),this})},e.fn.filer.defaults={limit:null,maxSize:null,fileMaxSize:null,extensions:null,changeInput:!0,showThumbs:!1,appendTo:null,theme:"default",templates:{box:'<ul class="jFiler-items-list jFiler-items-default"></ul>',item:'<li class="jFiler-item"><div class="jFiler-item-container"><div class="jFiler-item-inner"><div class="jFiler-item-icon pull-left">{{fi-icon}}</div><div class="jFiler-item-info pull-left"><div class="jFiler-item-title" title="{{fi-name}}">{{fi-name | limitTo:30}}</div><div class="jFiler-item-others"><span>size: {{fi-size2}}</span><span>type: {{fi-extension}}</span><span class="jFiler-item-status">{{fi-progressBar}}</span></div><div class="jFiler-item-assets"><ul class="list-inline"><li><a class="icon-jfi-trash jFiler-item-trash-action"></a></li></ul></div></div></div></div></li>',itemAppend:'<li class="jFiler-item"><div class="jFiler-item-container"><div class="jFiler-item-inner"><div class="jFiler-item-icon pull-left">{{fi-icon}}</div><div class="jFiler-item-info pull-left"><div class="jFiler-item-title">{{fi-name | limitTo:35}}</div><div class="jFiler-item-others"><span>size: {{fi-size2}}</span><span>type: {{fi-extension}}</span><span class="jFiler-item-status"></span></div><div class="jFiler-item-assets"><ul class="list-inline"><li><a class="icon-jfi-trash jFiler-item-trash-action"></a></li></ul></div></div></div></div></li>',progressBar:'<div class="bar"></div>',itemAppendToEnd:!1,removeConfirmation:!0,canvasImage:!0,_selectors:{list:".jFiler-items-list",item:".jFiler-item",progressBar:".bar",remove:".jFiler-item-trash-action"}},files:null,uploadFile:null,dragDrop:null,addMore:!1,allowDuplicates:!1,clipBoardPaste:!0,excludeName:null,beforeRender:null,afterRender:null,beforeShow:null,beforeSelect:null,onSelect:null,onFileCheck:null,afterShow:null,onRemove:null,onEmpty:null,options:null,dialogs:{alert:function(e){return alert(e)},confirm:function(e,t){confirm(e)?t():null}},captions:{button:"Choose Files",feedback:"Choose files To Upload",feedback2:"files were chosen",drop:"Drop file here to Upload",removeConfirmation:"Are you sure you want to remove this file?",errors:{filesLimit:"Only {{fi-limit}} files are allowed to be uploaded.",filesType:"Only Images are allowed to be uploaded.",filesSize:"{{fi-name}} is too large! Please upload file up to {{fi-fileMaxSize}} MB.",filesSizeAll:"Files you've choosed are too large! Please upload files up to {{fi-maxSize}} MB.",folderUpload:"You are not allowed to upload folders."}}}}(jQuery),Array.prototype.find||(Array.prototype.find=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,a=Object(this),n=a.length>>>0,r=arguments[1],i=0;i<n;i++)if(t=a[i],e.call(r,t,i,a))return t}),Date.prototype.toShortDateString||(Date.prototype.toShortDateString=function(){return this.getFullYear()+"-"+("0"+(this.getMonth()+1)).slice(-2)+"-"+("0"+this.getDate()).slice(-2)});var ImagePlaceHolder=function(){var e=$("img[data-img-source]");e.each(function(){var e=this;$(e).attr("src",e.dataset.imgSource),$(e).on("error",function(e){$(e.target).on("error",null),e.target.dataset.placeholder&&$(e.target).attr("src",e.target.dataset.placeholder)})})},UploadImageModule=function(e){function t(e){var t=$(r.messages.confirmationDialogSelector);if(0!==t.length){$(".success-header-title",t).html(r.delConfirmationMess);var a=$(".success-confirm-inform.yes",t),n=$(".success-confirm-inform.no",t);n.html(r.noDelBtnText),a.html(r.yesDelBtnText),a.click(function(){e()}),t.fadeIn()}}function a(e,t){var a=$(r.messages.informationDialogSelector);a.find("#dialogTitle").html(e),a.find("#dialogContent").html(t),a.hasClass("hidden")?a.removeClass("hidden"):a.fadeIn()}var n,r={fileSelector:"",previewImgSelector:"",uploadBtnSelector:"",linkSelector:"",handleUrl:"",cancelUploadBtnSelector:"",deleteLinkSelector:"",handleDeleteUrl:"",errorMessage:"",prevImageData:"",isNeedToUpdateHeader:!1,messages:{confirmationDialogSelector:"#dialog-confirmation",delConfirmationMess:"Är du säker på att du vill ta bort bilden?",yesDelBtnText:"Ja, ta bort",noDelBtnText:"Nej, spara den",uploadingErrorMessage:"Något gick fel när du försökte ladda upp bilden. Vänligen försök igen.",uploadingErrorTitle:"Bilden kunde inte laddas upp",informationDialogSelector:"#informationDialog"}},i=[];$.extend(r,e);var o=function(){var e=new FormData;if(i&&i.length>0)for(var t=0;t<i.length;t++){var a=i[t];a.key&&a.value&&e.append(a.key,a.value)}return e},l=function(){$(r.fileSelector).change(function(){var e=this.files[0],t=e.type,a=["image/jpeg","image/png","image/jpg"];if(t!==a[0]&&t!==a[1]&&t!==a[2])return $(r.previewImgSelector).attr("src",n),!1;var i=new FileReader;i.onload=function(e){$(r.previewImgSelector).attr("src",e.target.result),$(r.uploadBtnSelector).parent().show()},i.readAsDataURL(this.files[0])})},s=function(){$(r.linkSelector).on("click",function(e){$(".popup-sub, .list-action-item").hide(),e.preventDefault(),$(r.fileSelector).trigger("click")})},d=function(){$(r.uploadBtnSelector).on("click",function(){var e=o(),t=$(r.fileSelector).get(0).files;if(t.length>0){var i=t[0].size;if(i>4096e3)return void a("","Filen är för stor. Maximal filstorlek 4MB.");e.append("UploadedImage",t[0])}$(r.previewImgSelector).prev().show(),$(r.uploadBtnSelector).parent().hide(),$.ajax({url:r.handleUrl,type:"POST",data:e,contentType:!1,cache:!1,processData:!1,success:function(e){$(r.previewImgSelector).prev().hide(),e.success?($(r.uploadBtnSelector).parent().hide(),$(r.deleteLinkSelector).show(),n=$(r.previewImgSelector).attr("src"),r.isNeedToUpdateHeader&&$(".lm__user-avatar-wrapper .header_user_avatar").attr("src",n),MachineDetailPage.autoFitImages()):($(r.previewImgSelector).attr("src",n),a(r.messages.uploadingErrorTitle,r.messages.uploadingErrorMessage))},error:function(e,t,i){$(r.previewImgSelector).prev().hide(),$(r.previewImgSelector).attr("src",n);var o="Det uppstod ett fel när bilden skulle laddas upp: "+i.toString();a(this.settings.uploadingErrorTitle,o)}})})},c=function(){$(r.cancelUploadBtnSelector).on("click",function(){$(r.fileSelector).val(""),$(r.uploadBtnSelector).parent().hide(),$(r.previewImgSelector).attr("src",n)})},u=function(){$(r.previewImgSelector).prev().show(),$(".popup-sub, .list-action-item").hide();var e=o();$.ajax({url:r.handleDeleteUrl,type:"POST",data:e,contentType:!1,cache:!1,processData:!1,success:function(e){$(r.previewImgSelector).prev().hide(),e.success?(n=e.imageUrl,$(r.deleteLinkSelector).hide(),$(r.previewImgSelector).attr("src",n),this.settings.isNeedToUpdateHeader&&$(".lm__user-avatar-wrapper .header_user_avatar").attr("src",n)):($(r.previewImgSelector).attr("src",n),a("","Det uppstod ett fel när bilden skulle laddas upp. Var god försök igen!"))},error:function(e,t,i){$(r.previewImgSelector).prev().hide(),$(r.previewImgSelector).attr("src",n);var o="Det uppstod ett fel när bilden skulle tas bort: "+i.toString();a(o)}})},p=function(){$(r.deleteLinkSelector).on("click",function(){t(u)})},m=function(e){i=e},h=function(e){e||$.extend(r,e),n=$(r.previewImgSelector).attr("src"),s(),l(),d(),c()},f=function(e){e||$.extend(r,e),p()};return{initDataForRequest:m,initUploadFile:h,initDeleteFile:f}},GroCommon=GroCommon||function(){var e=function(e){return e=e.split(/\D/),new Date(Date.UTC(e[0],--e[1]||"",e[2]||"",e[3]||"",e[4]||"",e[5]||"",e[6]||""))},t=function(e){var t=parseInt(e);return isNaN(t)&&(t=0),t},a=function(){},n=function(){},r=function(){var e=$("a");e.each(function(){var e=$(this).attr("href"),t=$(this).attr("target");if(!t){var a=void 0!=e&&0!==e.trim().indexOf("/")&&"#"!==e.trim()&&e.trim().indexOf("javascript:void")&&e.trim().indexOf("javascript:window.print()")<0;a&&$(this).attr("target","_blank")}})},i=function(e,t){return t.index(e)},o=function(e,t){var a=$(e),n=t.closest(e);if(a.length>0){var r=i(n,$(a));if(r>=0&&r<a.length-1){var o=$(a[r+1]);o.hasClass("disabled")&&o.removeClass("disabled")}}};return{blockUI:a,unblockUI:n,handleExternalLink:r,dateFromISO:e,parseInt:t,disableOrEnableElement:o}}();$(function(){ImagePlaceHolder()}),$(function(){function e(e){var t=$("button.submit.trigger-on-enter",$(e));if(t.length>0)return t;var a=$("button[type=submit].trigger-on-enter",$(e));if(a.length>0)return a;var n=$("input[type=submit].trigger-on-enter",$(e));return n.length>0?n:void 0}$("input[type=button].submit").click(function(){var e=$(event.target).closest("form");e&&$(e).submit()}),$("form").keyup(function(t){if(13===t.which){var a=$(t.target).closest("form");if(a){var n=e(a);void 0!==n&&$(n).click()}}})}),"undefined"==typeof Tablesaw&&(Tablesaw={i18n:{modes:["Stack","Swipe","Toggle"],columns:'Col<span class="a11y-sm">umn</span>s',columnBtnText:"Columns",columnsDialogError:"No eligible columns.",sort:"Sort"},mustard:"querySelector"in document&&(!window.blackberry||window.WebKitPoint)&&!window.operamini}),Tablesaw.config||(Tablesaw.config={}),Tablesaw.mustard&&jQuery(document.documentElement).addClass("tablesaw-enhanced"),function(e){var t="table",a={toolbar:"tablesaw-bar"},n={create:"tablesawcreate",destroy:"tablesawdestroy",refresh:"tablesawrefresh"},r="stack",i="table[data-tablesaw-mode],table[data-tablesaw-sortable]",o=function(t){if(!t)throw new Error("Tablesaw requires an element.");this.table=t,this.$table=e(t),this.mode=this.$table.attr("data-tablesaw-mode")||r,this.init()};o.prototype.init=function(){this.$table.attr("id")||this.$table.attr("id",t+"-"+Math.round(1e4*Math.random())),this.createToolbar();var e=this._initCells();this.$table.trigger(n.create,[this,e])},o.prototype._initCells=function(){var t,a=this.table.querySelectorAll("thead tr"),n=this;return e(a).each(function(){var r=0;e(this).children().each(function(){var e=parseInt(this.getAttribute("colspan"),10),i=":nth-child("+(r+1)+")";if(t=r+1,e)for(var o=0;o<e-1;o++)r++,i+=", :nth-child("+(r+1)+")";this.cells=n.$table.find("tr").not(a[0]).not(this).children().filter(i),r++})}),t},o.prototype.refresh=function(){this._initCells(),this.$table.trigger(n.refresh)},o.prototype.createToolbar=function(){
var t=this.$table.prev().filter("."+a.toolbar);t.length||(t=e("<div>").addClass(a.toolbar).insertBefore(this.$table)),this.$toolbar=t,this.mode&&this.$toolbar.addClass("mode-"+this.mode)},o.prototype.destroy=function(){this.$table.prev().filter("."+a.toolbar).each(function(){this.className=this.className.replace(/\bmode\-\w*\b/gi,"")});var r=this.$table.attr("id");e(document).unbind("."+r),e(window).unbind("."+r),this.$table.trigger(n.destroy,[this]),this.$table.removeData(t)},e.fn[t]=function(){return this.each(function(){var a=e(this);if(!a.data(t)){var n=new o(this);a.data(t,n)}})},e(document).on("enhance.tablesaw",function(a){Tablesaw.mustard&&e(a.target).find(i)[t]()})}(jQuery),function(e,t,a){var n={stackTable:"tablesaw-stack",cellLabels:"tablesaw-cell-label",cellContentLabels:"tablesaw-cell-content"},r={obj:"tablesaw-stack"},i={labelless:"data-tablesaw-no-labels",hideempty:"data-tablesaw-hide-empty"},o=function(e){this.$table=t(e),this.labelless=this.$table.is("["+i.labelless+"]"),this.hideempty=this.$table.is("["+i.hideempty+"]"),this.labelless||(this.allHeaders=this.$table.find("th")),this.$table.data(r.obj,this)};o.prototype.init=function(e){if(this.$table.addClass(n.stackTable),!this.labelless){var a=t(this.allHeaders),r=this.hideempty;a.each(function(){var a=t(this),o=t(this.cells).filter(function(){return!(t(this).parent().is("["+i.labelless+"]")||r&&t(this).is(":empty"))}),l=o.not(this).filter("thead th").length&&" tablesaw-cell-label-top",s=a.find(".tablesaw-sortable-btn"),d=s.length?s.html():a.html();if(""!==d)if(l){var c=parseInt(t(this).attr("colspan"),10),u="";c&&(u="td:nth-child("+c+"n + "+e+")"),o.filter(u).prepend("<b class='"+n.cellLabels+l+"'>"+d+"</b>")}else o.wrapInner("<span class='"+n.cellContentLabels+"'></span>"),o.prepend("<b class='"+n.cellLabels+"'>"+d+"</b>")})}},o.prototype.destroy=function(){this.$table.removeClass(n.stackTable),this.$table.find("."+n.cellLabels).remove(),this.$table.find("."+n.cellContentLabels).each(function(){t(this).replaceWith(this.childNodes)})},t(document).on("tablesawcreate",function(e,t,a){if("stack"===t.mode){var n=new o(t.table);n.init(a)}}),t(document).on("tablesawdestroy",function(e,a){"stack"===a.mode&&t(a.table).data(r.obj).destroy()})}(this,jQuery),function(e){var t="tablesawbtn",a={_create:function(){return e(this).each(function(){e(this).trigger("beforecreate."+t)[t]("_init").trigger("create."+t)})},_init:function(){var a=e(this),n=this.getElementsByTagName("select")[0];return n&&e(this).addClass("btn-select")[t]("_select",n),a},_select:function(t){var a=function(t,a){var n,r,i,o=e(a).find("option");if(o.each(function(){var e=this;e.selected&&(n=document.createTextNode(e.text))}),i=t.childNodes,o.length>0)for(var l=0,s=i.length;l<s;l++)r=i[l],r&&3===r.nodeType&&t.replaceChild(n,r)};a(this,t),e(this).bind("change refresh",function(){a(this,t)})}};e.fn[t]=function(a,n,r,i){return this.each(function(){return a&&"string"==typeof a?e.fn[t].prototype[a].call(this,n,r,i):e(this).data(t+"active")?e(this):(e(this).data(t+"active",!0),void e.fn[t].prototype._create.call(this))})},e.extend(e.fn[t].prototype,a)}(jQuery),function(e,t,a){var n=function(e){this.$table=t(e),this.classes={columnToggleTable:"tablesaw-columntoggle",columnBtnContain:"tablesaw-columntoggle-btnwrap tablesaw-advance",columnBtn:"tablesaw-columntoggle-btn tablesaw-nav-btn down",popup:"tablesaw-columntoggle-popup",priorityPrefix:"tablesaw-priority-",toolbar:"tablesaw-bar"},this.headers=this.$table.find("tr:first > th"),this.$table.data("tablesaw-coltoggle",this)};n.prototype.init=function(){function e(e){e&&t(e.target).closest("."+d.classes.popup).length||(t(document).unbind("click."+n),i.removeClass("up").addClass("down"),s.removeClass("visible"))}function a(){s.addClass("visible"),i.removeClass("down").addClass("up"),t(document).unbind("click."+n,e),window.clearTimeout(u),u=window.setTimeout(function(){t(document).one("click."+n,e)},15)}var n,r,i,o,l,s,d=this;this.$table.addClass(this.classes.columnToggleTable),n=this.$table.attr("id"),r=n+"-popup",s=t("<div class='"+this.classes.columnBtnContain+"'></div>"),i=t("<a href='#"+r+"' class='btn btn-micro "+this.classes.columnBtn+"' data-popup-link><span>"+Tablesaw.i18n.columnBtnText+"</span></a>"),o=t("<div class='dialog-table-coltoggle "+this.classes.popup+"' id='"+r+"'></div>"),l=t("<div class='btn-group'></div>");var c=!1;t(this.headers).not("td").each(function(){var e=t(this),a=e.attr("data-tablesaw-priority"),n=d.$getCells(this);a&&"persist"!==a&&(n.addClass(d.classes.priorityPrefix+a),t("<label><input type='checkbox' checked>"+e.text()+"</label>").appendTo(l).children(0).data("tablesaw-header",this),c=!0)}),c||l.append("<label>"+Tablesaw.i18n.columnsDialogError+"</label>"),l.appendTo(o),l.find('input[type="checkbox"]').on("change",function(e){var t=e.target.checked;d.$getCellsFromCheckbox(e.target).toggleClass("tablesaw-cell-hidden",!t).toggleClass("tablesaw-cell-visible",t),d.$table.trigger("tablesawcolumns")}),i.appendTo(s),s.appendTo(this.$table.prev().filter("."+this.classes.toolbar));var u;i.on("click.tablesaw",function(t){t.preventDefault(),s.is(".visible")?e():a()}),o.appendTo(s),this.$menu=l,t(window).on("resize."+n,function(){d.refreshToggle()}),this.refreshToggle()},n.prototype.$getCells=function(e){return t(e).add(e.cells)},n.prototype.$getCellsFromCheckbox=function(e){var a=t(e).data("tablesaw-header");return this.$getCells(a)},n.prototype.refreshToggle=function(){var e=this;this.$menu.find("input").each(function(){this.checked="table-cell"===e.$getCellsFromCheckbox(this).eq(0).css("display")})},n.prototype.refreshPriority=function(){var e=this;t(this.headers).not("td").each(function(){var a=t(this),n=a.attr("data-tablesaw-priority"),r=a.add(this.cells);n&&"persist"!==n&&r.addClass(e.classes.priorityPrefix+n)})},n.prototype.destroy=function(){this.$table.removeClass(this.classes.columnToggleTable),this.$table.find("th, td").each(function(){var e=t(this);e.removeClass("tablesaw-cell-hidden").removeClass("tablesaw-cell-visible"),this.className=this.className.replace(/\bui\-table\-priority\-\d\b/g,"")})},t(document).on("tablesawcreate",function(e,t){if("columntoggle"===t.mode){var a=new n(t.table);a.init()}}),t(document).on("tablesawdestroy",function(e,a){"columntoggle"===a.mode&&t(a.table).data("tablesaw-coltoggle").destroy()})}(this,jQuery),function(e,t,a){function n(){var e=document.createElement("div"),t=e.getElementsByTagName("i");return e.innerHTML="<!--[if lte IE 8]><i></i><![endif]-->",!!t.length}function r(a){function r(e){return t(e.cells).add(e)}function o(e){r(e).removeClass("tablesaw-cell-hidden")}function l(e){r(e).addClass("tablesaw-cell-hidden")}function s(e){r(e).addClass("tablesaw-cell-persist")}function d(e){return t(e).is('[data-tablesaw-priority="persist"]')}function c(){a.removeClass(i.persistWidths),t("#"+S+"-persist").remove()}function u(){var e,n="#"+S+".tablesaw-swipe ",r=[],o=a.width(),l=[];D.each(function(e){var a;d(this)&&(a=t(this).outerWidth(),a<.75*o&&(l.push(e+"-"+a),r.push(n+" .tablesaw-cell-persist:nth-child("+(e+1)+") { width: "+a+"px; }")))}),e=l.join("_"),a.addClass(i.persistWidths);var s=t("#"+S+"-persist");s.length&&s.data("hash")===e||(s.remove(),r.length&&t("<style>"+r.join("\n")+"</style>").attr("id",S+"-persist").data("hash",e).appendTo(T))}function p(){var e,a=[];return k.each(function(n){var r=t(this),i="none"===r.css("display")||r.is(".tablesaw-cell-hidden");if(i||e){if(i&&e)return a[1]=n,!1}else e=!0,a[0]=n}),a}function m(){var e=p();return[e[1]-1,e[0]-1]}function h(e){return e?p():m()}function f(e){return e[1]>-1&&e[1]<k.length}function v(){var t=a.attr("data-tablesaw-swipe-media");return!t||"matchMedia"in e&&e.matchMedia(t).matches}function g(){if(v()){var e=20,n=a.parent().width(),r=[],i=0,d=[],u=D.length;D.each(function(a){var o=t(this),l=o.is('[data-tablesaw-priority="persist"]');r.push(l),i+=_[a]+(l?0:e),d.push(i),(l||i>n)&&u--});var p=0===u;D.each(function(e){return r[e]?void s(this):void(d[e]<=n||p?(p=!1,o(this)):l(this))}),x&&c(),a.trigger("tablesawcolumns")}}function $(e){var t=h(e);f(t)&&(isNaN(t[0])&&(e?t[0]=0:t[0]=k.length-1),x&&u(),l(k.get(t[0])),o(k.get(t[1])),a.trigger("tablesawcolumns"))}function b(e,t){return(e.touches||e.originalEvent.touches)[0][t]}var w=t("<div class='tablesaw-advance'></div>"),y=t("<a href='#' class='tablesaw-nav-btn btn btn-micro left' title='Previous Column'></a>").appendTo(w),C=t("<a href='#' class='tablesaw-nav-btn btn btn-micro right' title='Next Column'></a>").appendTo(w),D=a.find("thead th"),k=D.not('[data-tablesaw-priority="persist"]'),_=[],T=t(document.head||"head"),S=a.attr("id"),x=!n();if(!D.length)throw new Error("tablesaw swipe: no header cells found. Are you using <th> inside of <thead>?");a.css("width","auto"),D.each(function(){_.push(t(this).outerWidth())}),a.css("width",""),w.appendTo(a.prev().filter(".tablesaw-bar")),a.addClass("tablesaw-swipe"),S||(S="tableswipe-"+Math.round(1e4*Math.random()),a.attr("id",S)),y.add(C).click(function(e){$(!!t(e.target).closest(C).length),e.preventDefault()}),a.bind("touchstart.swipetoggle",function(a){var n,r,i=b(a,"pageX"),o=b(a,"pageY");t(e).off("resize",g),t(this).bind("touchmove",function(e){n=b(e,"pageX"),r=b(e,"pageY");var t=Tablesaw.config.swipe;Math.abs(n-i)>t.horizontalThreshold&&Math.abs(r-o)<t.verticalThreshold&&e.preventDefault()}).bind("touchend.swipetoggle",function(){var a=Tablesaw.config.swipe;Math.abs(r-o)<a.verticalThreshold&&(n-i<-1*a.horizontalThreshold&&$(!0),n-i>a.horizontalThreshold&&$(!1)),window.setTimeout(function(){t(e).on("resize",g)},300),t(this).unbind("touchmove touchend")})}).bind("tablesawcolumns.swipetoggle",function(){var e=f(m()),t=f(p());y[e?"removeClass":"addClass"](i.hideBtn),C[t?"removeClass":"addClass"](i.hideBtn),y.closest("."+i.toolbar)[e||t?"removeClass":"addClass"](i.allColumnsVisible)}).bind("tablesawnext.swipetoggle",function(){$(!0)}).bind("tablesawprev.swipetoggle",function(){$(!1)}).bind("tablesawdestroy.swipetoggle",function(){var a=t(this);a.removeClass("tablesaw-swipe"),a.prev().filter(".tablesaw-bar").find(".tablesaw-advance").remove(),t(e).off("resize",g),a.unbind(".swipetoggle")}),g(),t(e).on("resize",g)}t.extend(Tablesaw.config,{swipe:{horizontalThreshold:15,verticalThreshold:30}});var i={toolbar:"tablesaw-bar",hideBtn:"disabled",persistWidths:"tablesaw-fix-persist",allColumnsVisible:"tablesaw-all-cols-visible"};t(document).on("tablesawcreate",function(e,t){"swipe"===t.mode&&r(t.$table)})}(this,jQuery),function(e){function t(t){return e.map(t.childNodes,function(t){var a=e(t);if(a.is("input, select"))return a.val();if(!a.hasClass("tablesaw-cell-label"))return e.trim(a.text())}).join("")}var a="tablesaw-sortable",n="table[data-"+a+"]",r="[data-"+a+"-switch]",i={defaultCol:"data-tablesaw-sortable-default-col",numericCol:"data-tablesaw-sortable-numeric"},o={head:a+"-head",ascend:a+"-ascending",descend:a+"-descending",switcher:a+"-switch",tableToolbar:"tablesaw-toolbar",sortButton:a+"-btn"},l={_create:function(t){return e(this).each(function(){var n=e(this).data("init"+a);return!n&&void e(this).data("init"+a,!0).trigger("beforecreate."+a)[a]("_init",t).trigger("create."+a)})},_init:function(){var n,l,s=e(this),d=function(){s.addClass(a)},c=function(t){e.each(t,function(t,a){e(a).addClass(o.head)})},u=function(t,a){e.each(t,function(t,n){var r=e("<button class='"+o.sortButton+"'/>");r.bind("click",{col:n},a),e(n).wrapInner(r)})},p=function(t){e.each(t,function(t,a){var n=e(a);n.removeAttr(i.defaultCol),n.removeClass(o.ascend),n.removeClass(o.descend)})},m=function(t){if(!e(t.target).is("a[href]")){t.stopPropagation();var r=e(this).parent(),i=t.data.col,d=n.index(r);p(r.siblings()),r.hasClass(o.descend)?(s[a]("sortBy",i,!0),d+="_asc"):(s[a]("sortBy",i),d+="_desc"),l&&l.find("select").val(d).trigger("refresh"),t.preventDefault()}},h=function(t){e.each(t,function(t,a){var n=e(a);n.is("["+i.defaultCol+"]")&&(n.hasClass(o.descend)||n.addClass(o.ascend))})},f=function(n){l=e("<div>").addClass(o.switcher).addClass(o.tableToolbar).html(function(){var a=["<label>"+Tablesaw.i18n.sort+":"];return a.push('<span class="btn btn-small">&#160;<select>'),n.each(function(n){var r=e(this),l=r.is("["+i.defaultCol+"]"),s=r.hasClass(o.descend),d=r.is("[data-sortable-numeric]"),c=0,u=5;e(this.cells).slice(0,u).each(function(){isNaN(parseInt(t(this),10))||c++});var p=c===u;d||r.attr("data-sortable-numeric",p?"":"false"),a.push("<option"+(l&&!s?" selected":"")+' value="'+n+'_asc">'+r.text()+" "+(p?"&#x2191;":"(A-Z)")+"</option>"),a.push("<option"+(l&&s?" selected":"")+' value="'+n+'_desc">'+r.text()+" "+(p?"&#x2193;":"(Z-A)")+"</option>")}),a.push("</select></span></label>"),a.join("")});var r=s.prev().filter(".tablesaw-bar"),d=r.children().eq(0);d.length?l.insertBefore(d):l.appendTo(r),l.find(".btn").tablesawbtn(),l.find("select").on("change",function(){var t=e(this).val().split("_"),r=n.eq(t[0]);p(r.siblings()),s[a]("sortBy",r.get(0),"asc"===t[1])})};d(),n=s.find("thead th[data-"+a+"-col]"),c(n),u(n,m),h(n),s.is(r)&&f(n,s.find("tbody tr:nth-child(-n+3)"))},getColumnNumber:function(t){return e(t).prevAll().length},getTableRows:function(){return e(this).find("tbody tr")},sortRows:function(a,n,r,i){var o,l,s,d=function(a){var r=[];return e.each(a,function(a,i){var o=e(i).children().get(n);r.push({element:o,cell:t(o),rowNum:a})}),r},c=function(e,t){var a,n=/[^\-\+\d\.]/g;return a=e?function(e,a){return t?parseFloat(e.cell.replace(n,""))-parseFloat(a.cell.replace(n,"")):e.cell.toLowerCase()>a.cell.toLowerCase()?1:-1}:function(e,a){return t?parseFloat(a.cell.replace(n,""))-parseFloat(e.cell.replace(n,"")):e.cell.toLowerCase()<a.cell.toLowerCase()?1:-1}},u=function(e,t){var a,n,r,i=[];for(a=0,n=e.length;a<n;a++)r=e[a].rowNum,i.push(t[r]);return i};o=d(a);var p=e(i).data("tablesaw-sort");return l=!(!p||"function"!=typeof p)&&p(r)||c(r,e(i).is("[data-sortable-numeric]")&&!e(i).is('[data-sortable-numeric="false"]')),s=o.sort(l),a=u(s,a)},replaceTableRows:function(t){var a=e(this),n=a.find("tbody");n.html(t)},makeColDefault:function(t,a){var n=e(t);n.attr(i.defaultCol,"true"),a?(n.removeClass(o.descend),n.addClass(o.ascend)):(n.removeClass(o.ascend),n.addClass(o.descend))},sortBy:function(t,n){var r,i,o=e(this);r=o[a]("getColumnNumber",t),i=o[a]("getTableRows"),i=o[a]("sortRows",i,r,n,t),o[a]("replaceTableRows",i),o[a]("makeColDefault",t,n)}};e.fn[a]=function(t){var n,r=Array.prototype.slice.call(arguments,1);return t&&"string"==typeof t?(n=e.fn[a].prototype[t].apply(this[0],r),"undefined"!=typeof n?n:e(this)):(e(this).data(a+"data")||(e(this).data(a+"active",!0),e.fn[a].prototype._create.call(this,t)),e(this))},e.extend(e.fn[a].prototype,l),e(document).on("tablesawcreate",function(e,t){t.$table.is(n)&&t.$table[a]()})}(jQuery),function(e,t,a){function n(a){function n(t){var a=t.attr(r.attr.init);return!a||e.matchMedia&&e.matchMedia(a).matches}function i(){if(!n(a))return void o.hide();o.show();var e=l.find("li").removeClass(s);a.find("thead th").each(function(a){"none"===t(this).css("display")&&e.eq(a).addClass(s)})}var o=t('<div class="tablesaw-advance minimap">'),l=t('<ul class="tablesaw-advance-dots">').appendTo(o),s="tablesaw-advance-dots-hide",d=a.find("thead th");d.each(function(){l.append("<li><i></i></li>")}),o.appendTo(a.prev().filter(".tablesaw-bar")),i(),t(e).on("resize",i),a.bind("tablesawcolumns.minimap",function(){i()}).bind("tablesawdestroy.minimap",function(){var a=t(this);a.prev().filter(".tablesaw-bar").find(".tablesaw-advance").remove(),t(e).off("resize",i),a.unbind(".minimap")})}var r={attr:{init:"data-tablesaw-minimap"}};t(document).on("tablesawcreate",function(e,t){"swipe"!==t.mode&&"columntoggle"!==t.mode||!t.$table.is("[ "+r.attr.init+"]")||n(t.$table)})}(this,jQuery),function(e,t){var a={selectors:{init:"table[data-tablesaw-mode-switch]"},attributes:{excludeMode:"data-tablesaw-mode-exclude"},classes:{main:"tablesaw-modeswitch",toolbar:"tablesaw-toolbar"},modes:["stack","swipe","columntoggle"],init:function(e){var n=t(e),r=n.attr(a.attributes.excludeMode),i=n.prev().filter(".tablesaw-bar"),o="",l=t("<div>").addClass(a.classes.main+" "+a.classes.toolbar).html(function(){var e,t=["<label>"+Tablesaw.i18n.columns+":"],i=n.attr("data-tablesaw-mode");t.push('<span class="btn btn-small">&#160;<select>');for(var l=0,s=a.modes.length;l<s;l++)r&&r.toLowerCase()===a.modes[l]||(e=i===a.modes[l],e&&(o=a.modes[l]),t.push("<option"+(e?" selected":"")+' value="'+a.modes[l]+'">'+Tablesaw.i18n.modes[l]+"</option>"));return t.push("</select></span></label>"),t.join("")}),s=i.find(".tablesaw-advance").eq(0);s.length?l.insertBefore(s):l.appendTo(i),l.find(".btn").tablesawbtn(),l.find("select").bind("change",a.onModeChange)},onModeChange:function(){var e=t(this),n=e.closest("."+a.classes.main),r=e.closest(".tablesaw-bar").nextUntil(r).eq(0),i=e.val();n.remove(),r.data("table").destroy(),r.attr("data-tablesaw-mode",i),r.table()}};t(e.document).on("tablesawcreate",function(e,t){t.$table.is(a.selectors.init)&&a.init(t.table)})}(this,jQuery),function(e){function t(t){var a=e(t).closest("tr").addClass("deleted").children("td");setTimeout(function(){e(a).animate({paddingTop:0,paddingBottom:0},500).wrapInner("<div />").children().slideUp(500,function(){e(this).closest("tr").remove()})},1e3)}e(document).trigger("enhance.tablesaw"),e(".tablesaw").length>0&&(e(".tablesaw-bar").hide(),e(".tablesaw").each(function(){var t=e(this),a=t.find("thead tr th"),n=t.prev();a.length>2?n.removeAttr("style"):t.css("min-width","inherit")})),e(".lm__internal-table tbody tr .lm__form-btn").click(function(){t(e(this))})}(jQuery),$(function(){function e(){return"ontouchstart"in window||navigator.maxTouchPoints}function t(){try{for(var e=/:hover/,t=0;t<document.styleSheets.length;t++){var a=document.styleSheets[t];if(a.cssRules)for(var n=a.cssRules.length-1;n>=0;n--){var r=a.cssRules[n];r.type===CSSRule.STYLE_RULE&&e.test(r.selectorText)&&a.deleteRule(n)}}}catch(i){}}function a(){var e=$(".lm__contents").width(),t=$(".sticky-header"),a=$(".internal-page > .wrapper >.layout > .layout__item:first-child").width(),n=$(".internal-navigation");t.hasClass("fixed")?t.css({width:e+"px"}):t.removeAttr("style"),n.css({width:a})}var n=function(){var t=$(".lm_toggle-menu"),a=$(".lm__main-navigation > ul > li").has("ul"),n=($(".lm__main-navigation > ul li ul li").has(".lm__child-sub-navigation"),t.next()),r=$(".lm__settings > a"),i=$(".lm__sub-navigation"),o=$(".lm__user-avatar-wrapper"),l=function(){n.removeAttr("style"),a.find("ul").slideUp("slow",function(){$(this).prev().removeClass("minus-sign").addClass("plus-sign"),$(this).removeAttr("style")}),t.removeClass("active"),$(".humb").removeClass("open"),r.parent().removeClass("active").find(".lm_sub-settings").slideUp(),$(".lm__navigation-wrapper.showed-menu").removeClass("showed-menu"),o.find(".lm__user-avatar").next().slideUp(),$(".user-info-wrapper > a").next().slideUp()},s=function(){var e=o.find(".lm__user-avatar");e.click(function(){l();var e=$(this).next();return $(this).toggleClass("active"),"none"==e.css("display")?e.slideDown():e.slideUp(),!1})},d=function(){var e=$(".user-info-wrapper > a");e.click(function(){return l(),"none"==$(this).next().css("display")?$(this).next().slideDown():$(this).next().slideUp(),!1})},c=function(){""==$(".lm__settings > a").text()&&$(".lm__settings > a").css({padding:"0 25px"}),$(document).on("click",function(){l()}).on("touchstart",function(e){var t=$(e.target);"lm__user-info"==t.attr("class")||$(t).parents(".user-info-wrapper").length>0||$(".user-info-wrapper > a").next().slideUp()}),r.off("click").on("click",function(e){e.stopPropagation(),l();var n=$(this).next();return a.find(".lm_sub-settings").slideUp(),"none"==n.css("display")?(n.slideDown("fast",function(){$(this).is(":visible")&&$(this).css("display","inline-block")}),$(this).parent().addClass("active")):(n.slideUp("fast"),$(this).parent().removeClass("active")),t.removeClass("active"),$(".humb").removeClass("open"),i.slideUp("slow",function(){$(this).removeAttr("style")}),!1}),t.off("click").on("click",function(t){t.stopPropagation();var a=$(this),n=a.next();return e()&&n.css({"max-height":"calc(100vh - 100px)",overflow:"hidden","overflow-y":"visible"}),"none"==n.css("display")?(n.slideDown("fast"),a.addClass("active").find(".humb").addClass("open")):(n.slideUp("fast"),a.removeClass("active").find(".humb").removeClass("open")),r.parent().removeClass("active").find(">a").next().slideUp(),!1}),a.each(function(){$(this).find("> a").off("click").on("click",function(e){var t=$(this);return a.not(t.parent()).find("ul").slideUp(function(){$(this).prev().removeClass("minus-sign").addClass("plus-sign")}),r.parent().removeClass("active").find(".lm_sub-settings").slideUp(),t.next().slideToggle(function(){"none"==$(this).css("display")?t.removeClass("minus-sign").addClass("plus-sign"):t.removeClass("plus-sign").addClass("minus-sign")}),$(window).width()<1083&&t.next().find(".lm__child-sub-navigation").slideToggle(),!1})})},u=function(){var e=$(window).height()-50,t=$(".lm_sub-settings").height();t>e?$(".lm_sub-settings").css({height:$(window).height()-50+"px"}):$(".lm_sub-settings").css("height","auto")},p=function(){a.each(function(){var e=$(this);e.has(".lm__sub-navigation")&&e.find(">a").addClass("plus-sign")})},m=function(){$(window).width()>=1083?a.find(">a").addClass("hide-icon"):a.find(">a").removeClass("hide-icon")};return{init:function(){p(),m(),l(),c(),s(),d(),u(),$(window).on("resize orientationchange",function(){$(window).width()>=1083&&$(".lm__main-navigation > ul").removeAttr("style"),u(),m()})}}},r=function(){var e=$(".lm__category-nav > ul > li").has("ul"),t=function(){e.each(function(){$(this).find("ul li.active").length>0||$(this).hasClass("active")?$(this).addClass("open").find("ul").slideDown():$(this).removeClass("open")})};return{init:function(){t()}}},i=function(){var e=function(){$.ajax({dataType:"json",url:"/api/user/get-inbox-statistics",type:"post",cache:!1,success:function(e){e&&e.totalUnRead>0?($("#totalUnread").hasClass("lm__messages-count")||$("#totalUnread").addClass("lm__messages-count"),$("#totalUnread").html(e.totalUnRead)):($("#totalUnread").hasClass("lm__messages-count")&&$("#totalUnread").removeClass("lm__messages-count"),$("#totalUnread").html("")),e&&e.totalStarred>0?($("#totalStarred").hasClass("lm__messages-stat-count")||$("#totalStarred").addClass("lm__messages-stat-count"),$("#totalStarred").html(e.totalStarred)):($("#totalStarred").hasClass("lm__messages-stat-count")&&$("#totalStarred").removeClass("lm__messages-stat-count"),$("#totalStarred").html(""))}})};return{init:function(){e()}}},o=function(){var e=function(){var e=$(".user-id__wrapper.lm__radio");e&&e.on("click",function(){var e=$(this).attr("data-customer-no"),t=$("a.lm__user-info").attr("data-active-No");if(e!==t){var a=$(this).attr("data-customer-name");$(".lm__user-info .lm__user-id").html(e),$("a.lm__user-info").attr("data-active-No",e),$(".lm__user-info .lm__user-summary").html(a),$("#newCustomerNumber").val(e),$("#customerNumberForm").submit()}})};return{init:function(){e()}}};$(document).ready(function(){if(void 0!=$(".lm__navigation-wrapper")&&null!=$(".lm__navigation-wrapper")&&$(".lm__navigation-wrapper").length>0){$(".lm__navigation-wrapper").length>0&&$(window).scroll(function(){$(this).scrollTop()>$(".lm__navigation-wrapper").offset().top&&$(".lm__navigation").addClass("fixed"),$(this).scrollTop()<=$(".lm__navigation-wrapper").offset().top&&$(".lm__navigation").removeClass("fixed")});var l=new n;l.init();var s=new r;s.init();var d=new i;d.init(),$("#customer_list_selection")&&$("#customer_list_selection").on("change",function(e){var t=$(e.target).parents("form");t.submit()});var c=new o;c.init(),e()&&t()}$(".lm__header.internal-page").length>0&&($(window).scroll(function(){$(this).scrollTop()>$(".lm__header.internal-page").offset().top&&$(".sticky-header").addClass("fixed").css({width:$(".lm__contents").width()+"px"}),$(this).scrollTop()<=$(".lm__header.internal-page").offset().top&&$(".sticky-header").removeClass("fixed").removeAttr("style")}),$(window).resize(function(){a()}),a()),GroCommon&&GroCommon.handleExternalLink()})}),$(document).ready(function(){$("#header-internal-search .dropdown li a").click(function(){var e=$(this).attr("data-value");$("#searchOption").val(e)}),$("button#internal-search").click(function(){var e=$("#input-key-search").val();""!==e.trim()&&($("#searchKey").val(e),$("#internalSearchForm").submit())}),$("header.internal-page a.close-btn").click(function(){$(this).closest("#customer-popup").hasClass("open")&&$.ajax({dataType:"json",url:"/internal-portal/close-customer-session",type:"get",cache:!1,success:function(e){e&&location.reload()}})})}),function(e){e.fn.circliful=function(t,a){var n=e.extend({startdegree:0,fgcolor:"#556b2f",bgcolor:"#eee",fill:!1,width:15,dimension:200,fontsize:15,percent:50,animationstep:1,iconsize:"20px",iconcolor:"#999",border:"default",complete:null,bordersize:10},t);return this.each(function(){function a(t,a,n){e("<span></span>").appendTo(t).addClass(a).text(l).prepend(u).css({"line-height":n+"px","font-size":c.fontsize+"px",color:parseInt(l)>0?c.fgcolor:c.bgcolor})}function r(t,a){e("<span></span>").appendTo(t).addClass("circle-info-half").css("line-height",c.dimension*a+"px").text(s)}function i(t){e.each(d,function(a,r){void 0!=t.data(r)?c[r]=t.data(r):c[r]=e(n).attr(r),"fill"==r&&void 0!=t.data("fill")&&(h=!0)})}function o(a){g.clearRect(0,0,v.width,v.height),g.beginPath(),g.arc($,b,y,D,C,!1),g.lineWidth=c.bordersize+1,g.strokeStyle=c.bgcolor,g.stroke(),h&&(g.fillStyle=c.fill,g.fill()),g.beginPath(),g.arc($,b,y,-S+I,T*a-S+I,!1),"outline"==c.border?g.lineWidth=c.width+13:"inline"==c.border&&(g.lineWidth=c.width-13),g.strokeStyle=c.fgcolor,g.stroke(),k<p&&(k+=_,requestAnimationFrame(function(){o(Math.min(k,p)/100)},m)),k==p&&F&&"undefined"!=typeof t&&e.isFunction(t.complete)&&(t.complete(),F=!1)}var l,s,d=["fgcolor","bgcolor","fill","width","dimension","fontsize","animationstep","endPercent","icon","iconcolor","iconsize","border","startdegree","bordersize"],c={},u="",p=0,m=e(this),h=!1;if(m.addClass("circliful"),i(m),void 0!=m.data("text")&&(l=m.data("text"),void 0!=m.data("icon")&&(u=e("<i></i>").addClass("fa "+e(this).data("icon")).css({color:c.iconcolor,"font-size":c.iconsize})),void 0!=m.data("type")?(x=e(this).data("type"),"half"==x?a(m,"circle-text-half",c.dimension/1.45):a(m,"circle-text",c.dimension)):a(m,"circle-text",c.dimension)),void 0!=e(this).data("total")&&void 0!=e(this).data("part")){var f=e(this).data("total")/100;percent=(e(this).data("part")/f/100).toFixed(3),p=(e(this).data("part")/f).toFixed(3)}else void 0!=e(this).data("percent")?(percent=e(this).data("percent")/100,p=e(this).data("percent")):percent=n.percent/100;void 0!=e(this).data("info")&&(s=e(this).data("info"),void 0!=e(this).data("type")?(x=e(this).data("type"),"half"==x?r(m,.9):r(m,1.25)):r(m,1.25)),e(this).width(c.dimension+"px");var v=e("<canvas></canvas>").attr({width:c.dimension,height:c.dimension}).appendTo(e(this)).get(0),g=v.getContext("2d"),$=(e(v).parent(),v.width/2),b=v.height/2,w=360*c.percent,y=(w*(Math.PI/180),v.width/2.5),C=2.3*Math.PI,D=0,k=0===c.animationstep?p:0,_=Math.max(c.animationstep,0),T=2*Math.PI,S=Math.PI/2,x="",F=!0,I=c.startdegree/180*Math.PI;void 0!=e(this).data("type")&&(x=e(this).data("type"),"half"==x&&(C=2*Math.PI,D=3.13,T=Math.PI,S=Math.PI/.996)),o(k/100)})},e(document).ready(function(){e(".circle-progress").circliful()})}(jQuery),$(function(){function e(e){var t=a.find(".loader-wrapper");$(e).insertBefore(".button-confirm"),t.fadeOut()}var t,a=$(".lm__modal-alert"),n=a.find(".lm__modal-dialog"),r=function(e){var t=$(".lm__modal-alert"),a=t.find(".modal-close"),r=t.find(".loader-wrapper"),i=t.find(".success-confirm"),o=function(){return t.fadeOut(function(){n.find(".modal-header-title, .modal-content").remove()}),r.fadeIn(),!1},l=function(){t.bind("click",o),n.bind("click",function(e){return e.preventDefault(),!1}),a.bind("click",o),i.bind("click",o)};return{init:function(){return l(),!0}}};$(document).ready(function(){$(document).trigger("enhance.tablesaw"),t=new r,t.init(),$(".showAnalyze")&&$(".showAnalyze").bind("click",function(){var t="/api/agreement/farmsample/"+$(this).attr("data-id").toString();return $.ajax({dataType:"html",url:t,success:function(t){e(t)}}),a.fadeIn(),!1}),$(".showPriceHedging")&&$(".showPriceHedging").bind("click",function(){var t="/api/agreement/price-hedging/"+$(this).attr("data-id").toString();return $.ajax({dataType:"html",url:t,success:function(t){e(t)}}),a.fadeIn(),!1}),$(".showWeighInMoreInfo")&&$(".showWeighInMoreInfo").bind("click",function(){var t="/api/weigh-in/more-info/"+$(this).attr("data-id").toString();return t+="?date="+encodeURIComponent($(this).attr("data-date"))+"&sort="+encodeURIComponent($(this).attr("data-sort")),$.ajax({dataType:"html",url:t,success:function(t){e(t)},error:function(){a.fadeOut()}}),a.fadeIn(),!1}),$(".showWeighInAnalyze")&&$(".showWeighInAnalyze").bind("click",function(){var t="/api/weigh-in/analyze/"+$(this).attr("data-id").toString();return t+="?date="+encodeURIComponent($(this).attr("data-date"))+"&sort="+encodeURIComponent($(this).attr("data-sort")),$.ajax({dataType:"html",url:t,success:function(t){e(t)},error:function(){a.fadeOut()}}),a.fadeIn(),!1})})}),function(){$(document).ready(function(){var e=document.getElementById("lm__chart-dygraphs"),t=document.getElementById("lm__chart-status");window.Dygraph&&e&&t&&(g2=new Dygraph(document.getElementById("lm__chart-dygraphs"),e.dataset.rowdata,{labels:["Date","Höstvete Kvarn","Höstvete Foder","Maltkorn","Oljeväxter","Grynhavre"],labelsDiv:document.getElementById("lm__chart-status"),labelsKMB:!1,legend:"always",colors:["#0e8013","#808080","#030389","#fc0019","#aed8e5"],width:"100%",height:540,title:e.dataset.title,axisLineColor:"white"}));var a=document.getElementById("selectMonthPeriod");a&&$("#selectMonthPeriod > li > ul > li > a").click(function(){var e=$(this).parent().attr("data-value");location.href=window.location.origin+location.pathname+"?period="+e})})}(),$(function(){function e(){$.fn.datepicker&&($.datepicker.setDefaults({monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],firstDay:0,showOtherMonths:!0,selectOtherMonths:!0,dateFormat:"yy-mm-dd"}),$(".datepicker").datepicker({defaultDate:new Date,onSelect:function(e){$(this).data("previous")!=e},monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],firstDay:1}).datepicker("setDate",new Date).on("change",function(){var e=$(this),t=!/Invalid|NaN/.test(new Date(e.val()).toString()),a=/^\d\d\d\d-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$/gi.test(e.val());a&&t?e.next().hide():e.next().show()}))}function t(){var e=$(".lm__form-dropdown");$(document).on("click touchstart",function(e){var t=$(e.target);"dropdown"==t.attr("class")||$(t).parents(".lm__form-dropdown").length>0||$(".dropdown").hide()}),e.each(function(){$(this).find(".showcase > a").click(function(){var e=$(this).next();return $(".dropdown").not(e).hide(),"none"==e.css("display")?e.show():e.hide(),!1}),setDropdown($(this),"type-2"),setDropdown($(this),"type-3")})}e(),t()}),$(function(){$(document).ready(function(){function e(){return{supplier:$(".calculate_supplier").val(),lorryType:$("#LorryType").val(),deliveryAddressId:$("#DeliveryAdress").val(),quantity:$(".calculate_quantity").val(),deliveryDate:$(".calculate_deliveryDate").val(),itemId:$("#Artikel_Frakt").val()}}$("#calculate_delivery_fee")&&(jQuery.validator&&$("#calculateForm").validate({ignore:[],errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{LorryType:"required",DeliveryAdress:{required:!0},Quantity:{required:!0,
number:!0,min:1},DeliveryDate:{required:!0,swedishDate:!0},Artikel_Frakt:{required:!0}},messages:{LorryType:{required:"Du måste välja leveranssätt"},DeliveryAdress:{required:"Du måste välja en leveransadress"},Quantity:{required:"Du måste ange en kvantitet större än 0",number:"Ange ett numeriskt värde",min:"Du måste ange en kvantitet större än 1"},DeliveryDate:{required:"Du måste ange ett giltigt datum",swedishDate:"Du måste ange ett giltigt datum"},Artikel_Frakt:{required:"Du måste välja en artikel"}},highlight:function(e,t,a){$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t)}}),$("#calculate_delivery_fee").bind("click",function(t){if($("#calculateForm").valid()){$(".calculate_result .calculate_fee")&&$(".calculate_result .calculate_fee").html("..."),$("#loaderCalculation").show();var a="/api/deliveryfee/caluculate",n=e();$.ajax({type:"post",data:n,dataType:"html",url:a,success:function(e){$(".calculate_result").html(e)},complete:function(e){$("#loaderCalculation").hide()},error:function(){$(".calculate_result").html("")}})}}))})}),jQuery(function(){var e=e||function(){var e=jQuery(".deliveryNote a.showPdf"),t=function(e,t,a){GroCommon.blockUI();var n="/api/delivery-note/get-pdf?orderNumber="+e+"&fabricId="+t+"&rowNumber="+a;jQuery.ajax({dataType:"json",url:n,success:function(e){if(GroCommon.unblockUI(),null!=e&&null!=e.pdfData){var t=e.pdfData,a=$(".pdf-getting-error");if(t&&t.trim().endsWith(".pdf"))window.open("http://wcf.lantmannenlantbruk.se/pdf/"+t);else{var n="Ett fel uppstod när pdf skulle laddas";$(".success-header-title",a).html(n),a.fadeIn()}}},error:function(e){GroCommon.unblockUI()}})},a=function(){e.click(function(){var e=jQuery(this).attr("cdata-orderNumber"),a=jQuery(this).attr("cdata-activePdf"),n=jQuery(this).attr("cdata-fabricID"),r=jQuery(this).attr("cdata-rowNumber"),i=(jQuery(this).attr("cdata-customerNumber"),jQuery(this).attr("cdata-system"));if("True"==a)t(e,n,r);else{switch(i){case"3":break;case"4":}}})};return{init:a}}();$(document).ready(function(){e.init()})}),$(function(){var e=function(){var e=$(".lm__sok-grobarhet"),t=e.find(".lm__info"),a=e.find(".lm__modal-alert"),n=$(".lm__message-closable .close-btn, .lm__modal-alert .button-confirm .success-confirm-inform"),r=($(".lm__information-modal__wrapper"),function(){t.click(function(){a.fadeIn()})}),i=function(){n.click(function(){$(this).parents(".lm__modal-alert, .lm__message-closable").fadeOut()})},o=function(){$(".lm__information-modal__close-btn").click(function(){return $(this).parents(".lm__information-modal__wrapper").addClass("hidden"),$(this).parents(".lm__modal-alert").fadeOut(),!1})};return{init:function(){return r(),i(),o(),!1}}},t=function(){var e=$(".lm__modal__wrapper"),t=e.find(".lm__wide-modal__close-btn"),a=e.find(".lm__btn-close"),n=function(){t.click(function(){return $(this).parents(".lm__modal__wrapper").addClass("hidden"),!1}),a.click(function(){return $(this).parents(".lm__modal__wrapper").addClass("hidden"),!1})};return{init:function(){return n(),!1}}};$(document).ready(function(){var a=new e;a.init();var n=new t;n.init()})}),$(function(){$(document).ready(function(){$("form").on("change",".file-upload-field",function(){$(this).parent(".file-upload-wrapper").attr("data-text",$(this).val().replace(/.*(\/|\\)/,""))}),$("#attachments").length>0&&$("#attachments").filer({showThumbs:!0,addMore:!0,allowDuplicates:!1})})}),$(function(){$(document).ready(function(){})}),$(function(){var e=function(){var e=$("#toggle-view a"),t=$(".machine-list"),a=($(".machine-item"),function(){e.each(function(){var e=$(this);e.hasClass("active")&&e.css({backgroundColor:"#fff"})}),e.on("click",function(a){a.preventDefault();var n=$(this),r=n.data("target");return t.addClass("list"==r?"list-view":""),t.removeClass("grid"==r?"list-view":""),e.removeClass("active").removeAttr("style"),n.addClass("active").css({backgroundColor:"#fff"}),!1})});return{init:function(){a()}}};$(document).ready(function(){$(".lm__list-type a").on("click",function(){var e=$(this).attr("data-layout");$(".lm__list-type a").removeClass("active"),$(this).addClass("active"),$(".list-maskin").removeClass("list-type").removeClass("grid-type").addClass(e).show()}),$(".lm__list-type a.active").click(),$("#checkRegisterBtn").click(function(){$(".lm__modal-alert").show()});var t=new e;t.init()})}),jQuery.validator&&(jQuery.validator.addMethod("subItemRequired",function(e,t,a){return a},""),jQuery.validator.addMethod("regex",function(e,t,a){return this.optional(t)||a.test(e)},"Please enter a valid value.")),jQuery(function(){MyAccountPage.init(),HandinSignInInformationPage.init(),CompanyInformation.init(),BusinessProfile.init(),DeliveryAddress.init()});var MyAccountPage=MyAccountPage||function(){function e(){return{fileSelector:"#user-avatar__file",previewImgSelector:"#user-avatar",uploadBtnSelector:"#user-uploadBtn",cancelUploadBtnSelector:"#user-cancelUpload",linkSelector:"#user-link",handleUrl:"/api/profile/user-upload-avatar",isNeedToUpdateHeader:!0,deleteLinkSelector:"#user-deleteBtn",handleDeleteUrl:"/api/profile/user-delete-avatar",messages:{confirmationDialogSelector:"#dialog-user-confirmation"}}}function t(){return{fileSelector:"#company-avatar__file",previewImgSelector:"#company-avatar",uploadBtnSelector:"#company-uploadBtn",cancelUploadBtnSelector:"#company-cancelUpload",linkSelector:"#company-link",handleUrl:"/api/profile/company-upload-avatar",deleteLinkSelector:"#company-deleteBtn",handleDeleteUrl:"/api/profile/company-delete-avatar",messages:{confirmationDialogSelector:"#dialog-company-confirmation"}}}var a=function(){$(document).on("click",function(){$(".popup-sub").fadeOut()}),$(".lm__avatar .lm__avatar__upload-btn").click(function(){var e=$(this).parent();return e.has(".popup-sub")&&e.find(".popup-sub").fadeToggle(),!1})},n=function(){a();var n=e(),r=new UploadImageModule(n);r.initUploadFile(),r.initDeleteFile();var i=t(),o=new UploadImageModule(i);o.initUploadFile(),o.initDeleteFile()};return{init:n}}(),HandinSignInInformationPage=HandinSignInInformationPage||function(){var e=!1,t=!1,a=function(){var a=$("#hiddenSocialNumber").val();a&&""!==a&&($("#hiddenSocialNumber, #SocialSecurityNumber").val("************"),$(".lm__block .lm__checkbox").show()),$("#SocialSecurityNumber").change(function(){e=!0}),window.onload=function(){window.addEventListener("beforeunload",function(a){if(!t&&e){var n="It looks like you have been editing something. If you leave before saving, your changes will be lost.";return(a||window.event).returnValue=n,n}})}},n=function(){var e=$("#SocialSecurityNumber").removeClass("error").val();if($("#error-message").hide(),null==e||""===e)return $("#SocialSecurityNumber").addClass("error"),$("#error-message").show().html("Personnummer måste fyllas i"),$(".lm__block .lm__checkbox").hide(),!1;var a=/^([0-9]{12})$|^([0-9]{10})$/;return a.test(e)?void(t=!0):($("#SocialSecurityNumber").addClass("error"),$("#error-message").show().html("Du måste ange 12 siffror (ÅÅÅÅMMDDNNNN)"),$(".lm__block .lm__checkbox").hide(),!1)};return{init:a,validateForm:n}}(),CompanyInformation=CompanyInformation||function(){var e=function(){$(document).ready(function(){$().validate&&$("#editCompanyInformationFrom").validate({errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{CompanyName:"required",Address:"required",ZipCode:{required:!0,zipCode:!0},City:"required",PhoneMobile:{required:!0,mobileSE:!0},PhoneWork:{phoneSE:!0},Email:{required:!0,email:!0}},messages:{CompanyName:"Du måste ange Företag/namn",Address:"Du måste ange Gatuadress",ZipCode:{required:"Du måste ange Postnummer",zipCode:window.validationMessage.zipCode.valid},City:{required:"Du måste ange Ort"},PhoneMobile:{required:window.validationMessage.mobileSE.required,mobileSE:window.validationMessage.mobileSE.valid},PhoneWork:{phoneSE:window.validationMessage.phoneSE.valid},Email:{required:"Du måste ange E-post",email:"Ange en giltig e-postadress"}},highlight:function(e,t,a){$("div.errors-list").hide(),$("ul.errors-list").show(),$("li#p_"+$(e).attr("id")).show(),$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t),$("li#p_"+$(e).attr("id")).hide(),$("ul.errors-list").find('li[id^="p"]').is(":visible")===!1&&$("ul.errors-list").hide()}})})};return{init:e}}(),BusinessProfile=BusinessProfile||function(){var e=function(){$(document).ready(function(){$().validate&&$("#editBusinessProfileForm").validate({errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{"BusinessProfile.Name":"required"},messages:{"BusinessProfile.Name":"Du måste ange Typ av verksamhet"},highlight:function(e,t,a){$("div.errors-list").hide(),$("ul.errors-list").show(),$("li#p_"+$(e).attr("id")).show(),$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t),$("li#p_"+$(e).attr("id")).hide(),$("ul.errors-list").find('li[id^="p"]').is(":visible")===!1&&$("ul.errors-list").hide()}})})};return{init:e}}(),DeliveryAddress=DeliveryAddress||function(){function e(e){var t="<div class='author-inform-form__column author-inform-form__column-full silos-box gray-background'> </div>",a="<a href='#' class='silos-box__delete-btn'></a>",n=" <span>Silo nr*</span> <input type='text' name='Silos["+e+"].Number' class='silos silo-number' placeholder='12' /><span>Framkomlighet* </span>",r=" <ul class='lm__form-dropdown type-3'><li class='showcase' data-value='10M'><a href='#' id='selected-silor"+e+"'>10 meter</a><ul class='dropdown'><li data-value='10M' class='selected'><a href='#'>10 meter</a></li><li data-value='12M'><a href='#'>12 meter</a></li><li data-value='24M'><a href='#'>24 meter</a></li></ul><input type='hidden' class='form-element silo-accessibility' name='Silos["+e+"].Accessibility' value='10M' /></li></ul>";return $(t).append(a,n,r)}function t(){var e=$("#editDeliveryAddress .lm__form-dropdown .showcase").attr("data-value");if(e){var t=$(".lm__form-dropdown .dropdown li");t.removeClass("selected"),t.each(function(){var t=$(this).attr("data-value");t==e&&$(this).addClass("selected")})}}function a(){$("#btn-add-silo").click(function(t){var a=$("div.silos-box").length,r=$(".silo-container"),i=e(a);r.append(i),setDropdown($(".lm__form-dropdown"),"type-3"),n(),t.preventDefault()})}function n(){$(".silos-box__delete-btn").click(function(e){e.preventDefault(),$(this).closest("div.silos-box").remove(),$("input.silo-number").each(function(e,t){$(this).attr("name","Silos["+e+"].Number")}),$("input.silo-accessibility").each(function(e,t){$(this).attr("name","Silos["+e+"].Accessibility")})})}function r(e){var t="#has-"+e+"-indicator",a=$(t);if(a&&a.length>0){var n="true"===a.val().toString().toLowerCase();if(n){var r="#modal-"+e+".lm__information-modal__wrapper",i=$(r);i.removeClass("hidden")}}}function i(){var e=$("input.notification-receiver-handler");e&&e.length>0&&e.click(function(){$(this).val($(this).is(":checked"))})}function o(){r("added"),r("updated"),r("deleted"),$("#editDeliveryAddress")&&0!=$("#editDeliveryAddress").length&&(t(),a(),n(),l(),i())}var l=function(){var e=$("#del-delivery-address");e.length>0&&e.click(function(e){e.preventDefault();var t=$("#addressNumber").val().toString(),a=$("#handler-delivery-page-id").val().toString(),n="/api/handle-delivery-address/delete/"+t+"/"+a;$.ajax({dataType:"html",url:n,cache:!1,success:function(e){e&&""!==e.toString().trim()&&(window.location=e)}})})};return{init:o}}();$(function(){MachineDetailPage.init(),MachineAddPage.Init(),MachineBookingService.Init()}),function(e){e.fn.imgLoad=function(t){return this.each(function(){t&&(this.complete||e(this).height()>0?t.apply(this):e(this).on("load",function(){t.apply(this)}))})}}(jQuery);var MachineDetailPage=MachineDetailPage||function(){var e=!1,t=function(){$(".avatar-icon").on("click",function(e){e.preventDefault(),$(this).parents(".lm__block-metadata").find(".list-action-item").toggle()})},a=function(){var e=$("#inno").val();if(e){var t="https://api.trackunit.com/public/GetUnit";$.ajax({url:t,type:"GET",cache:!1,data:{token:"11df2ae9bba646ceb8be959f23445b23",format:"json",referenceNumber:e},dataType:"jsonp",success:function(e){if(e&&e.list&&e.list.length>0){var t=e.list[0],a=((parseFloat(t.preRun1)+parseFloat(t.run1))/3600).toFixed(1);$("#total_hours").show().find(".total-text").html(a+" t")}else $("#generic_banner").show()}})}else $("#generic_banner").show()},n=function(){var e=$(".machine-item__thumbnail-wrapper img");e.each(function(){$(this).imgLoad(function(){var e=$(this),t={width:$(this).width(),height:$(this).height()};t.height<t.width?t.width/t.height>e.parent().width()/e.parent().height()?$(this).removeClass("horizontal-img").addClass("vertical-img"):$(this).removeClass("vertical-img").addClass("horizontal-img"):t.height/t.width>e.parent().height()/e.parent().width()?$(this).removeClass("vertical-img").addClass("horizontal-img"):$(this).removeClass("horizontal-img").addClass("vertical-img")})})},r=function(){$(".remove-machine-button").click(function(){$(".delete-machine-alert").show()}),$("#agree-remove-machine").click(function(){$("#form-remove-machine").submit()}),$("#disagree-remove-machine").click(function(){$(".lm__modal-alert").hide()});var e=$("#deleteFailed").val();"True"===e&&alert("Radera maskin misslyckades. Kontrollera igen!")},i=function(){t(),a(),r(),n(),$(window).on("resize orientationchange",function(){e||(e=!0,setTimeout(function(){n(),e=!1},100))}),$(window).trigger("resize");var i={fileSelector:"#machine-file",previewImgSelector:"#machine-picture",uploadBtnSelector:"#machine-uploadBtn",cancelUploadBtnSelector:"#machine-cancelUpload",linkSelector:"#machine-link",handleUrl:"/api/machine/machine-upload-avatar",isNeedToUpdateHeader:!1,errorMessage:"Det uppstod ett fel när bilden skulle laddas upp. Var gör försök igen!",deleteLinkSelector:"#machine-deleteBtn",handleDeleteUrl:"/api/machine/machine-delete-avatar"},o=new UploadImageModule(i);o.initDataForRequest([{key:"machineId",value:$("#machineId").val()}]),o.initUploadFile(),o.initDeleteFile()};return{init:i,autoFitImages:n}}(),MachineAddPage=MachineAddPage||function(){function e(){var e=$("#registration").val().toUpperCase();e&&""!==e.trim()&&(e=e.trim(),r(),$.ajax({url:"/api/add-machine/check-register-number?registerNumber="+e,type:"GET",dataType:"json",success:function(e){n(),null!=e.id&&""!=e.id?($("#serial-number").val(e.serialNumber),$("#drop-machine-category > .dropdown > li").each(function(){if($(this).attr("data-value")==e.category.Key)return $("#drop-machine-category > .dropdown > li").removeClass("selected"),$(this).addClass("selected"),$(this).parents(".showcase").attr("data-value",e.category.Key),$(this).parents(".showcase").find(">a").html(e.category.Name),$(this).parents(".showcase").find(">input").val(e.category.Key),!1}),$("#drop-machine-brand > .dropdown > li").each(function(){if($(this).attr("data-value")==e.brand.Key)return $("#drop-machine-brand > .dropdown > li").removeClass("selected"),$(this).addClass("selected"),$(this).parents(".showcase").attr("data-value",e.brand.Key),$(this).parents(".showcase").find(">a").html(e.brand.Name),$(this).parents(".showcase").find(">input").val(e.brand.Key),t(e.brand.Key,e.model.Name),!1})):$(".lm__modal-alert").show()},error:function(e,t,a){n(),alert(a.toString())}}))}function t(e,t){var a=void 0==e?$(i).attr("data-value"):e,n="/api/add-machine/get-machine-models?brandId="+a;void 0!=t&&(n+="&modelName="+t),$.ajax({url:n,type:"GET",dataType:"html",success:function(e){e&&$(".model-dd-container").html(e),setDropdown($(o).parent(),"type-3")}})}function a(){var e=$("#drop-machine-category"),t=$(i),a=$(o),n=t.parent().parent().find(">input"),r=a.parent().parent().find(">input"),l=new Array;""==e.attr("data-value")||void 0==e.attr("data-value")?(l.push("Typ"),e.parent().parent().find(".error-item").show()):e.parent().parent().find(".error-item").hide(),""==t.attr("data-value")||void 0==t.attr("data-value")?(l.push("Märke"),t.parent().parent().find(".error-item").show()):"Annan"==t.attr("data-value")&&""==n.val()?(l.push("Märke"),t.parent().parent().find(".error-item").show()):t.parent().parent().find(".error-item").hide(),""==a.attr("data-value")||void 0==a.attr("data-value")?(l.push("Modell"),a.parent().parent().find(".error-item").show()):"Annan"==a.attr("data-value")&&""==r.val()?(l.push("Modell"),a.parent().parent().find(".error-item").show()):a.parent().parent().find(".error-item").hide();var s=$("#machine-add-error-list");return l.length>0?(s.show(),s.html(""),s.append($("<li></li>").addClass("errors-list__header").append("Du måste ange")),$.each(l,function(e,t){s.append($("<li></li>").append(t))}),!1):(s.hide(),!0)}function n(){$(".loader-wrapper").hide(),$(".loader-wrapper").parent().removeClass("disabled")}function r(){$(".loader-wrapper").show(),$(".loader-wrapper").parent().addClass("disabled")}var i="#drop-machine-brand",o="#drop-machine-model",l=function(){$("#drop-machine-brand .dropdown li a").each(function(e,a){var n=$(a);n.click(function(){if("Annan"===n.parent().data("value")){n.parents(".branch-block").find('input[type="text"]').show(),n.parents("ul.lm__form-dropdown.branch-dropdown").hide();var e=$(o);e.parents(".model-block").find('input[type="text"]').show(),e.attr("data-value","Annan"),e.find('>input[type="hidden"]').val("Annan"),e.parents("ul.lm__form-dropdown.model-dropdown").hide()}else{var a=n.attr("data-value");t(a)}})})},s=function(){$("#drop-machine-category .dropdown li a").each(function(e,t){var a=$(t);a.click(function(){var e=a.parents(".showcase").data("value");"Other"===e&&(a.parents(".category-block").find('input[type="text"]').show(),a.parents("ul.lm__form-dropdown").hide(),a.parents(".showcase").find("input[name=machineCategory").val(""))})})},d=function(){$("#machine-registration-button").click(function(){e()})},c=function(){$("#form-adding-machine").submit(function(){return a()})},u=function(){l(),s(),d(),c()};return{Init:u}}(),MachineBookingService=MachineBookingService||function(){function e(e){o=e}function t(e,t){$(e).find("p > a").click(function(e){if(null!=t&&t.length>0){var a=$(this).parent().find('input[type="hidden"]').val();r(t,a)}e.preventDefault()})}function a(){var a=$("#book-service-category").attr("data-value");$.ajax({url:"/api/book-service/get-machine-by-category?categoryKey="+a,type:"GET",dataType:"json",success:function(a){$("#book-service-loading").hide(),$.each(a,function(a,n){if(n.length>6){$("#book-machine-list-2").show(),$("#book-machine-list-1").hide();var r=$("#book-machine-list-2 > .address-sections > select");r.html(""),$.each(n,function(e,t){r.append($("<option></option>").attr("value",t.id).append(t.modelName))}),e(n)}else if(n.length>0&&n.length<=6){$("#book-machine-list-2").hide(),$("#book-machine-list-1").show();var i=$("#book-machine-list-1 > .address-sections");i.html(""),i.append($("<h3></h3>").addClass("lm__bold-title").append("Mina maskiner")),$.each(n,function(e,t){i.append($("<p></p>").append($("<a></a>").addClass("lm__link").attr("href","#").append(t.modelName),$("<input></input>").attr("type","hidden").val(t.id)))}),t(i,n)}else $("#book-machine-list-2").hide(),$("#book-machine-list-1").hide()})}})}function n(e,t){var a=null;return $.each(e,function(e,n){n.id.toString()==t.toString()&&(a=n)}),a}function r(e,t){var a=n(e,t),r=$("#book-service-detail-machine").parent();null!=a?(r.show(),$("#book-service-detail-machine").html(""),$("#book-service-detail-machine").append($("<h2></h2>").addClass("heading-title-2").append("Vald maskin")),$("#book-service-detail-machine").append($("<h3></h3>").addClass("lm__bold-title").append(a.modelName)),$("#book-service-detail-machine").append($("<p></p>").append($("<span></span>").addClass("lm__bold-title").append("Serienr"),a.serialNumber)),$("#book-service-detail-machine").append($("<p></p>").append($("<span></span>").addClass("lm__bold-title").append("Regnr"),a.registerNumber)),r.find("p > input[name=BrandAndModel]").val(a.modelName),r.find("p > input[name=SerialNumber]").val(a.serialNumber),r.find("p > input[name=RegisterNumber]").val(a.registerNumber)):(r.hide(),r.find("p > input[name=BrandAndModel]").val(""),r.find("p > input[name=SerialNumber]").val(""),r.find("p > input[name=RegisterNumber]").val(""))}function i(){var e=$("#booking-service-send-faild").val();""!=e&&void 0!=e&&alert(e)}var o=null,l=function(){$(".maskin-type .showcase .dropdown li a").click(function(){$("#book-service-detail-machine").parent().hide(),$("#book-machine-list-1").hide(),$("#book-machine-list-2").hide(),$("#book-service-loading").show(),a()})},s=function(){$("#book-machine-list-2 > .address-sections > select").change(function(){null!=o&&o.length>0&&r(o,$(this).val())})},d=function(){return i()},c=function(){l(),s(),d()};return{Init:c}}();$(function(){var e=function(){var e=$(".lm__accordion-wrapper .lm__accordion-link"),t=$(".lm__accordion-wrapper .lm__accordion-content"),a=function(){e.each(function(){$(this).click(function(){$(this).hasClass("active")?$(this).next().slideUp("fast",function(){$(this).prev().removeClass("active")}):(t.slideUp("fast",function(){$(this).prev().removeClass("active")}),$(this).next().slideDown("fast",function(){$(this).prev().addClass("active")}))})})};return{init:function(){return a(),!1}}};$(document).ready(function(){var t=new e;t.init()})}),$(function(){var e=function(){$(".choose-user-type .lm__radio input[name='user-type']"),$(".user-type__sub-types"),$(".sub-type .lm__checkbox input[type='checkbox']");return{init:function(){return!1}}};$(document).ready(function(){var t=new e;t.init()})}),$(function(){var e=function(){var e=$(".customer-id-block .lm__block-box .parent-checkbox .lm__checkbox input"),t=(e.parents(".lm__block-box").find(".sub-checkbox .lm__checkbox input"),$(".link-to-open-popup")),a=$(".lm__information-modal__wrapper .mask"),n=function(){e&&e.change(function(){var e=$(this),t=e.parents(".lm__block-box").find(".sub-checkbox"),a=t.find(".lm__radio input");return t&&a&&(e.is(":checked")?(a.parent().removeClass("sub-hidden"),$(a[0]).prop("checked",!0)):(a.parent().addClass("sub-hidden"),a.prop("checked",!1))),!1})},r=function(){t&&a&&(t.click(function(e){e.preventDefault();var t=$(this).parent().next();return t&&t.removeClass("hidden"),!1}),a.click(function(){$(this).parent().addClass("hidden")}))};return{init:function(){return n(),r(),!1}}};$(document).ready(function(){var t=new e;t.init()})}),$(function(){var e=function(){function e(){0===$("#term-of-use-no").length&&0===$("#term-of-use-yes").length||$("#term-of-use-no").click(function(){var e=$(".lm__main-content").find("#dialog-first-reject");e.fadeIn(),$(".back-to-term",e).click(function(){e.fadeOut()}),$(".reject",e).click(function(){var t=$(".lm__main-content").find("#dialog-reconfirm-reject");t.fadeIn(),e.fadeOut(),$(".back-to-term",t).click(function(){t.fadeOut()}),$(".reject",t).click(function(){t.fadeOut(),$("#rejectForm").submit()})})})}return{init:function(){e()}}};$(document).ready(function(){var t=new e;t.init()})}),jQuery.validator&&(jQuery.validator.addMethod("CustomerNumberNotMatch",function(e,t,a){return isValidate(a)},"Kundnumret du har angett finns inte registrerat hos Lantmännen för det organisationsnummer du har angett."),jQuery.validator.addMethod("CustomerNumberNotExist",function(e,t,a){return isValidate(a)},"Kundnumret finns inte registrerat hos Lantmännen."),jQuery.validator.addMethod("CustomerNumberActivated",function(e,t,a){return isValidate(a)},"Kundnumret och organisationsnumret  du har angett är redan aktiverat för ett konto i LM2."),jQuery.validator.addMethod("OrganisationNumberNotMatch",function(e,t,a){return isValidate(a)},"Organisationsnumret du har angett stämmer inte överens med kundnumret du har angett."),jQuery.validator.addMethod("OrganisationNumberActivated",function(e,t,a){return isValidate(a)},"Organisationsnumret och kundnumret du har angett är redan aktiverat för ett konto i LM2.")),jQuery(function(){ActiveFarmdayCustomer.init(),ActiveFarmdayCustomer.initEvent(),ActiveFarmdayCustomer.initValidateTermOfUseForm()});var ActiveFarmdayCustomer=ActiveFarmdayCustomer||function(){var e=function(){if($().validate&&$("#verifyCustomer").validate({errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{CustomerNumber:{required:!0,CustomerNumberNotMatch:"#CustomerNumberNotMatch",CustomerNumberNotExist:"#CustomerNumberNotExist",CustomerNumberActivated:"#CustomerNumberActivated"},OrganisationNumber:{required:!0,regex:/^\d{6}[-]{0,1}\d{4}$/,OrganisationNumberNotMatch:"#OrganisationNumberNotMatch",OrganisationNumberActivated:"#OrganisationNumberActivated"}},messages:{CustomerNumber:{required:"Du måste ange Kundnumret"},OrganisationNumber:{required:"Du måste ange Organisationsnumret",regex:"Organisationsnumret du har angett är av fel typ."}},highlight:function(e,t,a){$("div.errors-list").hide(),$("ul.errors-list").show(),$("li#p_"+$(e).attr("id")).show(),$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t),$("li#p_"+$(e).attr("id")).hide(),$("ul.errors-list").find('li[id^="p"]').is(":visible")===!1&&$("ul.errors-list").hide()},submitHandler:function(e){$("#loader").show(),$("#loader").parent().addClass("disabled"),e.submit()}}),$().validate){var e="True"===$("#CustomerNumberNotMatch").val()||"True"===$("#CustomerNumberNotExist").val()||"True"===$("#CustomerNumberActivated").val()||"True"===$("#OrganisationNumberNotMatch").val()||"True"===$("#OrganisationNumberActivated").val();e&&$("#verifyCustomer").valid()}},t=function(){$("#expandTermOfUse").click(function(){$(this).toggleClass("expanded").next().toggle()}),$(document).on("change","#acceptTerm",function(){$(this).is(":checked")?($(".success-icon").show().parent().next().html('Du har godkänt <a href="#" class="lm__link">användningsvillkoren</a> för LM<sup>2</sup>.'),$("#submitBtn").removeClass("disabled-btn"),$("#expandTermOfUse").toggleClass("expanded").next().toggle()):($(".success-icon").hide().parent().next().html('Du måste läsa och godkänna <a href="#" class="lm__link">användningsvillkoren</a> för att registrera ett LM<sup>2</sup>-konto'),$("#submitBtn").addClass("disabled-btn"))})},a=function(){$().validate&&$("#registerCustomer").validate({errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{ContractApplication:{required:!0},CopyOfIDDocuments:{required:!0},RegistrationCertificate:{required:!0},FirstName:{required:!0},SurName:{required:!0},Telephone:{regex:/^\+?(\d[\d-. ]+)?(\([\d-. ]+\))?[\d-. ]+\d$/},Mobile:{required:!0,regex:/^\+?(\d[\d-. ]+)?(\([\d-. ]+\))?[\d-. ]+\d$/},PersonNumber:{required:!0,regex:/^[0-9]{12}$/}},messages:{ContractApplication:{required:"Du måste bifoga ansökan om avtal för e-tjänster"},CopyOfIDDocuments:{required:"Du måste bifoga Kopia på ID-handlingar"},RegistrationCertificate:{required:"Du måste bifoga Registreringsbevis för ditt företag"},FirstName:{required:"Förnamn är obligatorisk"},SurName:{required:"Efternamn är obligatoriskt"},Telephone:{regex:"Ange en giltig telefonnummer"},Mobile:{required:"Mobilnr är obligatoriskt",regex:"Ange ett giltigt mobilnummer"},PersonNumber:{required:"Personnr är obligatoriskt",regex:"Personnr måste bestå av 12 siffror"}},highlight:function(e,t,a){$("div.errors-list").hide(),$("ul.errors-list").show(),$("li#p_"+$(e).attr("id")).show();var n=$(e).attr("type");"file"===n?$(e).parent().addClass(this.settings.errorElementClass).removeClass(t):$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){var n=$(e).attr("type");"file"===n?$(e).parent().removeClass(this.settings.errorElementClass).removeClass(t):$(e).removeClass(this.settings.errorElementClass).removeClass(t),$("li#p_"+$(e).attr("id")).hide(),$("ul.errors-list").find('li[id^="p"]').is(":visible")===!1&&$("ul.errors-list").hide()},errorPlacement:function(e,t){var a=t.attr("type");"file"===a?t.parent().after(e):t.after(e)}})};return{init:e,initEvent:t,initValidateTermOfUseForm:a}}();jQuery.validator&&void 0==jQuery.validator.regex&&jQuery.validator.addMethod("regex",function(e,t,a){return this.optional(t)||a.test(e)},"Please enter a valid value.");var ContactForm=ContactForm||function(){function e(){0!==$("#ContactForm").length&&$(document).ready(function(){var e={subject:"required",message:"required"},t={subject:"Du måste ange Ämne",message:"Du måste ange Meddelande"};"true"!==$("#loginFlag").val().toString().toLowerCase&&(e.name="required",e.email={required:!0,email:!0},e.customerNumber={required:!0,regex:/^(\d+)/},t.name="Du måste ange Ditt namn",t.email={required:"Du måste ange E-post",email:"Ange en giltig e-postadress"},t.customerNumber={required:"Du måste ange Kundnummer",regex:"Ange en giltig Kundnummer"}),$().validate&&(a=$("#ContactForm").validate({ignore:[],errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:e,messages:t,highlight:function(e,t,a){$("ul.errors-list").show(),$("li#li_"+$(e).attr("id")).show(),$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t),$("li#li_"+$(e).attr("id")).hide(),$("ul.errors-list").find('li[id^="li"]').is(":visible")===!1&&$("ul.errors-list").hide()}}),$("input[type=reset]").click(function(){a&&(a.resetForm(),$("ul.errors-list").hide(),$(".error").each(function(){$(this).removeClass("error")}))}))})}function t(){e()}var a=void 0;return{init:t}}();$(function(){ContactForm.init()}),$(function(){var e=function(){function e(e){var t=e.parent(),a=e.closest("section").attr("data-isFromCustomer");return{orderNo:t.attr("data-orderNo"),orderLine:t.attr("data-orderLine"),itemName:t.attr("data-itemName"),orderQuantity:t.attr("data-orderQuantity"),warehouse:t.attr("data-warehouse"),container:t.attr("data-container"),planedDeliveryDate:t.attr("data-planedDate"),isFromCustomer:a}}var t=$(".lm__carousel-block"),a=t.find(".lm__carousel__item a").not(".callendar"),n=$("#upcoming-detail"),r=$(".lm__block.agreement"),i=function(){a.on("click",function(t){t.preventDefault();var a=$(this),r=e(a);return $.ajax({type:"post",data:r,dataType:"html",url:"/api/upcomming-deliveries/get-detail",success:function(e){n.html(e),n=$("#upcoming-detail"),n.fadeIn()}}),!1})},o=function(){r.length>0&&r.each(function(){var e=$(this).find(".lm__news-item");e.each(function(){var t=$(this),a=t.find(">a");t.hasClass("open")&&t.find(".detail-information").slideDown("fast"),a.on("click",function(){var t=$(this),a=t.parent(),n=a.hasClass("open"),r=t.next();return e.removeClass("open").find(".detail-information").slideUp("fast"),n?(a.removeClass("open"),r.slideUp("fast")):(a.addClass("open"),r.slideDown("fast")),!1})})})};return{showInformation:function(){i()},toggleSidebar:function(){o()}}};$(document).ready(function(){$.fn.slick&&$(".lm__carousel-block .lm__carousel__content").slick({dots:!0,infinite:!1,speed:300,slidesToShow:3,slidesToScroll:3,responsive:[{breakpoint:1100,settings:{slidesToShow:1,slidesToScroll:1,variableWidth:!0,centerMode:!0,centerPadding:"40px",infinite:!0}},{breakpoint:640,settings:{slidesToShow:1,slidesToScroll:1,dots:!1,arrows:!1,variableWidth:!0,centerMode:!0,centerPadding:"40px"}}]});var t=new e;t.showInformation(),t.toggleSidebar()})}),$(function(){$.fn.datepicker&&($(".datepicker-blank-default").datepicker({onSelect:function(e){if($(this).is("#selectedDate")&&$(this).data("previous")!==e){var t=new TimeBookingPage;t.searchItems("",$("#resourceDrp").attr("data-value")),t.searchAvalibleSlotAction()}var a=$("#error-fromDate");if($(this).is("#fromDateTxt")){var n=$("#toDateTxt").val();1===validateDateValue(e,n)?a.show():validateDateValue(e,n)===-1?($("#toDateTxt").val(e),a.hide()):a.hide()}if($(this).is("#toDateTxt")){var r=$("#fromDateTxt").val();
1===validateDateValue(r,e)?a.show():a.hide()}},monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],firstDay:1,dateFormat:"yy-mm-dd",beforeShow:function(){if(setTimeout(function(){$(".ui-datepicker").css("z-index",5)},0),$(this).is("#toDateTxt")){var e=$("#fromDateTxt").val(),t=$("#toDateTxt").val();$(this).datepicker("option","minDate",new Date(e)),$("#toDateTxt").val(t)}$(this).is("#selectedDate")&&$(this).datepicker("option","minDate",new Date)}}).on("change",function(){var e=$(this),t=!/Invalid|NaN/.test(new Date(e.val()).toString()),a=/^\d\d\d\d-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$/gi.test(e.val());a&&t?e.next().hide():e.next().show()}),$(".datepicker-blank-dialog").datepicker({onSelect:function(e){if($(this).is("#selectedDate")&&$(this).data("previous")!==e){var t=new TimeBookingPage;t.searchItems("",$("#resourceDrp").attr("data-value")),t.searchAvalibleSlotAction()}var a=$("#error-fromDate");if($(this).is("#fromDateTxt")){var n=$("#toDateTxt").val();1===validateDateValue(e,n)?a.show():validateDateValue(e,n)===-1?($("#toDateTxt").val(e),a.hide()):a.hide()}if($(this).is("#toDateTxt")){var r=$("#fromDateTxt").val();1===validateDateValue(r,e)?a.show():a.hide()}},monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],firstDay:1,dateFormat:"yy-mm-dd",beforeShow:function(){if(setTimeout(function(){$(".ui-datepicker").css("z-index",9)},0),$(this).is("#toDateTxt")){var e=$("#fromDateTxt").val(),t=$("#toDateTxt").val();$(this).datepicker("option","minDate",new Date(e)),$("#toDateTxt").val(t)}$(this).is("#selectedDate")&&$(this).datepicker("option","minDate",new Date)}}).on("change",function(){var e=$(this),t=!/Invalid|NaN/.test(new Date(e.val()).toString()),a=/^\d\d\d\d-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$/gi.test(e.val());a&&t?e.next().hide():e.next().show()})),$(document).ready(function(){$(".expand-info").click(function(){var e=$($(this).parent().parent()),t=e.next();t.slideToggle(100),$(this).hasClass("expand-icon-plus")?($(this).removeClass("expand-icon-plus"),$(this).addClass("expand-icon-minus")):($(this).removeClass("expand-icon-minus"),$(this).addClass("expand-icon-plus"))}),TransportTypeChangeEvent()}),$(".showDialog").click(function(e){getAnnoncements($(this)),e.preventDefault()}),$(".table-transport > tbody > tr > td > a").click(function(e){submitForm($(this).html(),$(this).attr("data-value")),e.preventDefault()}),$(".search-customerNr").click(function(e){submitForm($(this).attr("data-customerNr"),$(this).attr("data-value")),e.preventDefault()}),$(document).on("click",".datepicker-container",function(){console.dir("parent clicked"),$(this).find("input").focus()})});var validateDateValue=function(e,t){var a=new Date(e),n=new Date(t),r=6048e5;return n.getTime()-a.getTime()>r?1:n.getTime()-a.getTime()<0?-1:0},setToDateByFromDate=function(e,t){var a=new Date(e),n=new Date(t);a.getTime()>n.getTime()},TransportTypeChangeEvent=function(){$("#search-transport-type > ul > li > a").click(function(){var e=$(this).parent().attr("data-value"),t="Ange "+e.toLowerCase();$("input[name='Category']").val(e),$("input[name= 'SearchText']").attr("placeholder",t);var a=$("input[name= 'FromDate']"),n=$("input[name= 'ToDate']");"Kundnummer"===e||"Lastbil"===e?(a.prop("disabled",!1),n.prop("disabled",!1),a.parent().hasClass("disabled")&&a.parent().removeClass("disabled"),n.parent().hasClass("disabled")&&n.parent().removeClass("disabled")):(a.prop("disabled",!0),n.prop("disabled",!0),a.val(""),n.val(""),a.parent().addClass("disabled"),n.parent().addClass("disabled"))})};window.validation={phoneSE:function(e){return e=e.replace(/\s+/g,""),e.match(/^(\+46)\d{6,}$/)},mobileSE:function(e){return e=e.replace(/\s+/g,""),e.match(/^(\+46)\d{9}$/)},zipCode:function(e){return e=e.replace(/\s+/g,""),e.match(/^(\d{5}$)/)},personNumber:function(e){return e=e.replace(/\s+/g,""),e.match(/^\d{12}$/)},swedishDate:function(e){var t=/^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})$/;return e.match(t)&&"Invalid Date"!=new Date(e)}},window.validationMessage={firstName:{required:"Du måste ange Förnamn"},lastName:{required:"Du måste ange Efternamn"},phoneSE:{valid:"Ange ett korrekt telefonnummer"},mobileSE:{required:"Du måste ange Mobilnr",valid:"Ange ett korrekt mobilnummer"},zipCode:{required:"Postnumret ska bestå av 5 siffror",valid:"Postnumret ska bestå av 5 siffror"},email:{required:"Du måste ange E-post",valid:"Ange en giltig e-postadress"},personNumber:{valid:"Personnumret ska bestå av 12 siffror"},swedishDate:{required:"Du måste ange ett giltigt datum",valid:"Du måste ange ett giltigt datum"}},$(function(){jQuery.validator&&($.validator.addMethod("phoneSE",function(e,t){return this.optional(t)||window.validation.phoneSE(e)},window.validationMessage.phoneSE.valid),$.validator.addMethod("mobileSE",function(e,t){return window.validation.mobileSE(e)},window.validationMessage.mobileSE.valid),$.validator.addMethod("zipCode",function(e,t){return this.optional(t)||window.validation.zipCode(e)},window.validationMessage.zipCode.valid),$.validator.addMethod("personNumber",function(e,t){return this.optional(t)||window.validation.personNumber(e)},window.validationMessage.personNumber.valid),$.validator.addMethod("swedishDate",function(e,t){return window.validation.swedishDate(e)},window.validationMessage.swedishDate.valid))}),jQuery(function(){DeliveryAssuranceModule.init()});var DeliveryAssuranceModule=DeliveryAssuranceModule||function(){var e,t,a,n,r,i,o,l=0,s=0,d=function(){return{supplier:$("#dialog_CustomerNumber").val(),lorryType:$("#dialog_LorryType").val(),deliveryAddressId:$("#dialog_DeliveryAddress").val(),quantity:$("#dialog_Quantity").val(),deliveryDate:$("#dialog_DeliveryDate").val(),itemId:$("#dialog_Article").val()}},c=function(e,t){var a=$(t).val();$(e).prev().find("li").each(function(e,t){var n=$(t).attr("data-value");n===a&&$(t).find("a").trigger("click")})},u=function(){$("#dialog_Quantity").val($("#Quantity").val()),$("#dialog_DeliveryDate").val($("#DeliveryDate").val()),c("#dialog_LorryType","#LorryType"),c("#dialog_DeliveryAddress","#DeliveryAddress"),c("#dialog_Article","#Article")},p=function(e,t){$("#confirmDelete").removeClass("hidden"),$("#btnYes").unbind().click(function(){$("#confirmDelete").addClass("hidden"),e()}),$("#btnNo").unbind().click(function(){$("#confirmDelete").addClass("hidden"),t()})},m=function(e,t){$("#informationDialog").find("#dialogTitle").html(e),$("#informationDialog").find("#dialogContent").html(t),$("#informationDialog").removeClass("hidden")},h=function(){$("#changeNotAvailable").removeClass("hidden")},f=function(e,t,a,n){p(function(){var r=$(e).parents(".deliveryTableContainer").addClass("disabled").find(".loader-wrapper");r.show(),$.ajax({dataType:"json",type:"post",url:"/api/delivery-assurance/delete",data:{ioNumber:a,lineNumber:n},cache:!1,success:function(a){if(a.success){var n=parseInt($(t).val());!isNaN(n)&&n>=1&&(n-=1,$(t).val(n)),$(e).parents("tr").remove()}else m("",a.message)},error:function(e,t,a){m("",a.toString())},complete:function(e){r.hide().parents(".deliveryTableContainer").removeClass("disabled")}})},function(){})},v=function(e){var t="",a="",n=0;if($("."+e).each(function(){if($(this).is(":checked")){n++;var e=$(this).val();if(e){var r=e.split(";");null!=r&&(t+=r[0]+"|",a+=r[1]+"|")}}}),0===n)return void alert("Du måste först välja rader");""!==t&&(t=t.slice(0,-1)),""!==a&&(a=a.slice(0,-1));var r="/api/pdfhandler/generatemultipdf?a={ioNumber}&l={lineNumber}&resync=true";r=r.replace("{ioNumber}",t),r=r.replace("{lineNumber}",a),window.open(r,"_blank")},g=function(e,t){$.ajax({dataType:"json",type:"post",url:"/api/delivery-assurance/get-warehouse",data:{action:$("#Action").val(),customerNumber:$("#dialog_CustomerNumber").val(),itemName:t,deliveryDateStr:$(e).val()},cache:!1,success:function(e){e.warehouses&&($(".warehouseDropdown").html(""),$.each(e.warehouses,function(e,t){$(".warehouseDropdown").append('<li data-value="'+t.Key+'"><a href="javascript:void(0)">'+t.Value+"</a></li>")}),setDropdown($(".warehouseDropdown").parents("ul.lm__form-dropdown"),"type-3"),$("#warehouseList").find(".showcase .dropdown li a").click(function(){var e=$(this).parents(".showcase").find("input.form-element"),t=e.attr("id");$("#deliveryAssuranceForm").validate().element("#"+t)})),e.depaAvtals},error:function(e,t,a){m("",a.toString())},complete:function(e){}})},b=function(){$().validate&&$("#deliveryAssuranceForm").validate({ignore:[],errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{Quantity:{required:!0,max:39,min:1},Torkat:{required:!0},Red:{required:!0},Straforkortat:{required:!0},Slam:{required:!0},HarvestYear:{required:!0},DeliveryType:{required:!0},DeliveryAddress:{required:!0},DeliveryDate:{required:!0,date:!0},DepaAvtal:{required:function(e){return"Depa"===$('input[name="DeliveryType"]:checked').val()}},Article:{required:!0},Warehouse:{required:function(e){return"1"==s&&!$("#warehouseList").hasClass("hidden")&&!$("#Gardshamtning").is(":checked")}},Gardshamtning:{required:function(e){return 0===$('input[name="TermAndCondition"]:checked').length}},TermAndCondition:{required:function(e){return 0===$('input[name="Gardshamtning"]:checked').length}}},messages:{Quantity:{required:"Du måste ange Kvantitet (ton)",max:"Vänligen ange ett värde mellan 1 och 39",min:"Vänligen ange ett värde mellan 1 och 39"},Torkat:{required:"Du måste ange Varmluftstorkat"},Red:{required:"Du måste ange RED"},Straforkortat:{required:"Du måste ange Stråförkortning"},Slam:{required:"Du måste ange Slammat"},HarvestYear:{required:"Du måste ange Skördeår"},DeliveryType:{required:"Du måste ange Överleverans"},DeliveryAddress:{required:"Du måste ange Leveransadress"},DeliveryDate:{required:"Du måste ange Leveransdatum",date:"Var vänlig ange ett giltigt datum"},DepaAvtal:{required:"Inget depåavtal valt. Om vald leveranstyp är Depåavtal behöver ett depåavtal också väljas från listan."},Article:{required:"Du måste ange Artikel"},Warehouse:{required:"Du måste ange Mottagningsplats"},Gardshamtning:{required:"Du måste ange Transportsätt"},TermAndCondition:{required:""}},highlight:function(e,t,a){$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t)},errorPlacement:function(e,t){var a=$(t).attr("type");"radio"===a?t.parent("div.lm__radio").parent().before(e):t.after(e)},submitHandler:function(e){$("#loader").show(),$("#loader").parent().addClass("disabled"),1===i&&1===o&&alert("Det finns depåavtal på vald artikel. Ändra Överleverans till Depåavtal eller bekräfta ditt val av spontanleverans genom att klicka på knappen Nästa en gång till."),e.submit()}}),$().validate&&$("#deliveryAssuranceFormStep2").validate({ignore:[],errorElementClass:"error",errorClass:"error-item",errorElement:"span",rules:{noOfNew:{required:function(e){return"1"===$('input[name="createNew"]:checked').val()},digits:!0}},messages:{noOfNew:{required:"Du måste ange en siffra",digits:"Ange endast siffror"}},highlight:function(e,t,a){$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t)}})},w=function(){$("#Gardshamtning").change(function(){$(this).is(":checked")&&($('input[name="TermAndCondition"]:radio').prop("checked",!1),$("#lorryType").removeClass("hidden"),"1"!=l&&$("#warehouseList").addClass("hidden"),$("#deliveryAssuranceForm").validate().element("#Warehouse"),$("#deliveryAssuranceForm").validate().element("#DeliveryDate"))}),$('input[name="TermAndCondition"]:radio').change(function(){$(this).is(":checked")&&($("#Gardshamtning").prop("checked",!1),$("#lorryType").addClass("hidden"),"1"!=l&&$("#warehouseList").removeClass("hidden"),$("#deliveryAssuranceForm").validate().element("#Gardshamtning"),$("#deliveryAssuranceForm").validate().element("#DeliveryDate"),$("#deliveryAssuranceForm").validate().element("#Warehouse"))}),$('input[name="DeliveryType"]:radio').change(function(){var e=$('input[name="DeliveryType"]:checked').val();"Depa"===e?($("#depaAvtal").removeClass("hidden"),2!==o&&(o=0)):"Spon"===e&&($("#depaAvtal").addClass("hidden"),1===i&&2!==o&&(o=1))}),$('input[name="createNew"]:checkbox').change(function(){$("#noOfNew").val(""),$(this).is(":checked")?$("#noOfNew").parent().show():($("#noOfNew").parent().hide(),$("#createPdf").prop("disabled",!1))}),$("#approveTerm").change(function(){$(this).is(":checked")?$("#btnSubmitDelivery").addClass("reverse-state").removeClass("disabled"):$("#btnSubmitDelivery").addClass("disabled").removeClass("reverse-state")}),$(".cbxApproveDelAss").change(function(){$(".cbxApproveDelAss").is(":checked")?$("#btnApprove").addClass("reverse-state").removeClass("disabled"):$("#btnApprove").addClass("disabled").removeClass("reverse-state")}),$(".cbxToPrintDeliveried").change(function(){$(".cbxToPrintDeliveried").is(":checked")?$("#btnToPrintDeliveried").removeClass("disabled"):$("#btnToPrintDeliveried").addClass("disabled")}),$(".cbxToPrintConfirmed").change(function(){$(".cbxToPrintConfirmed").is(":checked")?$("#btnToPrintConfirmed").removeClass("disabled"):$("#btnToPrintConfirmed").addClass("disabled")}),$("#noOfNew").blur(function(){var e=parseInt($(this).val());if(!isNaN(e)&&e>0){var t=$("#createPdf");t.prop("checked",!1),t.prop("disabled",!0)}}),$("#openCalculateFee").click(function(){u(),$("#calculateFeeDialog").removeClass("hidden")}),$("#calculateFree").click(function(){var e=d();$("#calculateFeeDialog").find(".loader-wrapper").show(),$.ajax({url:"/api/deliveryfee/caluculate",type:"POST",data:{supplier:e.supplier,lorryType:e.lorryType,deliveryAddressId:e.deliveryAddressId,quantity:e.quantity,deliveryDate:e.deliveryDate,itemId:e.itemId},success:function(e){$("#calculateResult").html(e)},complete:function(e){$("#calculateFeeDialog").find(".loader-wrapper").hide()}})}),$("#clearBtn").click(function(){$("#a_deliveryAddress").html("-- Välj leveransadress --"),$("#DeliveryAddress").val(""),$("#DeliveryDate").val(""),$("#a_article").html("-- Välj artikel --"),$("#Article").val(""),$("#Quantity").val(""),$("#a_HarvestYear").html(""),$("#HarvestYear").val(""),$("#a_Warehouse").html("-- Välj mottagningsplats --"),$("#Warehouse").val(""),$(".warehouseDropdown").html(""),$("#a_LorryType").html("-- Välj transportsätt --"),$("#LorryType").val(""),$('input[name="DeliveryType"]').prop("checked",!1),$("input[name='Torkat']").prop("checked",!1),$("input[name='Red']").prop("checked",!1),$("input[name='Straforkortat']").prop("checked",!1),$("input[name='Slam']").prop("checked",!1),$("input[name='TermAndCondition']").prop("checked",!1),$("#Gardshamtning").prop("checked",!1),$("textarea[name='OtherInfo']").val(""),$("#deliveryAssuranceForm").validate().resetForm(),$("#depaAvtal").addClass("hidden"),$("#lorryType").addClass("hidden"),"1"!=l&&$("#warehouseList").addClass("hidden")}),$("#deliveryAssuranceForm").find(".showcase .dropdown li a").click(function(){var e=$(this).parents(".showcase").find("input.form-element"),t=e.attr("id");$("#deliveryAssuranceForm").validate().element("#"+t)})},y=function(){var o=parseInt($("#preDaysDelivery").val()),d=parseInt($("#postDaysDelivery").val());if(!isNaN(o)&&!isNaN(d)){e=GroCommon.dateFromISO($("#reqDate").val()),t=GroCommon.dateFromISO($("#reqDate").val()),t.setHours(0,0,0,0),t.setDate(e.getDate()+o),a=GroCommon.dateFromISO($("#reqDate").val()),a.setHours(23,59,59,999),a.setDate(e.getDate()+d),n=GroCommon.dateFromISO($("#harvestPeriodStart").val()),r=GroCommon.dateFromISO($("#harvestPeriodEnd").val()),l=$("#IsInternal").val(),s=$("#EnabledWarehouse").val();var c=parseInt($("#numberOfDepaAvtal").val());isNaN(o)||(c>1?($('input[name="DeliveryType"]:radio').each(function(e,t){var a=$(t).val();"Depa"===a&&$(t).prop("checked",!0)}),i=1):($('input[name="DeliveryType"]:radio').each(function(e,t){var a=$(t).val();"Depa"===a&&($(t).prop("checked",!1),$(t).prop("disabled",!0)),"Spon"===a&&$(t).prop("checked",!0)}),i=0)),$("#deliveryAssuranceForm .dropdown li.selected, #calculateFeeDialog .dropdown li.selected").each(function(e,t){var a=$(t).find("a").html();$(t).parent("ul").prev("a").html(a)})}},C=function(){$.fn.datepicker&&$(".delivery-datepicker").datepicker({defaultDate:new Date,onSelect:function(e){$(this).data("previous")!==e&&$("#deliveryAssuranceForm").validate().element("#DeliveryDate")&&g(this,$("#Article").val())},monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],firstDay:1}).on("change",function(){var e=$(this),t=!/Invalid|NaN/.test(new Date(e.val()).toString()),a=/^\d\d\d\d-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$/gi.test(e.val());$("#deliveryAssuranceForm").validate().element("#DeliveryDate"),a&&t&&g(this,$("#Article").val())})},D=function(){jQuery.validator&&(jQuery.validator.addMethod("dateHigherThanToday",function(e,t){var a=new Date,n=$('input[id="Gardshamtning"]:checked').val();if("1"===n){if(!t)return!1;var r=GroCommon.dateFromISO(t.value);r.setHours(0,0,0,0);var i=a.getHours();if(a.setHours(0,0,0,0),r<a)return!1;if(r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()&&r.getDate()===a.getDate()&&i>9)return!1}return!0},"Leveransdatum kan inte vara dagens datum eller tidigare."),t&&e&&jQuery.validator.addMethod("dateHarvest206",function(t,a){if(this.optional(a))return!0;var n=GroCommon.dateFromISO(a.value),r=(new Date).setDate((new Date).getDate()+1);return r<=n&&n<=e},$.validator.format("Vänligen ange ett datum mellan {0} och {1}.",t?t.toShortDateString():"",e?e.toShortDateString():"")),n&&r&&jQuery.validator.addMethod("dateHarvestRange",function(e,t){if(this.optional(t))return!0;var a=GroCommon.dateFromISO(t.value);return a>=n&&a<=r},$.validator.format("Vänligen ange ett datum inom skördeperioden, dvs {0}/{1} - {2}/{3}.",n.getDate().toString(),(n.getMonth()+1).toString(),r.getDate().toString(),(r.getMonth()+1).toString())),t&&a&&jQuery.validator.addMethod("daterange",function(e,n){if(this.optional(n))return!0;var r=GroCommon.dateFromISO(n.value);return t<=r&&r<=a},$.validator.format("Vänligen ange ett datum mellan {0} och {1}.",t?t.toShortDateString():"",a?a.toShortDateString():"")))},k=function(){C(),y(),w(),D(),b()};return{init:k,deleteDeliveryAssurance:f,showChangeNotAvailableDiglog:h,printMultiLines:v,getWarehouseList:g}}(),VerticalTable=VerticalTable||function(){function e(e){var t,a,i,o,l,s=e.querySelectorAll(".responsive-table th"),d=1,c=e.querySelectorAll(".responsive-table td");if(c.length>0)for(n=0;n<c.length;n+=1){if(d>s.length&&(d=1),r=c[n],1===d){var u=document.createElement("div");u.className="table-expand-info expand-icon-plus responsive-header",r.parentNode.insertBefore(u,r)}t=e.querySelector(".responsive-table th:nth-of-type("+d+")"),i=t.className,a=t.textContent,i.indexOf("action-control")>=0||i.indexOf("header-desktop-only")>=0||(o=document.createElement("td"),o.className="responsive-header "+i,o.innerHTML=a,r.parentNode.insertBefore(o,r)),d+=1}l=$(".responsive-table .collapsed-row"),l.addClass("hidden")}function t(){var e=window.innerWidth,t=document.getElementsByClassName("responsive-table"),a=$(".responsive-table .collapsed-row");if(e<=768){if(!i){for(n=0;n<t.length;n+=1)r=t[n],r.classList.add("mobile"),a.addClass("hidden"),$(".table-expand-info").removeClass("expand-icon-minus"),$(".table-expand-info").addClass("expand-icon-plus");i=!0}}else{for(n=0;n<t.length;n+=1)r=t[n],r.classList.remove("mobile"),a.removeClass("hidden"),$(".table-expand-info").removeClass("expand-icon-plus"),$(".table-expand-info").addClass("expand-icon-minus");i=!1}}function a(){var a=document.querySelectorAll("table.responsive-table");if(a.length>0)for(var n=0;n<a.length;n++)e(a[n]);t(),$(window).on("resize",function(){t()})}var n,r,i=!1;return{init:a}}();$(function(){VerticalTable.init()}),$(document).ready(function(e){$(".table-expand-info").click(function(){var e=$($(this).parent()),t=e.find(".collapsed-row");$(this).hasClass("expand-icon-plus")?($(this).removeClass("expand-icon-plus"),$(this).addClass("expand-icon-minus"),t.removeClass("hidden")):($(this).removeClass("expand-icon-minus"),$(this).addClass("expand-icon-plus"),t.addClass("hidden"))}),$(".table-expand-info").next().click(function(){var e=$($(this).parent()),t=e.find(".table-expand-info")[0],a=e.find(".collapsed-row");$(t).hasClass("expand-icon-plus")?($(t).removeClass("expand-icon-plus"),$(t).addClass("expand-icon-minus"),a.removeClass("hidden")):($(t).removeClass("expand-icon-minus"),$(t).addClass("expand-icon-plus"),a.addClass("hidden"))})}),jQuery(function(){PurchaseAgreement.init(),PriceAlertPage.init(),DryingAgreement.init(),GrainPricePage.init(),PoolAndDepaAgreement.init()});var PurchaseAgreement=PurchaseAgreement||function(){var e=[],t="#agreementForm",a=function(){jQuery.validator&&(jQuery.validator.addMethod("exact_date",function(e,t){var a=!0,n=e.split("-");if(3==n.length){var r=new Date(e);a=r.getFullYear()==n[0]&&r.getMonth()==parseInt(n[1])-1&&r.getDate()==n[2]}return this.optional(t)||a},"Var vänlig ange ett giltigt datum"),jQuery.validator.addMethod("lowerPriceMustLessUpperPrice",function(e,t){var a=parseInt($("#UpperPrice").val()),n=parseInt($("#LowerPrice").val());return this.optional(t)||!isNaN(a)&&!isNaN(n)&&a>=n},"Undre pris måste vara lägre än Övre pris"),jQuery.validator.addMethod("atLeastOnePriceMustBeInput",function(e,t){var a=parseInt($("#UpperPrice").val()),n=parseInt($("#LowerPrice").val());return isNaN(n)&&(n=0),this.optional(t)||!isNaN(a)&&!isNaN(n)&&(0!==a||0!==n)},"Något pris kanske ska anges?"),jQuery.validator.addMethod("optinalLowerPriceMustBeGreatMinValue",function(e,t){var a=parseInt($("#PriceLow").val()),n=parseInt($("#LowerPrice").val());return"PrissakringDepaavtal"===$("#AgreementType").val()?this.optional(t)||!isNaN(a)&&!isNaN(n)&&!(n>=0&&n<a):this.optional(t)||!isNaN(a)&&!isNaN(n)&&!(n>0&&n<a)},"Undre pris understiger. Pris anges i kr/ton"),jQuery.validator.addMethod("agreementDateMin",function(e,t){var a=new Date,n=GroCommon.dateFromISO(t.value);return n.setHours(n.getHours()+23),this.optional(t)||n>=a},"Du kan inte ange datum som är lägre än dagens datum"),jQuery.validator.addMethod("agreementDateMax",function(e,t){var a=(new Date,new Date);a.setDate((new Date).getDate()+60);var n=GroCommon.dateFromISO(t.value);return n.setHours(n.getHours()+23),this.optional(t)||n<=a},"Uppdraget får ej vara giltigt i mer än 60 dagar"))},n=function(){var e=GroCommon.parseInt($("#PriceLow").val()),a=GroCommon.parseInt($("#CommitQuantityMin").val());$().validate&&$(t).validate({ignore:[],errorElementClass:"error",errorClass:"error-item",errorElement:"span",onkeyup:!1,rules:{UpperPrice:{required:!0,digits:!0,atLeastOnePriceMustBeInput:!0,min:e},LowerPrice:{required:function(e){return"PrissakringDepaavtal"===$("#AgreementType").val()},digits:!0,lowerPriceMustLessUpperPrice:!0,optinalLowerPriceMustBeGreatMinValue:!0},CommitQuantity:{required:!0,digits:!0,min:a},DeliveryMode:{required:!0},PriceWatchEndDate:{date:!0,exact_date:!0,agreementDateMin:!0,agreementDateMax:!0},TargetAction:{required:!0}},messages:{UpperPrice:{required:"Du måste ange en siffra",digits:"Ange endast siffror",atLeastOnePriceMustBeInput:"Något pris kanske ska anges?",min:"Övre pris understiger "+e+" kr. Pris anges i kr/ton"},LowerPrice:{required:"Du måste ange en siffra",digits:"Ange endast siffror",lowerPriceMustLessUpperPrice:"Undre pris måste vara lägre än Övre pris",optinalLowerPriceMustBeGreatMinValue:"Undre pris understiger "+e+" kr. Pris anges i kr/ton."},CommitQuantity:{required:"Kvantitet ton måste anges",digits:"Kvantitet ton anges numeriskt",min:"Du kan inte ange kvantitet som är mindre än "+a},DeliveryMode:{required:"Leveranssätt måste väljas"},PriceWatchEndDate:{date:"Var vänlig ange ett giltigt datum"},TargetAction:{required:"Du måste ange Resultat av prisbevakning"}},highlight:function(e,t,a){$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t)},errorPlacement:function(e,t){var a=$(t).attr("type");"radio"===a?t.parent("div.lm__radio").parent().before(e):t.after(e)},submitHandler:function(e){$("#approveAgreementTerm").is(":checked")&&e.submit()}})},r=function(){var e=parseInt($("#CommitQuantity").val()),t=parseInt($("#UpperPrice").val()),a=parseInt($("#LowerPrice").val()),n=""!=$("#AgreementAvtal").val()&&($('input[name="DeliveryMode"]:checked').length>0||0===$('input[name="DeliveryMode"]:radio').length)&&($('input[name="TargetAction"]:checked').length>0||0===$('input[name="TargetAction"]:radio').length)&&""!=$("#AgreementPeriod").val()&&""!=$("#PriceWatchEndDate").val()&&(!isNaN(e)&&e>=12||0===$("#CommitQuantity").length)&&!isNaN(t)&&t>=500&&!isNaN(a)&&a<=t&&a>=500;n?$("#move-to-step2").addClass("reverse-state").removeClass("disabled"):$("#move-to-step2").addClass("disabled").removeClass("reverse-state")},i=function(e){var a=$(e).parents(".showcase").find("input.form-element"),n=a.attr("id");$(t).validate().element("#"+n),r()},o=function(){$.fn.datepicker&&$("#PriceWatchEndDate").datepicker({defaultDate:new Date,onSelect:function(e){$(this).data("previous")!==e&&($(t).validate().element("#PriceWatchEndDate"),r())},monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],firstDay:1,showOtherMonths:!0,selectOtherMonths:!0,dateFormat:"yy-mm-dd",beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",5)},0)}}).on("change",function(){$(t).validate().element("#PriceWatchEndDate"),r()})},l=function(e,t,a,n,i,o){if(e){$("#agreement-loader").show(),$("#AgreementId").val(e),$("#product-item-name").html(i),$("#grain-type").html(n);var l="/api/agreement/get-protect-agreement";$.ajax({dataType:"json",type:"get",url:l,data:{productItemId:t,priceAreaId:a,grainType:n},cache:!1,success:function(e){$("#agreement-detail").show(),e&&($("#price-periods").html($.parseHTML(e.periodsView)),setDropdown($("#price-periods"),"type-2"),$("#price-periods .showcase a.period-item").each(function(e,t){$(t).click(function(){GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(t)),r()})}),o())},error:function(e,t,a){},complete:function(e){$("#agreement-loader").hide()}})}},s=function(e,t){var a;return e.find("li").each(function(e,n){var r=$(n).attr("data-value");if(r===t)return a=$(n).find("a").html(),!1}),a},d=function(e){var t=e.indexOf(";"),a=e.substring(t+1,t+9),n=parseInt(a.substring(0,4)),r=parseInt(a.substring(4));return isNaN(n)||isNaN(r)?"":r<701?n-1:n},c=function(e,t){$("#agreement-loader").show(),$("#product-item-name").html(s($(".productDropdown .dropdown"),t)),$.ajax({dataType:"json",type:"get",url:"/api/agreement/get-grain-type-spot-agreement",data:{priceAreaId:e,productItemId:t},cache:!1,success:function(e){$("#agreementForm .grainTypeDropdown .dropdown").html(""),$("#agreementForm .grainTypeDropdown > .showcase > a").html("Välj sort"),$("#agreementForm #GrainType").val(""),$("#grain-type").html(""),e.length>0&&($.each(e,function(e,t){$(".grainTypeDropdown .dropdown").append('<li data-value="'+t.GrainName+'"><a href="javascript:void(0)">'+t.GrainName+"</a></li>")}),setDropdown($(".grainTypeDropdown"),"type-3"),$("#agreementForm .grainTypeDropdown").find(".showcase .dropdown li a").click(function(){i(this),GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(this)),$("#grain-type").html(s($(".grainTypeDropdown .dropdown"),$(this).parent().attr("data-value"))),""!=$("#AgreementPeriod").val()&&$(".agreement-detail").removeClass("hidden")}),$("#agreementForm .grainTypeDropdown").parent().parent().removeClass("disabled")),$("#agreementForm .periodDropdown").parent().parent().addClass("disabled"),$(".agreement-detail").addClass("hidden"),r()},error:function(e,t,a){},complete:function(e){$("#agreement-loader").hide()}})},u=function(){function e(){$("#area-sort-overview").removeClass("hidden")}$("#UpperPrice").blur(function(){$(t).validate().element("#LowerPrice"),r()}),$("#approveAgreementTerm").change(function(){$(this).is(":checked")?$("#agreementSaveBtn").addClass("reverse-state").removeClass("disabled"):$("#agreementSaveBtn").addClass("disabled").removeClass("reverse-state")}),$("#agreementForm .showcase .dropdown a.agreement-item").each(function(t,a){$(a).click(function(){var t=$(a),n=t.attr("data-agreementid"),i=t.attr("data-productItemId"),o=t.attr("data-priceAreaId"),s=t.attr("data-grainType"),d=t.attr("data-productItemName");l(n,i,o,s,d,function(){GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(a)),r()}),e()})}),$("#agreementForm .agreement-element input").each(function(e,t){$(t).focusout(function(){GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(t)),r()})}),$('#agreementForm input[name="TargetAction"]:radio').change(function(){GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(this)),r()}),$('#agreementForm input[name="DeliveryMode"]:radio').change(function(){GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(this)),r()}),$("#move-to-step2").click(function(){if($().validate){var e=$(t).valid();e&&($("#span_Avtal").html(s($(".avtalDropdown .dropdown"),$("#AgreementAvtal").val())),$("#span_Groda").html($("#product-item-name").html()),$("#span_Sort").html($("#grain-type").html()),$("#span_Leveransperiod").html(s($(".periodDropdown .dropdown"),$("#AgreementPeriod").val())+" "+d($("#AgreementPeriod").val())),$("#span_UpperPrice").html($("#UpperPrice").val()),$("#span_UnderPrice").html($("#LowerPrice").val()),$("#span_Quantity").html($("#CommitQuantity").val()),$("#span_TransportType").html($('input[name="DeliveryMode"]:checked').prop("id")),$("#span_Prissakra").html($('input[name="TargetAction"]:checked').prop("id")),$("#span_AgreementDate").html($("#PriceWatchEndDate").val()),$("#pStep1").addClass("hidden"),$("#pStep2").removeClass("hidden"))}}),$("#move-to-step1").click(function(){$("#pStep2").addClass("hidden"),$("#pStep1").removeClass("hidden")}),$(t).find(".showcase .dropdown li a").click(function(){i(this),GroCommon.disableOrEnableElement("#agreementForm .agreement-element",$(this))}),$("#agreementForm .periodDropdown .dropdown a").click(function(){$(".agreement-detail").removeClass("hidden"),$("#lable_Period").html(s($(".periodDropdown .dropdown"),$(this).parent().attr("data-value")))}),$("a#agrement-info").click(function(){$("#agreement-introduce").removeClass("hidden")})},p=function(){$("#CommitQuantity, #UpperPrice, #LowerPrice").val(""),a(),n(),u(),o(),e=$(".agreement-element")};return{init:p,getProtectAgreement:l,getGrainTypesForSpotAgreement:c}}(),PriceAlertPage=PriceAlertPage||function(){var e=function(e,t){var a="{'id':'"+t+"'}";$.ajax({type:"POST",url:"/api/price-alert/DeletePriceWatch",dataType:"json",contentType:"application/json; charset=utf-8",data:a,success:function(t){t.isRemoved?$(e).remove():alert("Error")},error:function(e){}})},t=function(){$(".priceAlertDelete").on("click",function(t){var a=window.confirm("Är du säker på att du vill ta bort detta prisuppdraget ?");if(a){var n=$(this).attr("data-value"),r=$(this).parents("tr");e(r,n)}t.preventDefault()})},a=function(){t()},n=function(){a()};return{init:n}}(),GrainPricePage=GrainPricePage||function(){var e=function(e){var t=$("#price-period-result"),a="{'priceAreaId':'"+e+"'}";$("#loader").show(),$.ajax({type:"POST",url:"/api/price-grain/GetPricePeriodbyArea",contentType:"application/json; charset=utf-8",data:a,success:function(e){void 0==e.resultPricePeriods?t.html(e):(t.empty(),alert("Error")),$("#loader").hide()},error:function(){t.empty(),alert("Error"),$("#loader").hide()}})},t=function(){var t=$("#price-area-list .dropdown li a");t.on("click",function(t){var a=$(this).parent().attr("data-value");
e(a),t.preventDefault()})},a=function(){t()},n=function(){a()};return{init:n}}(),DryingAgreement=DryingAgreement||function(){var e=function(){$("#approveDryingAgreementTerm").change(function(){$(this).is(":checked")?($("#approveDryingAgreementTermInStep2").prop("checked",!0),$("#dryingBtnMoveToStep2, #dryingBtnMoveToStep3").addClass("reverse-state").removeClass("disabled")):($("#approveDryingAgreementTermInStep2").prop("checked",!1),$("#dryingBtnMoveToStep2, #dryingBtnMoveToStep3").addClass("disabled").removeClass("reverse-state"))}),$("#dryingBtnMoveToStep2").click(function(){$("#dryingStep1").addClass("hidden"),$("#dryingStep2").removeClass("hidden")}),$("#dryingBtnBackToStep1").click(function(){$("#dryingStep2").addClass("hidden"),$("#dryingStep1").removeClass("hidden")}),$("#generateDryingPdf").length>0&&$("#generateDryingPdf")[0].click()},t=function(){e()};return{init:t}}(),PoolAndDepaAgreement=PoolAndDepaAgreement||function(){var e=function(e){var t=$(e).parents(".showcase").find("input.form-element"),a=t.attr("id");$("#newPurchasingAgreementForm").validate().element("#"+a),i()},t=function(){$(".div-DeliveryMode").removeClass("disabled")},a=function(e,t){var a;return e.find("li").each(function(e,n){var r=$(n).attr("data-value");if(r===t)return a=$(n).find("a").html(),!1}),a},n=function(e){var t=e.indexOf(";"),a=e.substring(t+1,t+9),n=parseInt(a.substring(0,4)),r=parseInt(a.substring(4));return isNaN(n)||isNaN(r)?"":r<701?n-1:n},r=function(){$().validate&&$("#newPurchasingAgreementForm").validate({ignore:[],errorElementClass:"error",errorClass:"error-item",errorElement:"span",onkeyup:!1,rules:{CommitQuantity:{required:!0,digits:!0,min:12},DeliveryMode:{required:!0},ProductItemId:{required:!0},GrainType:{required:!0},AgreementPeriod:{required:!0}},messages:{CommitQuantity:{required:"Kvantitet ton måste anges",digits:"Kvantitet ton anges numeriskt",min:"Du kan inte ange kvantitet som är mindre än 12"},DeliveryMode:{required:"Transportsätt måste väljas"},ProductItemId:{required:"Gröda måste väljas"},GrainType:{required:"Sort måste väljas"},AgreementPeriod:{required:"Leveranssätt måste väljas"}},highlight:function(e,t,a){$(e).addClass(this.settings.errorElementClass).removeClass(t)},unhighlight:function(e,t,a){$(e).removeClass(this.settings.errorElementClass).removeClass(t)},errorPlacement:function(e,t){var a=$(t).attr("type");"radio"===a?t.parent("div.lm__radio").parent().before(e):t.after(e)},submitHandler:function(e){$("#approvePoolAgreementTerm").is(":checked")&&e.submit()}})},i=function(){var e=parseInt($("#CommitQuantity").val()),t=""!=$("#ProductItemId").val()&&""!=$("#GrainType").val()&&$('input[name="DeliveryMode"]:checked').length>0&&""!=$("#AgreementPeriod").val()&&!isNaN(e)&&e>=12;t?$("#btnMoveToStep2").addClass("reverse-state").removeClass("disabled"):$("#btnMoveToStep2").addClass("disabled").removeClass("reverse-state")},o=function(t,a){$("#agreement-loader").show(),$.ajax({dataType:"json",type:"get",url:"/api/agreement/get-grain-type",data:{priceAreaId:t,productItemId:a},cache:!1,success:function(t){$(".grainTypeDropdown .dropdown").html(""),$(".grainTypeDropdown > .showcase > a").html("Välj sort"),$("#GrainType").val(""),t.length>0&&($.each(t,function(e,t){$(".grainTypeDropdown .dropdown").append('<li data-value="'+t.GrainName+'"><a href="javascript:void(0)" onclick="PoolAndDepaAgreement.enableDeliveryMode()">'+t.GrainName+"</a></li>")}),setDropdown($(".grainTypeDropdown"),"type-3"),$(".grainTypeDropdown").find(".showcase .dropdown li a").click(function(){e(this)}),$(".grainTypeDropdown").parent().parent().removeClass("disabled")),i()},error:function(e,t,a){},complete:function(e){$("#agreement-loader").hide()}})},l=function(){$('#newPurchasingAgreementForm input[name="DeliveryMode"]:radio').change(function(){GroCommon.disableOrEnableElement("#newPurchasingAgreementForm .agreement-element",$(this)),i()}),$("#newPurchasingAgreementForm .periodDropdown .dropdown a").click(function(){GroCommon.disableOrEnableElement("#newPurchasingAgreementForm .agreement-element",$(this))}),$("#approvePoolAgreementTerm").change(function(){$(this).is(":checked")?$("#agreementSaveBtn").addClass("reverse-state").removeClass("disabled"):$("#agreementSaveBtn").addClass("disabled").removeClass("reverse-state")}),$("#btnMoveToStep2").click(function(){if($().validate){var e=$("#newPurchasingAgreementForm").valid();e&&($("#span_Groda").html(a($(".productDropdown .dropdown"),$("#ProductItemId").val())),$("#span_Sort").html(a($(".grainTypeDropdown .dropdown"),$("#GrainType").val())),$("#span_Period").html(a($(".periodDropdown .dropdown"),$("#AgreementPeriod").val())+" "+n($("#AgreementPeriod").val())),$("#span_Quantity").html($("#CommitQuantity").val()),$("#span_TransportType").html($('input[name="DeliveryMode"]:checked').prop("id")),$("#pStep1").addClass("hidden"),$("#pStep2").removeClass("hidden"))}}),$("#btnBackToStep1").click(function(){$("#pStep2").addClass("hidden"),$("#pStep1").removeClass("hidden")}),$("#newPurchasingAgreementForm").find(".showcase .dropdown li a").click(function(){e(this)}),$("#newPurchasingAgreementForm #CommitQuantity").blur(function(){i()})},s=function(){l(),r()};return{init:s,getGrainTypes:o,enableDeliveryMode:t}}();$(document).ready(function(){var e=new TimeBookingPage,t=new ListingBookingPage;e.init(),t.init(),$(document).trigger("enhance.tablesaw")});var blockUI=function(){$("#loader").show()},unBlockUI=function(){$("#loader").hide()},fillContentToModal=function(e,t,a,n){var r=$(e);r.find(".lm__wide-modal__title").html(t),r.find("p").append(a),r.find(".btn-ok").on("click",function(){r.addClass("hidden")}),void 0===n&&r.removeClass("hidden")},clearContentToModal=function(e){var t=$(e);t.find(".lm__wide-modal__title").html(""),t.find("p").html(""),t.find(".btn-ok").unbind("click")},fillContentToDeleteDialog=function(e,t){var a=$("#deleteDialog");a.find(".success-header-title").html(e),a.find("p").append(t),a.find(".btn-cancel").on("click",function(){a.hide()}),a.find(".btn-ok").on("click",function(){a.hide()}),a.show()},clearContentToDeleteDialog=function(){var e=$("#deleteDialog");e.find(".lm__wide-modal__title").html(""),e.find("p").html(""),e.find(".btn-ok").unbind("click"),e.find(".btn-cancel").unbind("click")},TimeBookingPage=function(){var clearResultTable=function(){$("#resultTable").html("")},extractForDropdown=function(e,t){for(var a=new Array,n=0;n<t.length;n++)a[a.length]='<li data-value="'+t[n].Value+'"><a href="#">'+t[n].Display+"</a></li>",1==t[n].IsSelected&&($("#"+e+"> a").html(t[n].Display),"resourceDrp"==e&&$("#"+e).attr("regNoMandatory",t[n].RegNoMandatory),$("#"+e).attr("data-value",t[n].Value));return a.join("")},searchCustomer=function(){clearResultTable(),$("#agrementDriedUnDried").hide();var searchString=$("#seachFieldTxt").val(),resourceValue=$("#resourceDrp").attr("data-value");if(""!=jQuery.trim(searchString)){var searchType=$("#search-option").attr("data-value"),loadOrUnlodValue=$("input[name='loadOrUnlodRad']:checked").val(),customerSearcType=$("input[name='companySelected']:checked").val();blockUI();var parameters="{'resourceGroupId':'"+resourceValue+"', 'searchString':'"+searchString+"', 'searchType':'"+searchType+"', 'loadOrUnlodValue':'"+loadOrUnlodValue+"', 'customerSearcType':'"+customerSearcType+"'}";$.ajax({type:"POST",url:"/api/time-booking/CustomerSearch",dataType:"json",contentType:"application/json; charset=utf-8",data:parameters,success:function(e){unBlockUI(),searchCustomerSuccess(e.customerResult)},error:function(e){unBlockUI()}})}var searchCustomerSuccess=function(response){var dialogHtml;if(500==response.Status)return clearContentToModal("#dialogArea"),dialogHtml=response.ErrorMessage+"<br/><br/>",void fillContentToModal("#dialogArea","Fel uppstod",dialogHtml);var customers="string"==typeof response.Customers?eval("("+response.Customers+")"):response.Customers;if(setCustomerInfo(customers),"9"===$("#search-option").attr("data-value")&&response.Ios.length>0&&(clearContentToModal("#dialogArea"),dialogHtml="<p>Inköpsordrar kopplade till kundnummer: "+response.Customers[0].CustomerNo+"</p>",dialogHtml+="<p>Klicka på någon av nedanstående inköpsordrar för att gå direkt till den</p><br/>",dialogHtml+='<table style="width: 580px; display: block; overflow-y: scroll; height: 300px;"><thead><tr><th>IONummer</th><th>Artikel</th><th>Kvantitet</th><th>Anläggning</th></tr></thead><tbody>',$.each(response.Ios,function(e,t){dialogHtml+='<tr><td><a href="?ion='+t.IONumber+'">'+t.IONumber+"</a></td><td>"+t.ItemName+"</td><td>"+t.Quantity+"</td><td>"+t.WarehouseName+"</td></tr>"}),dialogHtml+="</tbody></table>",fillContentToModal("#dialogArea","Välj inköpsorder nedan",dialogHtml)),null!==response.BookingOrder){if(void 0!=response.BookingOrder.Quantity&&null!==response.BookingOrder.Quantity&&$("#quantityTxt").val(response.BookingOrder.Quantity/1e3),null!==response.BookingOrder.DeliveryDate&&($("#selectedDate").val(new Date(parseInt(response.BookingOrder.DeliveryDate.substr(6))).toShortDateString()),$("#selectedDate").val().length<10&&$("#selectedDate").val((new Date).toShortDateString())),"5"===$("#search-option").attr("data-value")?(response.BookingOrder.Status>40?unblockUI():40==response.BookingOrder.Status?unblockUI():0==response.BookingOrder.DeliveryAssuranceConfirmed&&(clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Redan bokad","Obs! Bokning ej tillåten på denna inköpsorder! Leveransförsäkran saknas")),getIOResource(response.BookingOrder.Warehouse),searchItems("",$("#resourceDrp").attr("data-value"))):"7"!==$("#search-option").attr("data-value")&&"8"!==$("#search-option").attr("data-value")&&"6"!==$("#search-option").attr("data-value")||(getIOResource(response.BookingOrder.Warehouse),searchItems("",$("#resourceDrp").attr("data-value"))),null!==response.BookingOrder.ItemNumber&&""!=response.BookingOrder.ItemNumber){var dried="torkad",$articlesDrp=$("#articlesDrp");$("#agrementDriedUnDried").val(response.BookingOrder.Torkat?"Torkad":"Otorkad");var driedUnDried=$("#agrementDriedUnDried").val();response.BookingOrder.Torkat||(dried="otorkad");var searchString=new String(response.BookingOrder.ItemNumber+"-"+dried+"-"+response.BookingOrder.Sort);searchString=searchString.toLowerCase(),$("#articlesDrp > ul li").each(function(){$(this).attr("data-value").toLowerCase().indexOf(searchString)!=-1&&($articlesDrp.attr("data-value",$(this).attr("data-value")),$articlesDrp.find(">a").html($(this).find(">a").html()))})}$("div").data("Linenumber",response.BookingOrder.Linenumber)}null!==response.RegNo&&$("#IDReg").val(response.RegNo),validateRequiredFieldsForSearch()?($("#searchAvailbleSlotsBtn").parent().removeClass("disabled-btn"),searchAvailableSlots(),5==$("#search-option").attr("data-value")?$("#IDLevnr_StartValue").val($("#seachFieldTxt").val()):$("#IDLevnr_StartValue").val("")):($("#searchAvailbleSlotsBtn").parent().addClass("disabled-btn"),$("#IDLevnr_StartValue").val(""))},getIOResource=function(warehouse){var resourceListLoadSuccess=function(response,warehouseId){var resource=$("#resourceDrp");clearDropDown("resourceDrp","Välj anläggning"),clearDropDown("articlesDrp","Välj artikel");var resources="string"==typeof response?eval("("+response+")"):response;$(resource).find("> ul > li").append(extractForDropdown("resourceDrp",resources)),setDropdown($("#resourceDrp").parent(),"type3");for(var i=0;i<resources.length;i++)if(void 0!==warehouseId&&response[i].M3Id===warehouseId||void 0!==warehouseId&&response[i].Value===warehouseId){$(resource).attr("data-value",resources[i].Value),$(resource).find(">a").html(resources[i].Display);break}validateRequiredFieldsEvent(),searchItemEvent()};$.ajax({type:"POST",url:"/api/time-booking/LoadResourceGroupsOnIO",dataType:"json",contentType:"application/json; charset=utf-8",data:"{'warehouseId':'"+warehouse+"'}",async:!1,success:function(e){resourceListLoadSuccess(e.Resource,warehouse)},error:function(e){clearDropDown("resourceDrp","Välj anläggning"),clearDropDown("articlesDrp","Välj artikel"),clearDropDown("veichleTypeDrp","Välj fordon"),alert("Error")}})},setCustomerInfo=function(e){if(null!=e){var t=(new Array,e.length);1==t?($("#customerNo").val(e[0].CustomerNo),$("#customerName").val(e[0].Name),$("#IDEpost_StartValue").val(e[0].Email),$("#IDMobil_StartValue").val(e[0].MobileNo),$("#IDEpost").val(e[0].Email),$("#IDMobil").val(e[0].MobileNo),displayWarningAboutDemoCustomer(e[0].Name)):(clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Information saknas","Hittade ingen kund, avtal, transportorder eller sändningsorder med nr "+$("#seachFieldTxt").val()+"."))}},displayWarningAboutDemoCustomer=function(e){e=e.toLowerCase(),(e.indexOf("testkund")>=0||e.indexOf("demokund")>=0)&&(clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Demokund","Obs! Du försöker boka på en test eller demokund vilket orsakar problem i vissa fall. Gör därför alltid bokningen i rätt kundnummer!"))}},clearForm=function(){var e=$("#IDReminder");e.attr("data-value","0"),e.find(">a").html("Ingen påminnelse"),$("#IDOvrigt").val(""),$("#IDLevnr").val($("#IDLevnr_StartValue").val()),$("#IDReg").val(""),$("#IDEpost").val($("#IDEpost_StartValue").val()),$("#IDMobil").val($("#IDMobil_StartValue").val()),$("#saveAction").val("New"),$("#updateBtn").hide(),$("#saveBtn").show(),$("#myDisplayMessage").html(""),$("#dispalyMessageHeader").html("&nbsp;"),$("#newCustomerNo").attr("disabled","disabled")},resetForm=function(){$("#agrementDriedUnDried").val("Torkad"),$("#agrementDriedUnDried").hide(),$("#newCustomerNo").attr("disabled","disabled"),$("#searchAvailbleSlotsBtn").parent().addClass("disabled-btn"),$("#showReservationStopps").hide(),$(".fieldToClearWithClearForm").val(""),$("#IDEpost").val(""),$("#IDEpost_StartValue").val(""),$("#IDMobil").val(""),$("#IDMobil_StartValue").val(""),$("#saveAction").val("New"),$("#updateBtn").hide(),$("#saveBtn").show(),$("#myDisplayMessage").html(""),$("#dispalyMessageHeader").html("&nbsp;"),$("#resourceDrp").attr("data-value",""),$("#resourceDrp > a").html("Välj anläggning"),$("#articlesDrp").attr("data-value",""),$("#articlesDrp > a").html("Välj artikel"),$("#loadOrUnlodRad").val("1"),$("#veichleTypeDrp").attr("data-value",""),$("#veichleTypeDrp > a").html("Välj fordon"),$("#quantityTxt").val("")},copyValuesToEnableEdit=function(e){$("div").data("dateRegistered",e.dateRegistered),$("#dispalyMessageHeader").html("Ändra bokning genom att ändra uppgifter nedan och klicka Uppdatera bokning."),$("#myDisplayMessage").html(e.displayMessage),$("#IDLevnr").val(e.idLevnr),$("#IDReg").val(e.idReg),$("#IDOvrigt").val(e.idOvrigt);var t=$("#IDReminder");if("0"===e.idReminder||""===e.idReminder)t.attr("data-value",""),t.find(">a").html("Ingen påminnelse");else{t.attr("data-value",e.idReminder);var a=t.find('ul > li[data-value="'+e.idReminder+'"]'),n=a.find("a").html();a.addClass("selected"),t.find(">a").html(n)}$("#IDEpost").val(e.idEpost),$("#IDMobil").val(e.idMobil),$("#saveBtn").hide(),$("#updateBtn").show(),$("#saveAction").val("Update"),$("#ReservationID").val(e.reservationId),$("#SpeditorNo_ForUpdate").val(e.speditorNo),$("#CustomerNo_ForUpdate").val(e.customerNo),$("#CustomerName_ForUpdate").val(e.customerName),$("#newCustomerNo").val(e.customerNo),$("#newCustomerName").val(e.customerName),$("#TransportOrderNo_ForUpdate").val(e.transportOrderNo),$("#ContractNo_ForUpdate").val(e.contractNo),$("#ReminderEmail_ForUpdate").val(e.reminderEmail),$("#ReminderSMS_ForUpdate").val(e.reminderSms),$("#Owner").val(e.owner),$("#newCustomerNo").removeAttr("disabled"),$("#newCustomerNo").val(e.customerNo),$("input:checkbox").attr("checked",!1),$("#SaveTable").show()},updateReservation=function(){var e=function(e){var t=new Array;t[t.length]="<p>";for(var a=0;a<e.length;a++)200==e[a].Status?t[t.length]=e[a].Message:t[t.length]=e[a].ErrorMessage,t[t.length]="<br />";t[t.length]="</p>",clearContentToModal("#dialogArea"),clearForm(),fillContentToModal("#dialogArea","Bokningen uppdaterad",t.join("")),searchAvailableSlots()},t=function(e){clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Uppdateringsfel","Fel uppstod när bokningen skulle uppdateras."),searchAvailableSlots()},a=validateFieldsForReservation(!0);if(a.length>0){clearContentToModal("#dialogArea");var n=new Array;n[n.length]="<p>",n[n.length]="<ul>",n[n.length]=a.join(""),n[n.length]="</ul>",n[n.length]="</p>",fillContentToModal("#dialogArea","Uppgifter saknas",n.join(""))}else{var r=$("#CustomerNo_ForUpdate").val(),i=$("#CustomerName_ForUpdate").val(),o=$("#newCustomerNo").val(),l=$("#newCustomerName").val(),s=($("#loadOrUnlodRad").val(),$("#IDMobil").val()),d=$("#IDLevnr").val(),c=$("#IDOvrigt").val(),u=$("#IDReminder").attr("data-value"),p=$("#IDReg").val(),m=$("#IDEpost").val(),h=$("#Owner").val(),f=$("#ReservationID").val(),v=$("#SpeditorNo_ForUpdate").val();if(validateSaveTable(m,s,p,d)){var g=new Object;g.Note=c,g.ReminderInMinutesBefore=u,g.EmailAddress=m,g.NewCustomerName=l,g.NewCustomerNo=o,g.OldCustomerName=i,g.OldCustomerNo=r,g.Leveransforsakransnummer=d,g.LicensePlateNo=p,g.MobilePhone=s,g.Note=c,g.ReminderInMinutesBefore=u,g.EmailAddress=m,g.SpeditorNo=v,g.ReservationId=f,g.Owner=h,g.LineNumber=$("div").data("Linenumber"),g.DateRegistered=$("div").data("dateRegistered");var b=new Object;b.reservationToUpdate=g,$.ajax({type:"POST",url:"/api/time-booking/UpdateReservation",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(b),success:function(t){e(t.updateReservations)},error:function(e){t(e.updateReservations)}})}}},deleteReservation=function(e,t,a,n,r){var i=function(e){var t=new Array;t[t.length]="<p>";for(var a=0;a<e.length;a++)500==e[a].Status&&(t[t.length]='<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>'),t[t.length]=e[a].Message+"<br />";t[t.length]="</p>",clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Borttagning",t.join("")),$("#dialogArea").find(".btn-ok").on("click",function(){searchAvailableSlots()})},o=function(e){clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Raderingsfel","Fel uppstod när bokningen skulle raderas."),searchAvailableSlots()},l=function(e,t,a,n){clearForm();var r=new Object;r.reservationId=e,r.owner=t,r.customerNo=a,r.dateRegistered=n,$.ajax({type:"POST",url:"/api/time-booking/DeleteReservation",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(r),success:function(e){i(e.deleteReservations)},error:function(e){o(e.deleteReservations)}})},s=new Array;s[s.length]="<p>",s[s.length]="Vill du verkligen radera bokningen<br /> kl: "+t+"?",s[s.length]="</p>",clearContentToDeleteDialog(),fillContentToDeleteDialog("Ta bort bokning?",s.join("")),$("#deleteDialog").find(".btn-ok").on("click",function(){l(e,a,n,r)})},searchItems=function(currentArticleItem,resource){var searchItemComplete=function(response){var vechicles="string"==typeof response.Vehicles?eval("("+response.Vehicles+")"):response.Vehicles,reservationStops="string"==typeof response.ReservationStops?eval("("+response.ReservationStops+")"):response.ReservationStops,articles="string"==typeof response.Items?eval("("+response.Items+")"):response.Items;clearDropDown("articlesDrp","Välj artikel"),$("#articlesDrp > ul").append(extractForDropdown("articlesDrp",articles)),$("#veichleTypeDrp > ul").append(extractForDropdown("veichleTypeDrp",vechicles)),setDropdown($("#articlesDrp").parent(),"type3"),setDropdown($("#veichleTypeDrp").parent(),"type3"),vechicles.length>0&&($("#veichleTypeDrp > a").html(vechicles[0].Display),$("#veichleTypeDrp").attr("data-value",vechicles[0].Value)),validateRequiredFieldsEvent(),buildReservationStops(reservationStops)},buildReservationStops=function(e){var t=0,a=new Array;for(t=0;t<e.length;t++)a[a.length]="<li>"+e[t].ResourceName+"</li>",a[a.length]="<li>"+e[t].FromDate+" "+e[t].FromTime+" - ",e[t].ToDate.length>0?a[a.length]=e[t].ToDate+" "+e[t].ToTime+"</li>":a[a.length]=" tillsvidare</li>",a[a.length]='<li style="font-style: italic">'+e[t].Message+"<br /></li>";$("#showReservationStopps").find("> ul").html(a.join("")),t>0?$("#showReservationStopps").show():$("#showReservationStopps").hide()},resourceValue=resource,selectedDateValue=$("#selectedDate").val();currentArticleItem||(currentArticleItem=$("#articlesDrp").attr("data-value"));var showOnlyUnloadingItems="2"==$("input:radio[name='loadOrUnlodRad']:checked").val();if(clearDropDown("articlesDrp","Välj artikel"),clearDropDown("veichleTypeDrp","Välj fordon"),$("#showReservationStopps").hide(),"0"!=resourceValue&&""!=resourceValue&&""!=selectedDateValue){blockUI();var parameters="{'resourceGroupId':'"+resourceValue+"', 'selectedDate':'"+selectedDateValue+"', 'currentArticleItem':'"+currentArticleItem+"', 'showOnlyUnloadingItems':'"+showOnlyUnloadingItems+"'}";$.ajax({type:"POST",url:"/api/time-booking/loadItemsOnresourceGroup",dataType:"json",contentType:"application/json; charset=utf-8",data:parameters,async:!1,success:function(e){searchItemComplete(e),unBlockUI()},error:function(){unBlockUI(),alert("Error")}})}},clearDropDown=function(e,t){$("#"+e+"> ul > li").remove(),""!=$.trim(t)&&($("#"+e).attr("data-value",""),$("#"+e+"> a").html(t))},validateRequiredFieldsForSearch=function(){var e=!1;return $(".searchSlotRequired").each(function(){$(this).is("input")&&(0==$.trim($(this).val()).length?(e=!0,$(this).is("#quantityTxt")&&($("#Quantity-error").hide(),$(this).removeClass("error"))):$(this).is("#quantityTxt")&&($.isNumeric($.trim($(this).val()))?($("#Quantity-error").hide(),$(this).removeClass("error")):(e=!0,$("#Quantity-error").show(),$(this).addClass("error")))),$(this).is("li")&&(0!=$(this).attr("data-value")&&""!=$(this).attr("data-value")||(e=!0))}),!e},searchAvailableSlots=function(){var e=function(e){e?($("#resultTable").show(),$("#resultTable-box").addClass("has-separator")):($("#resultTable").hide(),$("#resultTable-box").removeClass("has-separator")),$("#SaveTable").hide(),$("#saveBtn").hide()},t=function(t){var a=function(){$(".bookingRows").change(function(){var e=!1;$(".bookingRows").each(function(){$(this).prop("checked")&&(e=!0)}),e?($("#SaveTable").show(),$("#saveBtn").removeClass("disabled-btn"),clearForm(),clearValidateSaveTable()):($("#SaveTable").hide(),$("#saveBtn").hide(),$("#saveBtn").addClass("disabled-btn"))})};clearResultTable(),$("#resultTable").append(t),""!==t?($(".tb-deleteBtn").unbind("click").bind("click",function(e){var t=$(this).parents(".tb-row"),a=t.find(".tb-reservationId").val(),n=t.find(".tb-fromDateTime").val(),r=t.find(".tb-owner").val(),i=t.find(".tb-customerNo").val(),o=t.find(".tb-dateRegistered").val();deleteReservation(a,n,r,i,o),e.preventDefault()}),$(".tb-editBtn").unbind("click").bind("click",function(e){var t=$(this).parents(".tb-row"),a=new Object;a.idLevnr=t.find(".tb-idLevnr").val(),a.idReg=t.find(".tb-idReg").val(),a.idOvrigt=t.find(".tb-idOvrigt").val(),a.idReminder=t.find(".tb-idReminder").val(),a.idEpost=t.find(".tb-idEpost").val(),a.idMobil=t.find(".tb-idMobil").val(),a.reservationId=t.find(".tb-reservationId").val(),a.speditorNo=t.find(".tb-speditorNo").val(),a.customerNo=t.find(".tb-customerNo").val(),a.customerName=t.find(".tb-customerName").val(),a.transportOrderNo=t.find(".tb-transportOrderNo").val(),a.contractNo=t.find(".tb-contractNo").val(),a.reminderEmail=t.find(".tb-reminderEmail").val(),a.reminderSms=t.find(".tb-reminderSms").val(),a.fromDateTime=t.find(".tb-fromDateTime").val(),a.itemInfo=t.find(".tb-item").html(),a.quantity=t.find(".tb-quantity").html(),a.unit=t.find(".tb-unit").html(),a.owner=t.find(".tb-owner").val(),a.resourceName=t.find(".tb-resourceName").val(),a.dateRegistered=t.find(".tb-dateRegistered").val(),a.displayMessage="Tid: "+a.fromDateTime+", Kund: "+a.customerNo+" "+a.customerName+", Bokningsnr: "+a.reservationId+", Artikel: "+a.itemInfo+" "+a.quantity+" "+a.unit+"<br />Resurs: "+a.resourceName,copyValuesToEnableEdit(a),e.preventDefault()}),$(document).trigger("enhance.tablesaw"),e(!0)):($(".tb-deleteBtn").unbind("click"),$(".tb-editBtn").unbind("click"),e(!1)),a()};if(clearResultTable(),validateRequiredFieldsForSearch()){blockUI();var a=$("#resourceDrp").attr("data-value"),n=$("#selectedDate").val(),r=$("#agrementDriedUnDried").val(),i=$("#articlesDrp").attr("data-value"),o=$("#quantityTxt").val(),l=$("input[name='loadOrUnlodRad']:checked").val(),s=$("#veichleTypeDrp").attr("data-value"),d=$("#search-option").attr("data-value"),c=$("#customerNo").val();if(""!=a&&""!=n&&""!=o&&(""!=i||""!=argementValue)){var u="{'resourceGroupId':'"+a+"', 'selectedDate':'"+n+"', 'article':'"+i+"', 'qty':'"+o+"', 'loadunload':'"+l+"', 'veichleType':'"+s+"', 'driedUnDried':'"+r+"', 'customerNo':'"+c+"','searchType':'"+d+"'}";$.ajax({type:"POST",url:"/api/time-booking/SearchAvailbleSlots",contentType:"application/json; charset=utf-8",data:u,success:function(e){t(e),unBlockUI()},error:function(){unBlockUI(),e(!1),alert("Error")}})}}},validateFieldsForReservation=function(e){var t=new Array;""==jQuery.trim($("#quantityTxt").val())&&(t[t.length]="<li>Kvantitet saknar värde.</li>");var a=parseInt(jQuery.trim($("#quantityTxt").val()),10);if((isNaN(a)||a<=0)&&(t[t.length]="<li>Kvantitet måste ha ett värde större än 0.</li>"),""==jQuery.trim($("#customerNo").val())&&(t[t.length]="<li>Ingen gilltigt kund har valts.</li>"),$("#IDReg").hasClass("updateRequiered")&&""==jQuery.trim($("#IDReg").val())&&(t[t.length]="<li>Registreringsnummer saknas.</li>"),""==jQuery.trim($("#veichleTypeDrp").attr("data-value"))&&(t[t.length]="<li>Fordonstyp saknas.</li>"),""==jQuery.trim($("#selectedDate").val())&&(t[t.length]="<li>Datum saknas.</li>"),""==jQuery.trim($("#articlesDrp").attr("data-value"))&&(t[t.length]="<li>Artikel saknas.</li>"),""==jQuery.trim($("#resourceDrp").attr("data-value"))&&(t[t.length]="<li>Resurs saknas.</li>"),!e){var n=$("#resourceDrp").attr("data-value"),r=$("#selectedDate").val(),i=$("#agrementDriedUnDried").val(),o=$("#articlesDrp").attr("data-value"),l=$("#quantityTxt").val(),s=$("input[name='loadOrUnlodRad']:checked").val(),d=$("#veichleTypeDrp").attr("data-value"),c=$("#search-option").attr("data-value"),u=$("#customerNo").val(),p=$("#seachFieldTxt").val();if(""!=n&&""!=r&&""!=l&&(""!=o||""!=argementValue)){var m="{'resourceGroupId':'"+n+"', 'selectedDate':'"+r+"', 'article':'"+o+"', 'qty':'"+l+"', 'loadunload':'"+s+"', 'veichleType':'"+d+"', 'driedUnDried':'"+i+"', 'customerNo':'"+u+"','searchType':'"+c+"', 'iONumber':'"+p+"'}";$.ajax({type:"POST",url:"/api/time-booking/ExistBooking",dataType:"json",contentType:"application/json; charset=utf-8",data:m,async:!1,success:function(e){1==e.IsExistBooking&&(t[t.length]="<li>Det finns redan en bokning på inköpsordern. Radera befintlig bokning innan du kan skapa en ny!</li>")},error:function(){alert("ExistBooking")}})}}return t},makeReservation=function(){var e=function(){var e=new Array,n=0,r=$("#quantityTxt").val(),i=$("#customerNo").val(),o=$("#customerName").val(),l="2"===$("input:radio[name='loadOrUnlodRad']:checked").val(),s=$("#IDMobil").val(),d=$("#IDLevnr").val(),c=$("#IDOvrigt").val(),u=$("#IDReminder").attr("data-value"),p=null!=$("#IDReg").val()?$("#IDReg").val():"",m=$("#agrementDriedUnDried").val(),h=$("#IDEpost").val(),f=$("#veichleTypeDrp").attr("data-value"),v=$("#search-option").attr("data-value"),g=$("#seachFieldTxt").val(),b=$("#selectedDate").val(),w=$("#articlesDrp").attr("data-value"),y=$("#resourceDrp").attr("data-value"),C="";if(validateSaveTable(h,s,p,d))if($(".bookingRows").each(function(){if($(this).is(":checked")){n++;var t=new Object;t.FromTime=$(this).attr("fromtime"),t.ResourceId=$(this).attr("resursid"),1==l?(t.Loading="false",t.Unloading="true"):(t.Loading="true",t.Unloading="false"),e.push(t)}}),e.length>0){var D=new Object;D.Reservations=e,D.Agrement=C,D.SearchValue=g,D.Qty=r,D.VehicleAssortmentID=f,D.ResourceId=y,D.Note=c,D.ReminderInMinutesBefore=u,D.EmailAddress=h,D.CustomerName=o,D.CustomerNo=i,D.Dried=m,D.SearchType=v,D.SelectedDate=b,D.Item=w,D.Leveransforsakransnummer=d,D.LicensePlateNo=p,D.MobilePhone=s;var k=$("div").data("Linenumber");null==k&&(k=0),D.LineNumber=k;var _=new Object;_.reservationToMake=D,$.ajax({type:"POST",url:"/api/time-booking/MakeReservation",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(_),success:function(e){t(e.makeReservations)},error:function(e){a(e)}})}else{clearContentToModal("#dialogArea");var T=new Array;T[T.length]="<p>Inga tider valda</p>",fillContentToModal("#dialogArea","Tider saknas",T.join(""))}},t=function(e){var t=new Array,a="",n=0,r=0;t[t.length]="<h4>Bokningar:</h4>",t[t.length]="<p>";for(var i=0;i<e.length;i++)200==e[i].Status?(i>0&&(t[t.length]="<br /><br />"),t[t.length]=e[i].StartDate,t[t.length]=" kl: ",t[t.length]=e[i].StartTime,t[t.length]="<br />",t[t.length]=e[i].CustomerNo,t[t.length]=" ",t[t.length]=e[i].CustomerName,n++):(r++,t[t.length]=e[i].ErrorMessage);t[t.length]="<br />",t[t.length]="</p>",r>0&&0===n?a="Fel uppstod vid bokningen":r>0&&n>0?a="Alla bokningar gick inte igenom":0==r&&n>0&&(a="Bokningar sparade"),clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea",a,t.join("")),$("#saveBtn").addClass("disabled-btn"),clearForm(),searchAvailableSlots()},a=function(e){clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Bokningsfel","Fel uppstod när boking skulle registreras.")},n=validateFieldsForReservation(!1);if(n.length>0){clearContentToModal("#dialogArea");var r=new Array;return r[r.length]="<p>",r[r.length]="<ul>",r[r.length]=n.join(""),r[r.length]="</ul>",r[r.length]="</p>",fillContentToModal("#dialogArea","Uppgifter saknas",r.join("")),!1}e()},searchAvalibleSlotAction=function(){clearForm(),$("#resultTable").hide(),$("#resultTable-box").removeClass("has-separator"),$("#SaveTable").hide(),$("#saveBtn").hide(),searchAvailableSlots()},validateButtonSearchEvent=function(){$("#seachFieldTxt").unbind("keyup").keyup(function(){""!==$(this).val()?$("#searcFieldhBtn").removeClass("disabled-btn"):$("#searcFieldhBtn").addClass("disabled-btn")}),$("#seachFieldTxt").unbind("change").change(function(){""!==$(this).val()?$("#searcFieldhBtn").removeClass("disabled-btn"):$("#searcFieldhBtn").addClass("disabled-btn")})},makeReservationEvent=function(){$("#saveBtn").click(function(){makeReservation()})},updateReservationEvent=function(){$("#updateBtn").click(function(){updateReservation()})},validateRequiredFieldsEvent=function(){$("#form-time-booking").unbind("change").change(function(){validateRequiredFieldsForSearch()?$("#searchAvailbleSlotsBtn").parent().removeClass("disabled-btn"):$("#searchAvailbleSlotsBtn").parent().addClass("disabled-btn")}),$("#quantityTxt").unbind("keyup").keyup(function(){validateRequiredFieldsForSearch()?$("#searchAvailbleSlotsBtn").parent().removeClass("disabled-btn"):$("#searchAvailbleSlotsBtn").parent().addClass("disabled-btn")}),setDropdown($("#resourceDrp").parent(),"type3"),$(".searchSlotRequired .dropdown li a").on("click",function(){validateRequiredFieldsForSearch()?$("#searchAvailbleSlotsBtn").parent().removeClass("disabled-btn"):$("#searchAvailbleSlotsBtn").parent().addClass("disabled-btn")}),validateRequiredFieldsForSearch()?$("#searchAvailbleSlotsBtn").parent().removeClass("disabled-btn"):$("#searchAvailbleSlotsBtn").parent().addClass("disabled-btn")},searchItemEvent=function(){var e=$("#resourceDrp .dropdown li a");e.on("click",function(){var e=$(this).parent().attr("data-value");searchItems("",e);var t=$(this).parent().attr("regNoMandatory");null!=t&&"true"==t.toLowerCase()?$("#IDReg").addClass("updateRequiered"):$("#IDReg").removeClass("updateRequiered")});var t=$("#articlesDrp .dropdown li a");t.on("click",function(){var e=$(this).parent().attr("data-value");if(null!=e&&""!=e){var t=e.split("-");if(3==t.length){var a=(t[0],t[1]);a.length>=2&&(a=a.substring(0,1).toUpperCase()+a.substring(1)),$("#agrementDriedUnDried").val(a)}}}),$("#loadRadio").unbind("change").change(function(){searchItems("",$("#resourceDrp").attr("data-value"));
}),$("#unloadradio").unbind("change").change(function(){searchItems("",$("#resourceDrp").attr("data-value"))}),$("#selectedDate").change(function(){searchItems("",$("#resourceDrp").attr("data-value"))})},searchAvailableSlotsEvent=function(){$("#searchAvailbleSlotsBtn").on("click",function(){searchAvalibleSlotAction()})},searchCustomerEvent=function(){$("#searcFieldhBtn").click(function(){searchCustomer()})},bokaSearchTypeChangeEvent=function(){$("#search-option > ul > li > a").click(function(){var e=$(this).html();$("#seachFieldTxt").attr("placeholder","Ange "+e.toLowerCase())})},searchCustomerWhenLoadPageEvent=function(){""!=$("#seachFieldTxt").val()?($("#searcFieldhBtn").removeClass("disabled-btn"),searchCustomer()):$("#searcFieldhBtn").addClass("disabled-btn")},init=function(){searchItemEvent(),validateRequiredFieldsEvent(),searchAvailableSlotsEvent(),makeReservationEvent(),updateReservationEvent(),searchCustomerEvent(),bokaSearchTypeChangeEvent(),searchCustomerWhenLoadPageEvent(),validateButtonSearchEvent()};return{init:init,searchItems:searchItems,searchAvalibleSlotAction:searchAvalibleSlotAction}},ListingBookingPage=function(){var e=function(){blockUI();var e=$("#fromDateTxt").val(),t=$("#toDateTxt").val(),a=$("#customerNo").val(),n=$("#RegNo").val(),i=$("#bl-resourceDrp").attr("data-value"),s="",d="",c="";$("#SaveTable").hide(),$("#updateBtn").hide();var u=new Object;u.ResourceGroupId=i,u.FromDate=e,u.ToDate=t,u.RegNo=n,u.CustomerNo=a,u.ReferenceType=d,u.ReferenceNumber=s,u.PurchseOrderLine=c;var p=new Object;p.request=u,$.ajax({type:"POST",url:"/api/listing-booking/SearchBookings",contentType:"application/json; charset=utf-8",data:JSON.stringify(p),success:function(e){m(e),unBlockUI()},error:function(e){alert("Error: "+e),$("#search-result-book-listing").hide(),unBlockUI()}});var m=function(e){$("#search-result-book-listing").html(e),void 0==e.resultSearchBookings?$("#search-result-book-listing").show():$("#search-result-book-listing").hide(),o(),l(),r(),$(document).trigger("enhance.tablesaw")}},t=function(t){var a=$(t).parent().parent(),r=a.find("> #reservationId > a").html(),i=a.find("#from-date").val(),o=a.find("#from-time").val(),l=a.find("> #owner").html(),s=a.find("> #customer-number").html(),d=new Array;d[d.length]="<p>",d[d.length]='<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>',d[d.length]="Vill du verkligen radera bokningen<br /> kl: "+o+"?",d[d.length]="</p>",clearContentToDeleteDialog(),fillContentToDeleteDialog("Ta bort bokning?",d.join("")),$("#deleteDialog").find(".btn-ok").on("click",function(){c(r,l,s,i,o)});var c=function(t,a,r,i,o){n();var l=new Object;l.reservationId=t,l.owner=a,l.customerNo=r,l.dateRegistered=i+" "+o,$.ajax({type:"POST",url:"/api/time-booking/DeleteReservation",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(l),success:function(e){s(e.deleteReservations)},error:function(e){d()}});var s=function(t){var a=new Array;a[a.length]="<p>";for(var n=0;n<t.length;n++)500==t[n].Status&&(a[a.length]='<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>'),a[a.length]=t[n].Message+"<br />";a[a.length]="</p>",clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Borttagning",a.join("")),$("#dialogArea").find(".btn-ok").on("click",function(){e()}),$("#SaveTable").hide(),$("#updateBtn").hide()},d=function(){$("#SaveTable").hide(),$("#updateBtn").hide(),alert("Fel uppstod vid anropet till tjänsten.")}}},a=function(t){var a=function(e){$("#myDisplayMessage").html(e.displayMessage),$("div").data("dateRegisteredList",e.dateRegistered),$("#SaveTable").show(),$("#IDLevnr").val(e.idLevnr),$("#IDReg").val(e.idReg),$("#IDOvrigt").val(e.idOvrigt);var t=$("#IDReminder");if("0"===e.idReminder||""===e.idReminder)t.attr("data-value",""),t.find(">a").html("Ingen påminnelse");else{t.attr("data-value",e.idReminder);var a=t.find('ul > li[data-value="'+e.idReminder+'"]'),n=a.find("a").html();a.addClass("selected"),t.find(">a").html(n)}$("#IDEpost").val(e.idEpost),$("#IDMobil").val(e.idMobil),$("#saveAction").val("Update"),$("#ReservationID").val(e.reservationId),$("#SpeditorNo_ForUpdate").val(e.speditorNo),$("#CustomerNo_ForUpdate").val(e.customerNo),$("#CustomerName_ForUpdate").val(e.customerName),$("#newCustomerNo").val(e.customerNo),$("#newCustomerName").val(e.customerName),$("#TransportOrderNo_ForUpdate").val(e.transportOrderNo),$("#ContractNo_ForUpdate").val(e.contractNo),$("#ReminderEmail_ForUpdate").val(e.reminderEmail),$("#ReminderSMS_ForUpdate").val(e.reminderSms),$("#Owner").val(e.owner),$("#dispalyMessageHeader").html("Ändra bokning genom att ändra uppgifter nedan och klicka Uppdatera bokning."),$("#CustomerName_ForUpdate").val()!=e.customerName&&alert("fel"),$("#updateBtn").unbind("click"),$("#updateBtn").click(function(){r()}),$("#newCustomerNo").val(e.customerNo),$("#updateBtn").show()},r=function(){var e=$("#CustomerNo_ForUpdate").val(),t=$("#CustomerName_ForUpdate").val(),a=$("#newCustomerNo").val(),n=$("#newCustomerName").val(),r=($("#loadOrUnlodRad").val(),$("#IDMobil").val()),l=$("#IDLevnr").val(),s=$("#IDOvrigt").val(),d=$("#IDReminder").attr("data-value"),c=$("#IDReg").val(),u=$("#IDEpost").val(),p=$("#Owner").val(),m=$("#ReservationID").val(),h=$("#SpeditorNo_ForUpdate").val();if(validateSaveTable(u,r,c,l)){var f=new Object;f.Note=s,f.ReminderInMinutesBefore=d,f.EmailAddress=u,f.NewCustomerName=n,f.NewCustomerNo=a,f.OldCustomerName=t,f.OldCustomerNo=e,f.Leveransforsakransnummer=l,f.LicensePlateNo=c,f.MobilePhone=r,f.ReminderInMinutesBefore=d,f.EmailAddress=u,f.SpeditorNo=h,f.ReservationId=m,f.Owner=p,f.DateRegistered=$("div").data("dateRegisteredList");var v=new Object;v.reservationToUpdate=f,$.ajax({type:"POST",url:"/api/time-booking/UpdateReservation",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(v),success:function(e){i(e.updateReservations)},error:function(e){o(e.updateReservations)}})}},i=function(t){var a=new Array;a[a.length]="<p>";for(var r=0;r<t.length;r++)200==t[r].Status?a[a.length]=t[r].Message:a[a.length]=t[r].ErrorMessage,a[a.length]="<br />";a[a.length]="</p>",clearContentToModal("#dialogArea"),fillContentToModal("#dialogArea","Bokningen uppdaterad",a.join("")),n(),$("#SaveTable").hide(),$("#updateBtn").hide(),e()},o=function(t){$("#SaveTable").hide(),alert("updateReservationError"),e()},l=new Object,s=$(t).parent().parent();l.resourceName=s.find("#resourceName").val(),l.itemName=s.find("#itemName").val(),l.weight=s.find(">#weight").html(),l.fromTime=s.find("#from-time").val(),l.itemNo=s.find(">#itemNo").html(),l.idLevnr=s.find(">#leveransforsakransnr").html(),l.idReg=s.find(">#licensePlateNo").html(),l.idOvrigt=s.find("#note").val(),l.idReminder=s.find("#reminderMinutesBefore").val(),l.idEpost=s.find("#emailAddress").val(),l.idMobil=s.find("#mobileNo").val(),l.reservationId=s.find(">#reservationId > a").html(),l.speditorNo=s.find("#speditorNo").val(),l.customerNo=s.find(">#customer-number").html(),l.customerName=s.find("#customer-name").val(),l.transportOrderNo=s.find("#transportOrderNo").val(),l.contractNo=s.find("#contractNo").val(),l.reminderEmail=s.find("#reminderEmail").val(),l.reminderSms=s.find("#reminderSms").val(),l.owner=s.find(">#owner").html(),l.dateRegistered=s.find("#dateRegistered").val(),l.displayMessage="Tid: "+l.fromTime+", Kund: "+l.customerNo+" "+l.customerName+", Bokningsnr: "+l.reservationId+", Artikel: "+l.itemNo+" "+l.itemName+l.weight+"<br />Resurs: "+l.resourceName,a(l)},n=function(){$(".fieldToClearWithClearForm").val(""),$("#SaveTable").hide(),$("#updateBtn").hide(),$("#IDEpost").val($("#IDEpost_StartValue").val()),$("#IDMobil").val($("#IDMobil_StartValue").val()),$("#saveAction").val("New"),$("#saveAction").val("New"),$("#myDisplayMessage").html(""),$("#dispalyMessageHeader").html("&nbsp;")},r=function(){var e=$("#printLink");$(e).unbind("click"),$(e).click(function(){var e=$("#search-result-book-listing"),t=window.open();e.find("#printLink").hide(),t.document.write(e.html()),e.find("#printLink").show(),t.print(),t.close()})},i=function(){$("#search-booking-button").click(function(t){e(),t.preventDefault()})},o=function(){var e=$(".boka-listing-deleteBtn");$(e).unbind("click"),$(e).click(function(e){t($(this)),e.preventDefault()})},l=function(){var e=$(".boka-listing-editBtn");$(e).unbind("click"),$(e).click(function(e){a($(this)),clearValidateSaveTable(),e.preventDefault()})},s=function(){i()};return{init:s}},validateSaveTable=function(e,t,a,n){var r=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i=/^\+?(\d[\d-. ]+)?(\([\d-. ]+\))?[\d-. ]+\d$/,o=/^([a-zA-Z]{3}\d{3})+$/,l=/^\d+$/,s=!0;return clearValidateSaveTable(),""===e||r.test(e)||(s=!1,$("#IDEpost").addClass("error"),$("#IDEpost-error").show()),""===t||i.test(t)||(s=!1,$("#IDMobil").addClass("error"),$("#IDMobil-error").show()),$("#IDReg").hasClass("updateRequiered")&&(o.test(a)||(s=!1,$("#IDReg").addClass("error"),$("#IDReg-error").show())),l.test(n)||(s=!1,$("#IDLevnr").addClass("error"),$("#IDLevnr-error").show()),s},clearValidateSaveTable=function(){$("#IDEpost-error").hide(),$("#IDMobil-error").hide(),$("#IDLevnr-error").hide(),$("#IDReg-error").hide(),$("#IDEpost").removeClass("error"),$("#IDMobil").removeClass("error"),$("#IDReg").removeClass("error"),$("#IDLevnr").removeClass("error")};jQuery(function(){CustomerCard.init()});var CustomerCard=CustomerCard||function(){function e(){var e=$("a.user-profile");e.each(function(e,t){$(t).click(function(){var e=$(t).closest("li.showcase").attr("data-value"),s=$(t).attr("data-userName"),d=$(t).closest("td").find(".loader-wrapper"),c=$(t).closest("td").find(".confirm-panel .confirm-box");if(c.length>0){var u=$(c);u.show(),$("input[type=reset]",u).click(function(){u.hide()}),$("input[type=button]",u).click(function(){a(d),r(s,e,o,function(){u.hide()},function(){i(l.updateError)},function(){n(d),u.hide()})})}})}),$(".fa.fa-trash-2").click(function(){var e=$(this).attr("data-userName"),r=$(this).attr("data-userId"),s=$(this).closest("tr"),d=$(s).find(".loader-wrapper"),c=$("#dg-del-user-confirmation");c.length>0&&(c.fadeIn(),$("button.yes").click(function(){a(d),t(e,r,o,function(){$(s).remove()},function(){i(l.delError)},function(){n(d)})}))})}function t(e,t,a,n,r,i){$.ajax({url:"/api/customer-card/remove-user?userName="+e+"&userId="+t+"&customerNo="+a,type:"GET",dataType:"json",success:function(e){e?n():r()},error:function(e,t,a){r()},complete:function(){i()}})}function a(e){void 0!=e&&$(e).show()}function n(e){void 0!=e&&$(e).hide()}function r(e,t,a,n,r,i){$.ajax({url:"/api/customer-card/change-profile?userName="+e+"&profileId="+t+"&customerNo="+a,type:"GET",dataType:"json",success:function(e){e?n():r()},error:function(e,t,a){r()},complete:function(){i()}})}function i(e){}var o="",l={delError:"",updateError:""},s=function(){o=$("input#customer-no")?$("input#customer-no").val():"",e()};return{init:s}}();window.gro=window.gro||{},gro.modules=gro.modules||{},gro.modules.internalNavigation=function(){var e={};e.toggleNavigation=function(e,t){var t=t;e.hasClass("expanded")?t||e.removeClass("expanded"):e.addClass("expanded")},e.init=function(){$(".js-internal-navigation-category").on("click",function(t){t.preventDefault();var a=this,n=$(a).next(".internal-navigation__list--sub-level"),r=$(a).parents(".internal-navigation");$(a).hasClass("is-expanded")?$(n).slideUp(function(){$(a).removeClass("is-expanded"),$(n).removeClass("is-expanded").removeAttr("style")}):($(a).addClass("is-expanded"),$(n).slideDown(function(){$(n).addClass("is-expanded").removeAttr("style")})),e.toggleNavigation(r,!0)}),$(".internal-navigation__toggle-btn").on("click",function(t){t.preventDefault();var a=this,n=$(a).parent().find(".internal-navigation__list--sub-level"),r=$(a).parents(".internal-navigation");e.toggleNavigation(r),$(n).slideUp(function(){$(this).prev().removeClass("is-expanded"),$(this).removeClass("is-expanded").removeAttr("style")})})},$(function(){e.init()})}();