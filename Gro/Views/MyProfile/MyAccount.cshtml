@model Gro.ViewModels.Pages.MyProfile.MyAccountPageViewModel

<section class="lm__contents">
    <div class="wrapper">
        <div class="layout  layout--large">
            <div class="layout__item u-1/1">
                <h1 class="lm__page-title">@Html.PropertyFor(x => x.CurrentPage.Heading)</h1>
            </div>
            <div class="layout__item u-1/1">
                <div class="layout layout--large">
                    @if (Model.User != null)
                    {
                        <div class="layout__item u-1/1 u-1/3-tablet">
                            <div class="lm__block">
                                <div class="lm__user-inform__wrapper">
                                    <div class="lm__avatar">
                                        <div class="loader-wrapper" id="loader" style="display: none; width: 80px; height: 80px; opacity: 0.9; background: white;">
                                            <div class="loader"></div>
                                        </div>
                                        @if (!string.IsNullOrEmpty(Model.UserProfilePictureUrl))
                                        {
                                            <img data-img-source="@Model.UserProfilePictureUrl" id="user-avatar" alt="User Avatar" class="avatar-img"
                                                 data-placeholder="/Static/images/user-avatar__default.jpg">
                                        }
                                        else
                                        {
                                            <img src="/Static/images/user-avatar__default.jpg" id="user-avatar" alt="User Avatar" class="avatar-img">
                                        }
                                        <a href="javascript:void(0)" class="lm__avatar__upload-btn bottom-right"><i class="fa fa-camera" aria-hidden="true"></i></a>
                                        <ul class="popup-sub">
                                            <li><a class="upload-avatar lm__icon-btn width-100" href="javascript:void(0)" id="user-link"><i class="fa fa-plus-2"></i><span>Ladda upp ny profilbild</span></a></li>
                                            @if (!string.IsNullOrEmpty(Model.UserProfilePictureUrl))
                                            {
                                                <li><a class="remove-avatar lm__icon-btn width-100" href="javascript:void(0)" id="user-deleteBtn"><i class="fa fa-trash-2"></i><span>Ta bort bild</span></a></li>
                                            }
                                            else
                                            {
                                                <li><a class="remove-avatar lm__icon-btn width-100" style="display: none;" href="javascript:void(0)" id="user-deleteBtn"><i class="fa fa-trash-2"></i><span>Ta bort bild</span></a></li>
                                            }

                                        </ul>
                                        <input type="file" id="user-avatar__file" class="file-upload-input" style="display: none;" accept="image/*" />
                                    </div>
                                    <div class="lm__user-inform">
                                        <h1>Min profil</h1>
                                        <div class="inform-detail">
                                            <p>@Model.User.Name</p>
                                        </div>
                                    </div>
                                    <div class="lm__group-btns" style="display: none;">
                                        <button class="lm__form-btn" id="user-cancelUpload">Avbryt</button>
                                        <button class="lm__form-btn" id="user-uploadBtn">Använd</button>
                                    </div>
                                </div>
                                <section class="lm__news with-animation">
                                    @foreach (var linkItem in Model.MyProfileLinks)
                                    {
                                        <article class="lm__news-item">
                                            <a href="@linkItem.GetHref()">
                                                <h4 class="article-title right-icon-pos  strong-text">@linkItem.AsLinkItem().Text<i class="fa fa-long-arrow-right" aria-hidden="true"></i></h4>
                                            </a>
                                        </article>
                                    }
                                </section>
                            </div>
                        </div>
                    }

                    @if (Model.CurrentOrganization != null)
                    {
                        <div class="layout__item u-1/1 u-1/3-tablet">
                            <div class="lm__block">
                                <div class="lm__user-inform__wrapper">
                                    <div class="lm__avatar">
                                        <div class="loader-wrapper" id="loader" style="display: none; width: 80px; height: 80px; opacity: 0.9; background: white;">
                                            <div class="loader"></div>
                                        </div>
                                        @if (!string.IsNullOrEmpty(Model.CompanyProfilePictureUrl))
                                        {
                                            <img data-img-source="@Model.CompanyProfilePictureUrl" id="company-avatar" alt="User Avatar" class="avatar-img"
                                                 data-placeholder="/Static/images/user-avatar__default.jpg">
                                        }
                                        else
                                        {
                                            <img src='/Static/images/location__default.jpg' id="company-avatar" alt="User Avatar" class="avatar-img">
                                        }
                                        <a href="#" class="lm__avatar__upload-btn bottom-right"><i class="fa fa-camera" aria-hidden="true"></i></a>
                                        <ul class="popup-sub">
                                            <li><a class="upload-avatar lm__icon-btn width-100" href="javascript:void(0)" id="company-link"><i class="fa fa-plus-2"></i><span>Ladda upp ny gårdsbild</span></a></li>
                                            @if (!string.IsNullOrEmpty(Model.CompanyProfilePictureUrl))
                                            {
                                                <li><a class="remove-avatar lm__icon-btn width-100" href="javascript:void(0)" id="company-deleteBtn"><i class="fa fa-trash-2"></i><span>Ta bort bild</span></a></li>
                                            }
                                            else
                                            {
                                                <li><a class="remove-avatar lm__icon-btn width-100" style="display: none;" href="javascript:void(0)" id="company-deleteBtn"><i class="fa fa-trash-2"></i><span>Ta bort bild</span></a></li>
                                            }
                                        </ul>
                                        <input type="file" id="company-avatar__file" class="file-upload-input" style="display: none;" accept="image/*" />
                                    </div>
                                    <div class="lm__user-inform">
                                        <h1>Företaget</h1>
                                        <div class="inform-detail">
                                            <h3 class="align-center-text">@Model.CurrentOrganization.CustomerNo</h3>
                                            <p>@Html.Raw(Model.CurrentOrganization.CustomerName)</p>
                                        </div>
                                    </div>
                                    <div class="lm__group-btns" style="display: none;">
                                        <button class="lm__form-btn" id="company-cancelUpload">Avbryt</button>
                                        <button class="lm__form-btn" id="company-uploadBtn">Använd</button>
                                    </div>
                                </div>
                                <section class="lm__news with-animation">
                                    @foreach (var linkItem in Model.MyCompanyLinks)
                                    {
                                        <article class="lm__news-item">
                                            <a href="@linkItem.GetHref()">
                                                <h4 class="article-title right-icon-pos strong-text">@linkItem.AsLinkItem().Text<i class="fa fa-long-arrow-right" aria-hidden="true"></i></h4>
                                            </a>
                                        </article>
                                    }
                                </section>
                            </div>
                        </div>
                    }
                    <div class="layout__item u-1/1 u-1/3-tablet">
                        <div class="lm__block">
                            <div class="lm__user-inform__wrapper">
                                <div class="lm__avatar">
                                    <img src="/Static/images/group__default.jpg" alt="User Avatar" class="avatar-img">
                                </div>
                                <div class="lm__user-inform">
                                    <h1>Användare</h1>
                                </div>
                            </div>
                            <section class="lm__news with-animation">
                                @foreach (var userOrgLink in Model.UserAndOrgLinks)
                                {
                                    <article class="lm__news-item">
                                        <a href="@userOrgLink.GetHref()">
                                            <h4 class="article-title right-icon-pos strong-text">
                                                @userOrgLink.AsLinkItem().Text <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                                            </h4>
                                        </a>
                                    </article>
                                }
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for showing error or information after event -->
    <div class="lm__modal__wrapper hidden" id="informationDialog">
        <div class="mask"></div>
        <div class="lm__wide-modal">
            <h3 class="lm__wide-modal__title" id="dialogTitle"></h3>
            <p id="dialogContent"></p>
            <div class="lm__wide-modal__close-btn">
                <a href=""></a>
            </div>
        </div>
    </div>

<div class="lm__modal-alert" id="dialog-user-confirmation">
    <div class="lm__modal-dialog">
        <div class="modal-content-inform">
            <span class="alert-icon warning"></span>
            <h3 class="success-header-title">Är du säker på att du vill ta bort bilden?</h3>
            <div class="button-confirm wider-buttons align-center-text">
                <button class="success-confirm-inform no">Nej, spara den</button>
                <button class="success-confirm-inform reverse-state yes">Ja, ta bort</button>
            </div>
            <div class="lm__information-modal__close-btn">
                <a href=""></a>
            </div>
        </div>
    </div>
</div>
    <div class="lm__modal-alert" id="dialog-company-confirmation">
        <div class="lm__modal-dialog">
            <div class="modal-content-inform">
                <span class="alert-icon warning"></span>
                <h3 class="success-header-title">Är du säker på att du vill ta bort bilden?</h3>
                <div class="button-confirm wider-buttons align-center-text">
                    <button class="success-confirm-inform no">Nej, spara den</button>
                    <button class="success-confirm-inform reverse-state yes">Ja, ta bort</button>
                </div>
                <div class="lm__information-modal__close-btn">
                    <a href=""></a>
                </div>
            </div>
        </div>
    </div>

    @{
        var userInfoUpdate = (bool?)TempData["UpdateInfoSuccess"] == true;
        var isUpdatePasswordSuccess = (bool?)TempData["UpdatePasswordSuccess"] == true;
        var isUpdatePersonNumberSuccess = (bool?)TempData["UpdatePersonNumberSuccess"] == true;
        var isUpdateCompanyInformationSuccess = (bool?)TempData["UpdateCompanyInformationSuccess"] == true;
        var isUpdateBusinessProfile = (bool?)TempData["UpdateBusinessProfileSuccess"] == true;

        if (userInfoUpdate || isUpdatePasswordSuccess || isUpdatePersonNumberSuccess || isUpdateCompanyInformationSuccess || isUpdateBusinessProfile)
        {
            <div class="lm__information-modal__wrapper">
                <div class="mask"></div>
                <div class="lm__information-modal">
                    @if (!isUpdateCompanyInformationSuccess && !isUpdateBusinessProfile)
                    {
                        <h3 class="lm__information-modal__title">Klart - Ändringar sparade</h3>
                    }

                    @if (isUpdatePersonNumberSuccess)
                    {
                        <p>Du kan från och med nu även logga in på LM<sup>2</sup> med ditt BankID</p>
                    }
                    @if (isUpdateCompanyInformationSuccess)
                    {
                        <h3 class="lm__information-modal__title">Klart - Uppdateringar om företagsinformation har skickats</h3>
                        <p>Dina uppdateringar kring företagsinformationen har skickats till kundtjänst som ändrar detta manuellt. Uppdateringarna blir synliga för dig när detta är gjort. Detta kan ta upp till en halv arbetsdag.</p>
                    }
                    @if (isUpdateBusinessProfile)
                    {
                        <h3 class="lm__information-modal__title">Klart - Uppdateringar om verksamhetsprofil har skickats</h3>
                        <p>Dina uppdateringar kring din verksamhetsprofil har skickats till kundtjänst som ändrar detta manuellt. Uppdateringarna blir synliga för dig när detta är gjort. Detta kan ta upp till en halv arbetsdag.</p>
                    }
                </div>
                <div class="lm__information-modal__close-btn">
                    <a href=""></a>
                </div>
            </div>
        }
    }

</section>
